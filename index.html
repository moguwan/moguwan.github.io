
<!DOCTYPE html>
<html lang="zh-CN" data-theme-mode="dark">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="MY HOME ä¸ªäººä¸»é¡µ">
    <meta name="keywords" content="Homepage,JavaTool,ä¸ªäººä¸»é¡µ">
    <meta name="author" content="MY HOME">
    <title>MY HOME - ä¸ªäººä¸»é¡µ</title>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_0khxww3tj3q9.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/dmego-home-page@latest/assets/css/iconfont.css">
    
    <!-- æ¶²æ€ç»ç’ƒSVGæ»¤é•œ -->
    <svg style="display: none">
      <filter id="glass-distortion">
        <feTurbulence type="fractalNoise" baseFrequency="0.001 0.005" numOctaves="1" seed="17" result="turbulence" />
        <feComponentTransfer in="turbulence" result="mapped">
          <feFuncR type="gamma" amplitude="1" exponent="10" offset="0.5" />
          <feFuncG type="gamma" amplitude="0" exponent="1" offset="0" />
          <feFuncB type="gamma" amplitude="0" exponent="1" offset="0.5" />
        </feComponentTransfer>
        <feGaussianBlur in="turbulence" stdDeviation="3" result="softMap" />
        <feSpecularLighting in="softMap" surfaceScale="5" specularConstant="1" specularExponent="100" lighting-color="white" result="specLight">
          <fePointLight x="-200" y="-200" z="300" />
        </feSpecularLighting>
        <feComposite in="specLight" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="litImage" />
        <feDisplacementMap in="SourceGraphic" in2="softMap" scale="200" xChannelSelector="R" yChannelSelector="G" />
      </filter>
    </svg>

    <style type="text/css">
/* ========== è¯„è®ºå›å¤æ”¶èµ·/å±•å¼€æ ·å¼ ========== */
/* å›å¤åˆ—è¡¨å®¹å™¨ - é»˜è®¤æ”¶èµ· */
.reply-list-container {
    margin-left: 36px;
    margin-top: 10px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}
/* å±•å¼€çŠ¶æ€ */
.reply-list-container.expanded {
    max-height: 500px;
}
/* å±•å¼€/æ”¶èµ·æŒ‰é’® */
.reply-toggle-btn {
    margin-left: 36px;
    margin-top: 8px;
    background: transparent;
    border: none;
    color: var(--color-green);
    font-size: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
}
.reply-toggle-btn:hover {
    color: var(--color-green-deep);
}
.comment-delete-btn {
    margin-left: 8px;
    padding: 2px 6px;
    font-size: 11px;
    background: transparent;
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: rgba(239, 68, 68, 0.8);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: none; /* é»˜è®¤éšè— */
    opacity: 1;
}
/* ä»…è‡ªå·±çš„è¯„è®ºæ˜¾ç¤ºåˆ é™¤æŒ‰é’® */
.comment-item .comment-delete-btn {
    display: none; /* é»˜è®¤éšè— */
}
.comment-item.own-comment .comment-delete-btn {
    display: inline-block !important; /* è‡ªå·±çš„è¯„è®ºæ˜¾ç¤º */
}
/* ç®¡ç†å‘˜èƒ½çœ‹åˆ°æ‰€æœ‰è¯„è®ºçš„åˆ é™¤æŒ‰é’® */
.comment-item .comment-delete-btn.admin-visible {
    display: inline-block !important;
    /* ç®¡ç†å‘˜åˆ é™¤æŒ‰é’®åŠ çº¢è‰²è¾¹æ¡†ï¼ŒåŒºåˆ†æ™®é€šåˆ é™¤æŒ‰é’® */
    border-color: rgba(239, 68, 68, 0.8);
}
.comment-delete-btn:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
    border-color: #ef4444;
}
/* ä»…è‡ªå·±çš„è¯„è®ºæ˜¾ç¤ºåˆ é™¤æŒ‰é’® */
.comment-item:not(.own-comment) .comment-delete-btn {
    display: none !important;
}
/* å›å¤é¡¹åˆ é™¤æŒ‰é’® - é€‚é…ç®¡ç†å‘˜æƒé™ */
.reply-delete-btn {
    margin-left: 8px;
    padding: 1px 4px;
    font-size: 10px;
    background: transparent;
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: rgba(239, 68, 68, 0.8);
    border-radius: 3px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: none; /* é»˜è®¤éšè— */
    opacity: 1;
}
/* ä»…è‡ªå·±çš„å›å¤æ˜¾ç¤ºåˆ é™¤æŒ‰é’® */
.reply-item .reply-delete-btn {
    display: none; /* é»˜è®¤éšè— */
}
/* ç®¡ç†å‘˜èƒ½çœ‹åˆ°æ‰€æœ‰å›å¤çš„åˆ é™¤æŒ‰é’® */
.reply-item .reply-delete-btn.admin-visible {
    display: inline-block !important;
    border-color: rgba(239, 68, 68, 0.8);
}
.reply-item.own-reply .reply-delete-btn {
    display: inline-block !important; /* è‡ªå·±çš„å›å¤æ˜¾ç¤º */
}
.reply-delete-btn:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
    border-color: #ef4444;
}
.reply-item:not(.own-reply) .reply-delete-btn {
    display: none !important;
}
/* å›å¤ç›¸å…³æ ·å¼ */
.reply-input-box {
    margin-bottom: 15px;
}
.reply-list {
    border-left: 1px solid rgba(56, 161, 105, 0.1);
    padding-left: 10px;
}
.reply-item {
    border-radius: 8px !important;
}
.comment-reply-btn:hover {
    background: var(--color-green) !important;
    color: #fff !important;
}
html[data-theme-mode="light"] .reply-item {
    background: rgba(45, 180, 141, 0.08) !important;
}
/* ğŸ”¥ æ–°å¢ï¼šå¼€å±åŠ¨ç”»æ ·å¼ - ä¿®æ”¹ä¸ºæ¸…æ–°ç»¿è‰²èƒŒæ™¯ */
#loader {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #ffffff;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    transition: opacity 0.6s ease, visibility 0.6s ease;
}
.loading-left-bg, .loading-right-bg {
    position: absolute;
    top: 0;
    width: 50%;
    height: 100%;
    background: #f5faf7;
    transition: transform 0.6s ease;
}
.loading-left-bg { left: 0; }
.loading-right-bg { right: 0; }
#loader.loaded .loading-left-bg { transform: translateX(-100%); }
#loader.loaded .loading-right-bg { transform: translateX(100%); }
#loader.loaded { opacity: 0; visibility: hidden; }
.spinner-box { text-align: center; }
.loading-taichi svg {
    width: 80px;
    height: 80px;
    fill: #2d8b69;
    transition: fill 0.3s ease;
}
.loading-word {
    margin-top: 20px;
    color: #3a9e7c;
    font-size: 16px;
    letter-spacing: 3px;
    transition: color 0.3s ease;
}

/* ç´§æ€¥ä¿®å¤ï¼šè¡¥å…¨ç¼ºå¤±çš„iconfontåŸºç¡€æ ·å¼ */
.iconfont {
    font-family: "iconfont" !important;
    font-size: inherit;
    font-style: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* âœ…âœ…âœ… æ ¸å¿ƒå‡çº§ï¼šæ¶²æ€ç»ç’ƒæ•ˆæœé€šç”¨æ ·å¼ã€iOSé€šé€ç‰ˆã€‘é€‚é…åŒä¸»é¢˜ */
.glass-effect {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(12px) saturate(180%) contrast(1.1) brightness(1.05);
    -webkit-backdrop-filter: blur(12px) saturate(180%) contrast(1.1) brightness(1.05);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.08),
        inset 1px 1px 0 rgba(255, 255, 255, 0.2),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}
.glass-effect-light {
    background: rgba(255, 255, 255, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.3);
}
.glass-effect-dark {
    background: rgba(30, 30, 40, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.08);
}

/* å…¨å±€é‡ç½®å’Œä¿®å¤ */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}
html, body {
    overflow-x: hidden !important;
    position: relative;
    width: 100%;
}
html {
    scrollbar-width: thin;
    scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}
/* ========== æ ¸å¿ƒä¿®æ”¹1ï¼šæ·±è‰²ä¸»é¢˜ æ£®ç³»å¢¨ç»¿é…è‰² + æè‡´åœ†æ¶¦å­—ä½“ ========== */
html[data-theme-mode="dark"] {
    --bg-base: rgba(15, 18, 26, 0.7);
    --bg-mask: linear-gradient(rgba(15, 18, 26, 0.7), rgba(15, 18, 26, 0.65));
    --bg-card: rgba(28,32,42,0.9);
    --bg-card-light: rgba(28,32,42,0.75);
    --bg-nav: rgba(28, 32, 42, 0.6);
    --bg-footer: rgba(28,32,42,0.6);
    --color-text-main: #e2e8e5;
    --color-text-sub: #b8c4bc;
    --color-text-title: #f2f8f5;
    --color-green: #38a169;
    --color-green-deep: #2d8b69;
    --border-color: rgba(255, 255, 255, 0.1);
    --border-color-light: rgba(255,255,255,0.07);
    --shadow-color: rgba(0,0,0,0.25);
    --scrollbar-thumb: rgba(45, 139, 105, 0.6);
    --scrollbar-track: rgba(22,25,29,0.8);
    --glass-bg: rgba(40, 44, 52, 0.08);
    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
    --glass-inset-light: rgba(255, 255, 255, 0.1);
    --glass-inset-dark: rgba(0, 0, 0, 0.05);
    --hover-glow: rgba(45, 139, 105, 0.3);
    --active-scale: 0.97;
    /* âœ… æè‡´åœ†æ¶¦å­—ä½“ç»„åˆ - å½»åº•å»æ‰æ–¹æ­£å­—ä½“ */
    --font-family-main: "æ€æºåœ†è§’ CN", "PingFang SC Round", "Microsoft YaHei UI Light", "åœ†æ¶¦é»‘ä½“ CN", "è‹¹æ–¹-åœ†è§’", sans-serif;
    --font-weight-light: 300;
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-bold: 600;
}
/* ========== æ ¸å¿ƒä¿®æ”¹2ï¼šæµ…è‰²ä¸»é¢˜ ã€å…¨æ–°ä¼˜é›…ç™½è‰²ä¸»é¢˜ - è–„è·ç»¿é…è‰²æ–¹æ¡ˆã€‘ ========== */
html[data-theme-mode="light"] {
    /* èƒŒæ™¯è‰² - æŸ”å’Œçš„æš–ç™½è‰² */
    --bg-base: #fafcf9;
    --bg-mask: linear-gradient(rgba(250, 252, 249, 0.95), rgba(245, 250, 247, 0.9));
    --bg-card: rgba(255, 255, 255, 0.92);
    --bg-card-light: rgba(255, 255, 255, 0.85);
    --bg-nav: rgba(255, 255, 255, 0.85);
    --bg-footer: rgba(255, 255, 255, 0.85);
    
    /* æ–‡å­—é¢œè‰² - ä¼˜é›…çš„æ·±ç°è‰²ç³» */
    --color-text-main: #3a4a42;
    --color-text-sub: #6b7c73;
    --color-text-title: #1c2c22;
    
    /* ä¸»è‰²è°ƒ - æ¸…æ–°è–„è·ç»¿ */
    --color-green: #2db48d;
    --color-green-deep: #1f9c7a;
    
    /* è¾¹æ¡†å’Œé˜´å½± */
    --border-color: rgba(0, 0, 0, 0.08);
    --border-color-light: rgba(0, 0, 0, 0.05);
    --shadow-color: rgba(45, 180, 141, 0.12);
    
    /* æ»šåŠ¨æ¡ */
    --scrollbar-thumb: rgba(45, 180, 141, 0.5);
    --scrollbar-track: rgba(245, 250, 247, 0.9);
    
    /* ç»ç’ƒè´¨æ„Ÿæ•ˆæœ */
    --glass-bg: rgba(255, 255, 255, 0.65);
    --glass-border: rgba(255, 255, 255, 0.9);
    --glass-shadow: 
        0 10px 40px rgba(45, 180, 141, 0.1),
        0 4px 12px rgba(0, 0, 0, 0.04);
    --glass-inset-light: rgba(255, 255, 255, 0.9);
    --glass-inset-dark: rgba(255, 255, 255, 0.3);
    
    /* äº¤äº’æ•ˆæœ */
    --hover-glow: rgba(45, 180, 141, 0.18);
    --active-scale: 0.98;
    
    /* å­—ä½“è®¾ç½® */
    --font-family-main: "æ€æºåœ†è§’ CN", "PingFang SC Round", "Microsoft YaHei UI Light", "åœ†æ¶¦é»‘ä½“ CN", "è‹¹æ–¹-åœ†è§’", sans-serif;
    --font-weight-light: 350;
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-bold: 600;
}
/* ========== æ ¸å¿ƒä¿®æ”¹3ï¼šå…¨å±€å­—ä½“åœ†æ¶¦åŒ–+å¹³æ»‘å¤„ç† ========== */
body {
    font-family: var(--font-family-main);
    min-height: 100vh;
    color: var(--color-text-main);
    scroll-behavior: smooth;
    background-size: cover;
    display: flex;
    flex-direction: column;
    position: relative;
    z-index: 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-text-stroke: 0.2px transparent;
    text-rendering: optimizeLegibility;
    font-size: 15px;
    line-height: 1.75;
    width: 100%;
    transition: font-size 0.3s ease, color 0.3s ease, font-weight 0.3s ease;
    letter-spacing: 0.3px; /* æ–‡å­—é—´è·å¾®è°ƒï¼Œæ›´åœ†æ¶¦èˆ’å±• */
}
/* ç™½è‰²ä¸»é¢˜ä¸“å±ï¼šæ›´æŸ”å’Œçš„èƒŒæ™¯é®ç½© */
html[data-theme-mode="light"] body::before {
    background: linear-gradient(rgba(250, 252, 249, 0.95), rgba(245, 250, 247, 0.9));
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
}
body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--bg-mask);
    z-index: -2;
    display: var(--mask-display, block);
}
a {
    text-decoration: none;
    color: inherit;
}
ul {
    list-style: none;
}
img {
    max-width: 100%;
    border-radius: 8px;
    object-fit: cover;
    object-position: center;
    opacity: 1; /* âœ… æ ¸å¿ƒä¿®å¤ï¼šé»˜è®¤æ˜¾ç¤ºï¼Œä¸å†é€æ˜ */
    transition: opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    transform: translateZ(0);
    will-change: opacity, transform;
}
img.lazy-img { /* âœ… åªç»™éœ€è¦æ‡’åŠ è½½çš„å›¾ç‰‡åŠ é€æ˜ï¼Œå£çº¸ç¼©ç•¥å›¾ä¸å—å½±å“ */
    opacity: 0;
}
img.loaded {
    opacity: 1;
}
img:hover {
    transform: scale(1.02);
}
.sidebar-author img {
    opacity: 1 !important;
    display: block !important;
    margin: 0 auto 10px auto;
}
video {
    max-width: 100%;
    border-radius: 8px;
    object-fit: cover;
    object-position: center;
    opacity: 0;
    transition: opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    cursor: pointer;
    transform: translateZ(0);
    will-change: transform;
}
video.loaded {
    opacity: 1;
}
.rotate {
    transition: transform 4s linear infinite;
}
.rotate:hover {
    transform: rotate(360deg);
}
.container {
    flex: 1;
    position: relative;
    z-index: 3;
    width: 100%;
    max-width: 100vw;
    padding-bottom: 80px;
}
.container-main {
    display: flex;
    gap: 20px;
    max-width: 1200px;
    margin: 20px auto;
    padding: 0 20px;
    position: relative;
    z-index: 5;
    width: 100%;
    min-height: calc(100vh - 200px);
    align-items: flex-start;
}

/* ========== å¯¼èˆªæ æ ·å¼ã€æ¶²æ€ç»ç’ƒç‰ˆã€‘æè‡´ç¾åŒ– âœ¨âœ¨âœ¨ ç»ˆæåŠ¨ç”»ç‰ˆ - å®Œç¾é€‰ä¸­+æ‚¬æµ®+æŒ‰å‹ ç»¿è‰²é€‚é… ========== */
#header-nav {
    width: calc(100% - 40px);
    margin: 0px auto 0 auto;
    border-radius: 20px;
    padding: 5px 20px;
    position: sticky;
    top: 15px;
    z-index: 99;
    display: flex;
    justify-content: space-between; /* å…³é”®ä¿®æ”¹ï¼šæ”¹ä¸ºspace-between */
    align-items: center;
    gap: 10px; /* å¢åŠ é—´è· */
    background: var(--glass-bg);
    backdrop-filter: blur(12px) saturate(180%) contrast(1.1) brightness(1.05);
    -webkit-backdrop-filter: blur(12px) saturate(180%) contrast(1.1) brightness(1.05);
    border: 1px solid var(--glass-border);
    box-shadow: 
        var(--glass-shadow),
        inset 1px 1px 0 var(--glass-inset-light),
        inset -1px -1px 0 var(--glass-inset-dark);
    position: relative; /* æ–°å¢ï¼šä½œä¸ºå®šä½å®¹å™¨ */
}
/* ç™½è‰²ä¸»é¢˜å¯¼èˆªæ ä¼˜åŒ– */
html[data-theme-mode="light"] #header-nav {
    backdrop-filter: blur(16px) saturate(200%) contrast(1.1) brightness(1.08);
    -webkit-backdrop-filter: blur(16px) saturate(200%) contrast(1.1) brightness(1.08);
    box-shadow: 
        0 12px 40px rgba(45, 180, 141, 0.08),
        0 4px 8px rgba(0, 0, 0, 0.02),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(255, 255, 255, 0.4);
}
.nav-center {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute; /* å…³é”®ï¼šç»å¯¹å®šä½åˆ°å¯¼èˆªæ æ­£ä¸­é—´ */
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    gap: 25px;
    margin: 0;
    padding: 0;
    z-index: 0; /* ç¡®ä¿åœ¨å…¶ä»–å…ƒç´ ä¸‹æ–¹ */
    /* æ–°å¢ï¼šé™åˆ¶æœ€å¤§å®½åº¦ï¼Œé¿å…å’Œå³ä¾§é‡å  */
    max-width: calc(100% - 200px);
    /* æ–°å¢ï¼šé˜²æ­¢å†…å®¹æº¢å‡º */
    box-sizing: border-box;
}
.main-nav-link-wrap {
    margin: 0;
    display: inline-block;
}
.main-nav-link {
    padding: 10px 28px;
    font-size: 15px;
    font-weight: var(--font-weight-medium);
    color: var(--color-text-sub);
    border-radius: 26px;
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    overflow: hidden;
    background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(0,0,0,0.02));
    backdrop-filter: blur(10px) saturate(200%);
    -webkit-backdrop-filter: blur(10px) saturate(200%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 
        inset 1px 1px 0 rgba(255,255,255,0.15),
        inset -1px -1px 0 rgba(0,0,0,0.06),
        0 2px 4px rgba(0,0,0,0.03);
    transform: translateZ(0);
}
.main-nav-link.active {
    color: #fff !important;
    background: linear-gradient(145deg, rgba(56,161,105,0.2), rgba(45,139,105,0.15)) !important;
    border-color: rgba(56, 161, 105, 0.5) !important;
    font-weight: var(--font-weight-bold);
    box-shadow: 
        0 8px 25px var(--hover-glow),
        inset 1px 1px 0 rgba(255,255,255,0.2),
        inset -1px -1px 0 rgba(0,0,0,0.08);
    transform: scale(1.03);
}
/* ç™½è‰²ä¸»é¢˜å¯¼èˆªé“¾æ¥ä¼˜åŒ– */
html[data-theme-mode="light"] .main-nav-link {
    color: var(--color-text-main);
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.8);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.03),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
html[data-theme-mode="light"] .main-nav-link.active {
    color: #fff !important;
    background: linear-gradient(135deg, var(--color-green), var(--color-green-deep)) !important;
    border-color: var(--color-green) !important;
    box-shadow: 
        0 8px 25px var(--hover-glow),
        0 4px 8px rgba(45, 180, 141, 0.2),
        inset 1px 1px 0 rgba(255, 255, 255, 0.3),
        inset -1px -1px 0 rgba(0, 0, 0, 0.1);
}
.main-nav-link:hover:not(.active) {
    color: var(--color-green) !important;
    background: rgba(56, 161, 105, 0.08) !important;
    border-color: rgba(56,161,105,0.4) !important;
    transform: translateY(-3px) scale(1.02);
    box-shadow: 
        0 8px 20px var(--hover-glow),
        inset 1px 1px 0 var(--glass-inset-light),
        inset -1px -1px 0 var(--glass-inset-dark);
}
/* ç™½è‰²ä¸»é¢˜æ‚¬åœä¼˜åŒ– */
html[data-theme-mode="light"] .main-nav-link:hover:not(.active) {
    background: rgba(45, 180, 141, 0.12) !important;
    border-color: var(--color-green) !important;
    color: var(--color-green-deep) !important;
    box-shadow: 
        0 8px 20px var(--hover-glow),
        0 4px 8px rgba(45, 180, 141, 0.1),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.main-nav-link:active {
    transform: translateY(0) scale(var(--active-scale));
    box-shadow:0 2px 8px rgba(56,161,105,0.1) !important;
}
.main-nav-link::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
	height: 0;
    border-radius: 50%;
    background: rgba(56, 161, 105, 0.12);
    transform: translate(-50%, -50%);
    transition: width 0.7s ease, height 0.7s ease;
}
.main-nav-link:active::after {
    width: 320px;
    height: 320px;
}
.nav-right {
    display: flex;
    align-items:center;
    justify-content:flex-end;
    flex-shrink:0;
    margin:0;padding:0;
    /* æ–°å¢ï¼šç¡®ä¿åœ¨æœ€å³ä¾§ä¸”ä¸å‹ç¼© */
    flex: 0 0 auto;
    /* æ–°å¢ï¼šå¢åŠ å³ä¾§é—´è·ï¼Œé¿å…è´´è¾¹ */
    margin-left: auto;
    /* ç§»é™¤å›ºå®šå®½åº¦ï¼Œé¿å…å¸ƒå±€é™åˆ¶ */
    width: auto;
    /* æ–°å¢ï¼šé˜²æ­¢å†…å®¹æº¢å‡º */
    padding-left: 20px;
}
.github-login-btn, .user-name-display {
    padding:8px 16px;font-size:14px;color:var(--color-text-sub);background:transparent;border:1px solid rgba(255,255,255,0.08);border-radius:20px;cursor:pointer;transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);display:flex;align-items:center;gap:6px;backdrop-filter:blur(8px) saturate(180%);-webkit-backdrop-filter:blur(8px) saturate(180%);box-shadow:inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);
}
.github-login-btn:hover, .user-name-display:hover {
    background:rgba(56,161,105,0.08);color:var(--color-green);transform:translateY(-3px) scale(1.02);border-color:rgba(56,161,105,0.2);box-shadow:0 6px 20px var(--hover-glow);
}
.github-login-btn:active, .user-name-display:active {transform:translateY(0) scale(var(--active-scale));}
.user-name-display {color:var(--color-green);}
.theme-bg-switch-group {
    display:flex;
    align-items:center;
    gap:12px;
    z-index:1;
    flex-shrink: 0; /* é˜²æ­¢è¢«å‹ç¼© */
}
.theme-switch-wrap {width:55px;display:flex;align-items:center;justify-content:flex-start;flex-shrink:0;margin:0;padding:0;position:static;transform:none;}
.bg-switch-wrap {width:90px;height:26px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin:0;padding:0;}
.bg-switch-btn {width:90px;height:26px;border-radius:34px;background-color:transparent;border:1px solid var(--border-color);cursor:pointer;display:flex;align-items:center;justify-content:center;gap:4px;color:var(--color-text-sub);font-size:13px;transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);backdrop-filter:blur(3px) saturate(150%);-webkit-backdrop-filter:blur(3px) saturate(150%);box-shadow:inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);}
/* ========== æ–°å¢ï¼šåˆ‡æ¢èƒŒæ™¯æŒ‰é’®æ‚¬æµ®æç¤ºæ¡†æ ·å¼ - å’Œæ–°é—»æ¡†ç»ç’ƒæ•ˆæœä¸€è‡´ ========== */
.bg-switch-wrap {
    position: relative; /* å¿…é¡»åŠ ï¼Œè®©æç¤ºæ¡†ç›¸å¯¹æŒ‰é’®å®šä½ */
}
/* æç¤ºæ¡†å°ç®­å¤´ - é”¦ä¸Šæ·»èŠ±ï¼ŒæŒ‡å‘æŒ‰é’®ï¼Œæ›´ç¾è§‚ */
.bg-tips-box::before {
    content: '';
    position: absolute;
    top: -6px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid var(--glass-border);
}
/* æ˜¾ç¤ºçŠ¶æ€ */
.bg-tips-box.show {
    opacity: 1;
    pointer-events: all;
}
/* ç™½è‰²ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .bg-switch-btn {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    color: var(--color-text-main);
    box-shadow: 
        0 2px 6px rgba(0, 0, 0, 0.04),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.bg-switch-btn:hover {background-color:rgba(56,161,105,0.08);border-color:rgba(56,161,105,0.3);box-shadow:0 0 12px var(--hover-glow);color:var(--color-green);transform:translateY(-3px) scale(1.03);}
html[data-theme-mode="light"] .bg-switch-btn:hover {
    background: rgba(45, 180, 141, 0.12);
    border-color: var(--color-green);
    color: var(--color-green-deep);
    box-shadow: 
        0 4px 12px var(--hover-glow),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.bg-switch-btn:active {transform:translateY(0) scale(var(--active-scale));}
.theme-switch {position:relative;display:inline-block;width:52px;height:26px;cursor:pointer;}
.theme-switch input {opacity:0;width:0;height:0;}
.theme-slider {position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:transparent;border-radius:34px;border:1px solid var(--border-color);transition:all 0.3s cubic-bezier(0.34,1.56,0.64,1);backdrop-filter:blur(3px) saturate(150%);-webkit-backdrop-filter:blur(3px) saturate(150%);box-shadow:inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);}
.theme-slider:before {position:absolute;content:"";height:20px;width:20px;left:2px;bottom:2px;background-color:rgba(255,255,255,0.9);border-radius:50%;transition:all 0.3s cubic-bezier(0.34,1.56,0.64,1);display:flex;align-items:center;justify-content:center;color:#333;font-size:10px;content:"ğŸŒ™";box-shadow:0 2px 6px rgba(0,0,0,0.15);}
input:checked + .theme-slider {background-color:rgba(56,161,105,0.08);border-color:rgba(56,161,105,0.2);box-shadow:0 0 10px var(--hover-glow);}
input:checked + .theme-slider:before {transform:translateX(26px);content:"â˜€ï¸";background-color:var(--color-green);color:#fff;box-shadow:0 2px 8px rgba(56,161,105,0.3);}
.theme-slider:hover {box-shadow:0 0 10px var(--hover-glow);}
/* ç™½è‰²ä¸»é¢˜åˆ‡æ¢æ»‘å—ä¼˜åŒ– */
html[data-theme-mode="light"] .theme-slider {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
html[data-theme-mode="light"] input:checked + .theme-slider {
    background: rgba(45, 180, 141, 0.15);
    border-color: var(--color-green);
    box-shadow: 0 0 12px rgba(45, 180, 141, 0.2);
}
html[data-theme-mode="light"] input:checked + .theme-slider:before {
    background: var(--color-green);
    color: #fff;
    box-shadow: 0 2px 8px rgba(45, 180, 141, 0.3);
}

/* ======================================
   âœ¨ é»‘è‰²ä¸»é¢˜ä¸“å± å­—ä½“å¤§å°+ç²—ç»† ç²¾ç»†åŒ–ç¾åŒ–
   ====================================== */
html[data-theme-mode="dark"] .sidebar-author-name {font-size:18px;font-weight:var(--font-weight-bold);letter-spacing:1px;}
html[data-theme-mode="dark"] .sidebar-description {font-size:14px;font-weight:var(--font-weight-light);color:var(--color-text-sub);}
html[data-theme-mode="dark"] .sidebar-menu-link {font-size:15px;font-weight:var(--font-weight-normal);}
html[data-theme-mode="dark"] .sidebar-menu-link:hover {font-weight:var(--font-weight-bold);}
html[data-theme-mode="dark"] .main-nav-link {color:var(--color-text-sub);border-color:rgba(255,255,255,0.1);box-shadow:inset 1px 1px 0 rgba(255,255,255,0.2),inset -1px -1px 0 rgba(0,0,0,0.06);}
html[data-theme-mode="dark"] .article-title {font-size:28px;font-weight:var(--font-weight-bold);color:var(--color-text-title);letter-spacing:1px;}
html[data-theme-mode="dark"] .article-signature {font-size:16px;font-weight:var(--font-weight-light);line-height:1.8;}
html[data-theme-mode="dark"] .article-signature strong {font-weight:var(--font-weight-bold);color:var(--color-green);}
html[data-theme-mode="dark"] .search-input {font-size:15px;font-weight:var(--font-weight-normal);}
html[data-theme-mode="dark"] .search-btn {font-size:15px;font-weight:var(--font-weight-bold);}
html[data-theme-mode="dark"] .news-title {font-size:24px;font-weight:var(--font-weight-bold);letter-spacing:0.5px;color:var(--color-text-title) !important;}
html[data-theme-mode="dark"] .news-content {font-size:17px;font-weight:var(--font-weight-normal);line-height:1.9;color:var(--color-text-main) !important;}
html[data-theme-mode="dark"] .news-date {font-size:13px;font-weight:var(--font-weight-light);opacity:0.9;}
html[data-theme-mode="dark"] .modal-news-title {font-size:25px;font-weight:var(--font-weight-bold);letter-spacing:1px;}
html[data-theme-mode="dark"] .modal-news-desc {font-size:17px;font-weight:var(--font-weight-normal);line-height:1.9;}
html[data-theme-mode="dark"] .modal-news-date {font-size:12px;font-weight:var(--font-weight-light);}
html[data-theme-mode="dark"] .update-log-title {font-size:15px;font-weight:var(--font-weight-bold);}
html[data-theme-mode="dark"] .update-log-version {font-size:14px;font-weight:var(--font-weight-bold);}
html[data-theme-mode="dark"] .update-log-content {font-size:13px;font-weight:var(--font-weight-light);line-height:1.7;}
html[data-theme-mode="dark"] #footer {font-size:13px;font-weight:var(--font-weight-light);}
html[data-theme-mode="dark"] #footer a {font-weight:var(--font-weight-bold);}
html[data-theme-mode="dark"] .music-text {font-size:12px;font-weight:var(--font-weight-light);}
html[data-theme-mode="dark"] .bg-switch-btn {font-size:13px;font-weight:var(--font-weight-normal);}
html[data-theme-mode="dark"] .news-item:hover .news-title {color:var(--color-green) !important;font-weight:700;}
/* ======================================
   âœ¨ ç™½è‰²ä¸»é¢˜ä¸“å± å­—ä½“å¤§å°+ç²—ç»† ç²¾ç»†åŒ–ç¾åŒ–
   ====================================== */
html[data-theme-mode="light"] .sidebar-author-name {
    font-size: 19px;
    font-weight: var(--font-weight-bold);
    letter-spacing: 1px;
    color: var(--color-text-title);
}
html[data-theme-mode="light"] .sidebar-description {
    font-size: 14px;
    font-weight: var(--font-weight-light);
    color: var(--color-text-sub);
}
html[data-theme-mode="light"] .sidebar-menu-link {
    font-size: 15px;
    font-weight: var(--font-weight-normal);
    color: var(--color-text-main);
}
html[data-theme-mode="light"] .sidebar-menu-link:hover {
    font-weight: var(--font-weight-bold);
    color: var(--color-green-deep);
}
html[data-theme-mode="light"] .main-nav-link {
    color: var(--color-text-main);
    border-color: rgba(255, 255, 255, 0.9);
    box-shadow: inset 1px 1px 0 rgba(255,255,255,0.95), inset -1px -1px 0 rgba(0,0,0,0.06);
}
html[data-theme-mode="light"] .main-nav-link:hover:not(.active) {
    color: var(--color-green-deep) !important;
    background: rgba(45, 180, 141, 0.12) !important;
    border-color: var(--color-green) !important;
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 20px var(--hover-glow);
}
html[data-theme-mode="light"] .main-nav-link.active {
    color: #fff !important;
    font-weight: var(--font-weight-bold);
    background: linear-gradient(135deg, var(--color-green), var(--color-green-deep)) !important;
    border-color: var(--color-green) !important;
}
html[data-theme-mode="light"] .article-title {
    font-size: 32px;
    font-weight: var(--font-weight-bold);
    color: var(--color-text-title);
    letter-spacing: 2px;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}
html[data-theme-mode="light"] .article-signature {
    font-size: 16px;
    font-weight: var(--font-weight-light);
    line-height: 1.8;
    color: var(--color-text-main);
}
html[data-theme-mode="light"] .article-signature strong {
    font-weight: var(--font-weight-bold);
    color: var(--color-green);
}
html[data-theme-mode="light"] .search-input {
    font-size: 15px;
    font-weight: var(--font-weight-normal);
}
html[data-theme-mode="light"] .search-btn {
    font-size: 15px;
    font-weight: var(--font-weight-bold);
}
html[data-theme-mode="light"] .news-title {
    font-size: 26px;
    font-weight: var(--font-weight-bold);
    letter-spacing: 0.5px;
    color: var(--color-text-title) !important;
}
html[data-theme-mode="light"] .news-content {
    font-size: 17px;
    font-weight: var(--font-weight-normal);
    line-height: 1.9;
    color: var(--color-text-main) !important;
}
html[data-theme-mode="light"] .news-date {
    font-size: 13px;
    font-weight: var(--font-weight-light);
    opacity: 0.9;
}
html[data-theme-mode="light"] .modal-news-title {
    font-size: 28px;
    font-weight: var(--font-weight-bold);
    letter-spacing: 1px;
    color: #000 !important; /* æ—¥è®°æ ‡é¢˜æ”¹æˆçº¯é»‘è‰² */
}
html[data-theme-mode="light"] .modal-news-desc {
    font-size: 17px;
    font-weight: var(--font-weight-normal);
    line-height: 1.9;
    color: #000 !important; /* æ—¥è®°å†…å®¹æ”¹æˆçº¯é»‘è‰² */
}
html[data-theme-mode="light"] .modal-news-date {
    font-size: 12px;
    font-weight: var(--font-weight-light);
    color: #333 !important; /* æ—¥æœŸæ”¹æˆæ·±ç°è‰²ï¼Œæ¯”çº¯é»‘ç¨æµ…æ›´åè°ƒ */
}
html[data-theme-mode="light"] .update-log-title {
    font-size: 15px;
    font-weight: var(--font-weight-bold);
}
html[data-theme-mode="light"] .update-log-version {
    font-size: 14px;
    font-weight: var(--font-weight-bold);
}
html[data-theme-mode="light"] .update-log-content {
    font-size: 13px;
    font-weight: var(--font-weight-light);
    line-height: 1.7;
}
html[data-theme-mode="light"] #footer {
    font-size: 13px;
    font-weight: var(--font-weight-light);
}
html[data-theme-mode="light"] #footer a {
    font-weight: var(--font-weight-bold);
}
html[data-theme-mode="light"] .music-text {
    font-size: 12px;
    font-weight: var(--font-weight-light);
}
html[data-theme-mode="light"] .bg-switch-btn {
    font-size: 13px;
    font-weight: var(--font-weight-normal);
}
html[data-theme-mode="light"] .news-item:hover .news-title {
    color: var(--color-green) !important;
    font-weight: 700;
}
/* ========== ä¾§è¾¹æ æ ·å¼ ã€å®Œç¾ä¿®å¤âœ… è·Ÿéšæ»šåŠ¨+ä¿ç•™æ‰€æœ‰ç¾åŒ–æ•ˆæœã€‘ ========== */
#sidebar {
  width:270px;
  position:sticky !important;
  top: 88px;
  flex-shrink:0;
  margin-top:0;
  margin-left: -15px;
  margin-right: 8px;
  height: auto;
  align-self:flex-start;
  z-index:9;
}
.sidebar-wrap {
  background:var(--glass-bg);
  border-radius:20px;
  padding:25px;
  box-shadow:var(--glass-shadow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);
  border:1px solid var(--glass-border);
  transition:box-shadow 0.3s ease, transform 0.3s ease;
  backdrop-filter:blur(12px) saturate(180%) contrast(1.1);
  -webkit-backdrop-filter:blur(12px) saturate(180%) contrast(1.1);
  position:relative;
}
/* ç™½è‰²ä¸»é¢˜ä¾§è¾¹æ ä¼˜åŒ– */
html[data-theme-mode="light"] .sidebar-wrap {
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(20px) saturate(200%) contrast(1.1);
    -webkit-backdrop-filter: blur(20px) saturate(200%) contrast(1.1);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        0 15px 50px rgba(45, 180, 141, 0.08),
        0 8px 20px rgba(0, 0, 0, 0.03),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.sidebar-wrap:hover {box-shadow:0 10px 30px rgba(0,0,0,0.1),0 0 20px var(--hover-glow);}
.update-log-time-text {font-size:12px;color:var(--color-text-sub);padding-left:15px;margin-top:2px;}
.sidebar-author {text-align:center;}
.sidebar-author img {
    width:100px;height:100px;border-radius:50%;border:2px solid rgba(56,161,105,0.15);margin-bottom:10px;box-shadow:0 0 20px rgba(56,161,105,0.1);transition:all 0.6s cubic-bezier(0.34,1.56,0.64,1);
}
/* ç™½è‰²ä¸»é¢˜å¤´åƒä¼˜åŒ– */
html[data-theme-mode="light"] .sidebar-author img {
    border: 2px solid rgba(45, 180, 141, 0.2);
    box-shadow: 
        0 8px 25px rgba(45, 180, 141, 0.15),
        0 4px 8px rgba(0, 0, 0, 0.05);
}
.sidebar-author img:hover {transform:scale(1.15) rotate(5deg);box-shadow:0 0 40px var(--hover-glow);border-color:rgba(56,161,105,0.4);}
html[data-theme-mode="light"] .sidebar-author img:hover {
    border-color: var(--color-green);
    box-shadow: 
        0 12px 40px rgba(45, 180, 141, 0.25),
        0 8px 20px rgba(0, 0, 0, 0.08);
}
.sidebar-author-name {font-size:18px;font-weight:var(--font-weight-bold);color:var(--color-text-title);margin-bottom:5px;}
.sidebar-description {color:var(--color-text-sub);font-size:14px;font-weight:var(--font-weight-light);}
.sidebar-social {display:flex;justify-content:center;gap:20px;font-size:22px;margin:0px 0;}
.sidebar-social a {color:var(--color-text-sub);transition:all 0.5s cubic-bezier(0.34,1.56,0.64,1);}
.sidebar-social a:hover {color:var(--color-green);transform:translateY(-4px) scale(1.3);text-shadow:0 0 10px var(--hover-glow);}
.sidebar-menu-link-wrap {margin:15px 0;}
.sidebar-menu-link {color:var(--color-text-sub);font-size:15px;padding:8px 0;display:block;transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);font-weight:var(--font-weight-normal);}
.sidebar-menu-link:hover {color:var(--color-green);padding-left:8px;transform:translateX(2px);font-weight:var(--font-weight-bold);}
/* ç½‘ç«™è®¿é—®ç»Ÿè®¡æ ·å¼ - é€‚é…åŒä¸»é¢˜ï¼Œå’Œä¾§è¾¹æ é£æ ¼ç»Ÿä¸€ */
.sidebar-stat-wrap {
    padding: 0px 0;
    border-radius: 12px;
    display: flex;
    /* æŠŠ space-around æ”¹æˆ centerï¼Œå•ä¸ªå…ƒç´ å±…ä¸­ */
    justify-content: center;
    align-items: center;
    background: rgba(255,255,255,0.05);
}
/* ç™½è‰²ä¸»é¢˜ç»Ÿè®¡ä¼˜åŒ– */
html[data-theme-mode="light"] .sidebar-stat-wrap {
    background: rgba(255, 255, 255, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.8);
}
.stat-item {
    text-align: center; 
    flex: 1; 
    user-select: none;
    pointer-events: none;
}
.sidebar-stat-title {
    font-size: 15px;
    font-weight: var(--font-weight-bold);
    color: var(--color-green);
    margin-bottom: 10px;
    padding-bottom: 6px;
    border-bottom: 1px solid rgba(56,161,105,0.1);
    text-align: center;
}
.sidebar-stat-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 6px 0;
    font-size: 14px;
}
.stat-icon {
    width: 20px;
    text-align: center;
}
.stat-text {
    font-size: 12px;
    color: var(--color-text-sub);
}
.stat-num {
    font-size: 22px;
    font-weight: var(--font-weight-bold);
    color: var(--color-green);
    margin-bottom: -5px;
}
.sidebar-update-log {
    margin-top:3px;padding:16px;padding-top:5px;background:transparent;border-radius:16px;border:1px solid rgba(255,255,255,0.08);max-height:220px;overflow-y:auto;overflow-x:hidden;scrollbar-width:none;-ms-overflow-style:none;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);
}
/* ç™½è‰²ä¸»é¢˜æ›´æ–°æ—¥å¿—ä¼˜åŒ– */
html[data-theme-mode="light"] .sidebar-update-log {
    background: rgba(255, 255, 255, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px) saturate(180%);
    -webkit-backdrop-filter: blur(10px) saturate(180%);
}
.sidebar-update-log::-webkit-scrollbar {display:none;}
.update-log-title {font-size:15px;font-weight:var(--font-weight-bold);color:var(--color-green);margin-bottom:12px;padding-bottom:6px;border-bottom:1px solid rgba(56,161,105,0.1);}
.update-log-version {font-size:14px;font-weight:var(--font-weight-bold);color:var(--color-text-title);margin:10px 0 4px 0;}
.update-log-content {font-size:13px;color:var(--color-text-sub);padding-left:15px;line-height:1.7;font-weight:var(--font-weight-light);}
.update-log-time {margin-top:15px;padding-top:10px;border-top:1px solid var(--border-color-light);font-size:12px;color:var(--color-text-sub);text-align:center;}
/* ========== ä¸»å†…å®¹åŒºåŸŸ ========== */
#content {
  flex: 1;
  width: 100%;
  position:relative;
  z-index:6;
  margin: 0 auto;
  text-align: center;
}
#main {
  flex:1;
  position:relative;
  z-index:6;
  max-width: 100%;
  margin: 0 auto;
}
.article-inner {
    background: var(--glass-bg);
    border-radius: 20px;
    padding: 30px 35px 35px 35px;
    margin-bottom: 25px;
    box-shadow: var(--glass-shadow), inset 1px 1px 0 var(--glass-inset-light), inset -1px -1px 0 var(--glass-inset-dark);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
    -webkit-backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
    position: relative;
    transition: all 0.3s ease;
    margin: 15px auto 25px auto;
}
/* ç™½è‰²ä¸»é¢˜æ–‡ç« åŒºåŸŸä¼˜åŒ– */
html[data-theme-mode="light"] .article-inner {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(25px) saturate(200%) contrast(1.1);
    -webkit-backdrop-filter: blur(25px) saturate(200%) contrast(1.1);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        0 20px 60px rgba(45, 180, 141, 0.08),
        0 10px 30px rgba(0, 0, 0, 0.03),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.article-inner .search-box-container {
    width: 100%;
    display: flex;
    gap: 10px;
    margin: 25px 0 0 0;
    align-items:center;
    justify-content:center;
}
.article-inner:hover {box-shadow:0 10px 30px rgba(0,0,0,0.08),0 0 20px var(--hover-glow);}
html[data-theme-mode="light"] .article-inner:hover {
    box-shadow: 
        0 25px 70px rgba(45, 180, 141, 0.12),
        0 15px 40px rgba(0, 0, 0, 0.05),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.article-title {font-size:28px;text-align:center;color:var(--color-text-title);margin-bottom:15px;font-weight:var(--font-weight-bold);letter-spacing:1px;}
.article-signature {text-align:center;line-height:2;font-size:16px;color:var(--color-text-sub);padding:0 10px;font-weight:var(--font-weight-light);}

/* âœ…âœ…âœ… æ–°å¢ï¼šæœç´¢æ¡†+æœç´¢/é‡ç½®æŒ‰é’® HTMLç»“æ„ */
.search-box-container {width:100%;display:flex;gap:10px;align-items:center;justify-content:center;}
.search-input {
    flex:1;height:42px;background:transparent;border:1px solid rgba(255,255,255,0.1);border-radius:12px;padding:0 20px;color:var(--color-text-main);font-size:15px;outline:none;transition:all 0.3s ease;backdrop-filter:blur(10px) saturate(150%);-webkit-backdrop-filter:blur(10px) saturate(150%);box-shadow:inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);font-family:var(--font-family-main);
}
/* ç™½è‰²ä¸»é¢˜æœç´¢æ¡†ä¼˜åŒ– */
html[data-theme-mode="light"] .search-input {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(218, 218, 218, 0.9);
    box-shadow: 
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05),
        0 2px 4px rgba(0, 0, 0, 0.02);
}
.search-input::placeholder {color:var(--color-text-sub);font-size:14px;font-weight:var(--font-weight-light);}
.search-input:focus {border-color:rgba(56,161,105,0.4);box-shadow:0 0 15px var(--hover-glow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);}
html[data-theme-mode="light"] .search-input:focus {
    border-color: var(--color-green);
    box-shadow: 
        0 0 0 3px rgba(45, 180, 141, 0.15),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.search-btn {
    height:42px;padding:0 25px;background:transparent;border:1px solid var(--glass-border);border-radius:12px;color:var(--color-green);font-size:15px;cursor:pointer;transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);display:flex;align-items:center;justify-content:center;backdrop-filter:blur(10px) saturate(180%);-webkit-backdrop-filter:blur(10px) saturate(180%);box-shadow:var(--glass-shadow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);font-weight:var(--font-weight-medium);
}
/* ç™½è‰²ä¸»é¢˜æœç´¢æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .search-btn {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    color: var(--color-green);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.04),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.search-btn:hover {background:rgba(56,161,105,0.08);transform:translateY(-3px) scale(1.02);border-color:rgba(56,161,105,0.4);box-shadow:0 8px 20px var(--hover-glow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);}
html[data-theme-mode="light"] .search-btn:hover {
    background: rgba(45, 180, 141, 0.12);
    color: var(--color-green-deep);
    border-color: var(--color-green);
    box-shadow: 
        0 8px 20px var(--hover-glow),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.search-btn:active {transform:translateY(0) scale(var(--active-scale));box-shadow:0 2px 8px rgba(56,161,105,0.1) !important;}
.search-empty-tips {text-align:center;color:var(--color-text-sub);padding:40px 20px;font-size:15px;width:100%;font-weight:var(--font-weight-light);}

.news-container {width:100%;display:flex;flex-direction:column-reverse;gap:20px;position:relative;z-index:999;}
.news-item {
    background: var(--glass-bg);border-radius:35px;border:1px solid var(--glass-border);
    box-shadow:var(--glass-shadow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);
    padding:25px;position:relative;z-index:9999;color:var(--color-text-main);margin-bottom:4px;width:100%;overflow:hidden;
    transition:all 0.8s cubic-bezier(0.25, 0.8, 0.25, 1);
    opacity: 0;
    will-change: transform, opacity;
    display:flex;justify-content:space-between;gap:20px;align-items:flex-start;
    backdrop-filter: blur(12px) saturate(180%) contrast(1.1);-webkit-backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
}
/* ç™½è‰²ä¸»é¢˜æ–°é—»å¡ç‰‡ä¼˜åŒ– */
html[data-theme-mode="light"] .news-item {
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(25px) saturate(200%) contrast(1.1);
    -webkit-backdrop-filter: blur(25px) saturate(200%) contrast(1.1);
    box-shadow: 
        0 15px 50px rgba(45, 180, 141, 0.06),
        0 8px 20px rgba(0, 0, 0, 0.03),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
/* å…¥åœºæ¿€æ´»æ ·å¼ - ä¸­é—´æ­£å¸¸ä½ç½® */
.news-item.active {
    transform: translate3d(0, 0, 0);
    opacity: 1;
}
/* ç¦»åœºæ ·å¼ - å³ä¸Šè§’æ¶ˆå¤± */
.news-item.out {
    opacity: 0;
}
.news-item:nth-child(even) {flex-direction: row;}
.news-item:nth-child(odd) {flex-direction: row-reverse;justify-content: space-between;}
/* å¥‡æ•°é¡¹ ç¦»åœº â†’ å‘å·¦æ»‘å‡ºå±å¹• */
.news-item.out:nth-child(odd) {
    transform: translate3d(-100%, 0, 0);
}
/* å¶æ•°é¡¹ ç¦»åœº â†’ å‘å³æ»‘å‡ºå±å¹• */
.news-item.out:nth-child(even) {
    transform: translate3d(100%, 0, 0);
}
.news-text-box {flex:0 0 60%;display:flex;flex-direction:column;justify-content:space-between;min-height:200px;}
.news-media-box {flex:0 0 35%;height:200px;border-radius:12px;overflow:hidden;border:1px solid rgba(56,161,105,0.08);box-shadow:0 3px 10px rgba(0,0,0,0.05);}
/* ç™½è‰²ä¸»é¢˜åª’ä½“æ¡†ä¼˜åŒ– */
html[data-theme-mode="light"] .news-media-box {
    border: 1px solid rgba(255, 255, 255, 0.8);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.04),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.news-item:hover {
    transform: translateY(-6px) scale(1.01) translateZ(0) rotate(0deg) !important;
    box-shadow:0 15px 35px rgba(0,0,0,0.12), 0 0 30px var(--hover-glow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);
    border-color: rgba(56,161,105,0.2);
    opacity: 1 !important;
}
/* ç™½è‰²ä¸»é¢˜æ–°é—»æ‚¬åœä¼˜åŒ– */
html[data-theme-mode="light"] .news-item:hover {
    transform: translateY(-8px) scale(1.01) translateZ(0) rotate(0deg) !important;
    box-shadow: 
        0 25px 70px rgba(45, 180, 141, 0.12),
        0 15px 40px rgba(0, 0, 0, 0.06),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
    border-color: var(--color-green);
    background: rgba(255, 255, 255, 0.85);
}
.news-title {font-size:24px;color:var(--color-text-title)!important;font-weight:var(--font-weight-bold);margin-bottom:12px;letter-spacing:1px;cursor:pointer;transition: all 0.3s ease;}
.news-title:hover {color:var(--color-green)!important;}
.news-content {font-size:17px;color:var(--color-text-main)!important;line-height:1.9;font-weight:var(--font-weight-normal);}
.news-date {
    font-size: 13px;
    color: var(--color-green);
    opacity: 0.95;
    z-index: 10;
    pointer-events: none;
    margin-top: auto;
    padding-top: 10px;
    font-weight: var(--font-weight-light);
    display: flex; /* å…³é”®ï¼šè®©ç‚¹èµå’Œæ—¥æœŸåœ¨åŒä¸€è¡Œ */
    align-items: center; /* å‚ç›´å±…ä¸­ */
    gap: 8px; /* é—´è· */
}
.news-img-item, .news-video-item {width:100%;height:100%;object-fit:cover;object-position:center;cursor:pointer;transition:all 0.3s ease;display:block;}
.news-img-item:hover, .news-video-item:hover {transform:scale(1.03);box-shadow:0 0 12px var(--hover-glow);}
.news-loading {text-align:center;color:var(--color-green);padding:40px 20px;font-size:15px;}
.comment-area {margin-top:15px;padding-top:15px;border-top:1px solid rgba(255,255,255,0.08);width:100%;display:none;}
.comment-title {display:none;}
.utter-container {opacity:0;visibility:hidden;max-height:0;overflow:hidden;}

.news-like-btn {
    display: inline-flex; /* å…³é”®ï¼šè¡Œå†…flexï¼Œä¸ç‹¬å ä¸€è¡Œ */
    align-items: center;
    gap: 3px;
    color: var(--color-green);
    font-size: 16px;
    padding: 2px 6px;
    border-radius: 6px;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s ease;
    font-weight: var(--font-weight-medium);
    pointer-events: auto; /* æ¢å¤ç‚¹å‡»äº‹ä»¶ */
}
.news-like-btn:hover {
    color: var(--color-green-deep);
    transform: scale(1.05);
}
/* ç§»é™¤ç¦ç”¨æ ·å¼ï¼Œä¿ç•™é¢œè‰²æ ·å¼ä½†å–æ¶ˆç¦æ­¢ç‚¹å‡» */
.news-like-btn.liked {
    color: var(--color-green) !important; /* ä¿æŒç»¿è‰² */
    /* ç§»é™¤ cursor: not-allowed */
}
.news-like-count {
    font-size: 12px;
    font-weight: var(--font-weight-medium);
}
.modal-news-like-btn {
    display: inline-flex; /* å…³é”®ï¼šè¡Œå†…flexï¼Œä¸ç‹¬å ä¸€è¡Œ */
    align-items: center;
    gap: 3px;
    color: var(--color-green);
    font-size: 14px;
    padding: 2px 6px;
    border-radius: 6px;
    cursor: pointer;
    user-select: none;
    transition: all 0.2s ease;
    font-weight: var(--font-weight-medium);
    pointer-events: auto; /* æ¢å¤ç‚¹å‡»äº‹ä»¶ */
}
.modal-news-like-btn:hover {
    color: var(--color-green-deep);
    transform: scale(1.05);
}
/* ç§»é™¤ç¦ç”¨æ ·å¼ï¼Œä¿ç•™é¢œè‰²æ ·å¼ä½†å–æ¶ˆç¦æ­¢ç‚¹å‡» */
.modal-news-like-btn.liked {
    color: var(--color-green) !important; /* ä¿æŒç»¿è‰² */
    /* ç§»é™¤ cursor: not-allowed */
}
.modal-news-like-count {
    font-size: 11px;
    font-weight: var(--font-weight-medium);
}
/* ========== æ ¸å¿ƒä¿®å¤ï¼šè‡ªå®šä¹‰æç¤ºå¼¹çª—æ ·å¼ã€ç»ç’ƒè´¨æ„Ÿï¼Œå®Œç¾åŒ¹é…é¡µé¢é£æ ¼ã€‘ ========== */
/* å³ä¸Šè§’å°å‹æç¤ºæ¡†æ ·å¼ - é€‚é…é¡µé¢ç»ç’ƒé£æ ¼ */
.toast-notification {
    position: fixed;
    top: 80px;
    right: 20px;
    background: var(--glass-bg);
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    border: 1px solid var(--glass-border);
    border-radius: 8px;
    padding: 10px 18px;
    color: var(--color-text-main);
    font-size: 14px;
    box-shadow: var(--glass-shadow);
    z-index: 999999; /* ç¡®ä¿åœ¨æœ€é¡¶å±‚ */
    opacity: 0;
    transform: translateX(100%); /* åˆå§‹åœ¨å³ä¾§å¤– */
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex;
    align-items: center;
    gap: 8px;
}

.toast-notification.show {
    opacity: 1;
    transform: translateX(0); /* æ»‘å…¥å¯è§†åŒºåŸŸ */
}

.toast-notification .icon {
    color: var(--color-green);
    font-size: 16px;
    font-weight: bold;
}
/* åŠ è½½è½¬åœˆåŠ¨ç”»æ ·å¼ */
.toast-notification .loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid var(--color-green);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* è°ƒæ•´æˆåŠŸå›¾æ ‡æ ·å¼ï¼Œå’ŒåŠ è½½åŠ¨ç”»å¯¹é½ */
.toast-notification .success-icon {
  font-size: 16px;
  font-weight: bold;
  color: var(--color-green);
}
.tip-modal-mask {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: 99999;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
    padding: 20px 10px;
    box-sizing: border-box;
}
.tip-modal-mask.show {
    opacity: 1;
    pointer-events: all;
}
.tip-modal-box {
    width: 100%;
    max-width: 380px;
    padding: 25px 20px;
    border-radius: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 15px;
    transform: translateY(15px) scale(0.95);
    transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
}
.tip-modal-mask.show .tip-modal-box {
    transform: translateY(0) scale(1);
}
.tip-modal-icon {
    font-size: 32px;
    color: #ffffff !important;
    font-weight: bold;
}
.tip-modal-text {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.98) !important;
    text-align: center;
    font-weight: var(--font-weight-medium);
    line-height: 1.6;
}
.tip-modal-close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.5s cubic-bezier(0.34,1.56,0.64,1);
    backdrop-filter: blur(8px) saturate(180%);
    -webkit-backdrop-filter: blur(8px) saturate(180%);
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow:0 2px 8px rgba(0,0,0,0.08),inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);
    color: var(--color-green);
}
.tip-modal-close-btn:hover {
    background:rgba(56,161,105,0.15);
    color:#fff;
    transform:rotate(120deg) scale(1.1);
    box-shadow:0 0 15px var(--hover-glow);
    border-color:rgba(56,161,105,0.3);
}
.tip-modal-close-btn:active {
    transform: rotate(90deg) scale(var(--active-scale));
}

/* âœ…âœ…âœ… æ ¸å¿ƒä¿®æ”¹ï¼šå£çº¸å¼¹çª—æ ·å¼+ä¸€è¡Œ4ä¸ªå£çº¸+åˆ†ç±»æŒ‰é’®æ ·å¼ å®Œç¾é€‚é… */
#bgModalMask {
    padding: 20px !important;
    align-items: flex-start !important;
    overflow-y: auto !important;
}
#bgModalMask .tip-modal-box {
    padding: 15px !important;
    margin: 0 auto !important;
    margin-top: 15px !important;
    top: 0 !important;
    left: 0 !important;
    transform: none !important;
    width: 95% !important;
    max-width: 1200px !important;
    max-height: 90vh !important;
    overflow: hidden !important;
    box-sizing: border-box !important;
}
/* ç½®é¡¶æ ‡é¢˜æ +åˆ†ç±»æ ï¼Œæ°¸ä¸æ»šåŠ¨æ¶ˆå¤± */
#bgModalMask .tip-modal-box > div:first-child,
#bgModalMask .tip-modal-box > div:nth-child(2),
#bgModalMask .tip-modal-box > div:nth-child(3) {
    padding: -1px 0 8px 0 !important;
    margin: 0 !important;
    width: 100% !important;
}
/* æ¯ä¸ªå£çº¸ç¼©ç•¥å›¾ ä¸¥æ ¼åœ¨åˆ—è¡¨å†…ï¼Œä¸æŒ¤å‹ */
#bgThumbList .bg-thumb-item {
    width: 100% !important;
    height: 110px !important;
    margin: 0 !important;
    padding: 0 !important;
    border-radius: 10px !important;
    overflow: hidden !important;
    box-sizing: border-box !important;
}
#bgThumbList .bg-thumb-item img {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    display: block !important;
}
/* âœ… æ ¸å¿ƒä¿®æ”¹ï¼šä¸€è¡Œå›ºå®šæ˜¾ç¤º4ä¸ªå£çº¸ï¼Œæ°¸è¿œä¸ä¼šå¤šä¸ä¼šå°‘ï¼Œå®Œç¾è§£å†³æ‹¥æŒ¤é—®é¢˜ */
#bgThumbList {
    width: 100% !important;
    height: auto !important;
    margin: 0px !important;
    padding: 0px !important;
    padding-top: 0 !important;
    display: grid !important;
    grid-template-columns: repeat(4, 1fr) !important;
    gap: 12px !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    position: relative !important;
    top: 0 !important;
    left: 0 !important;
    max-height: calc(85vh - 120px) !important;
}
/* âœ… å£çº¸åˆ†ç±»åˆ‡æ¢æŒ‰é’®æ ·å¼ï¼Œå’Œä½ çš„é¡µé¢ç»¿è‰²ç»ç’ƒé£æ ¼å®Œç¾åŒ¹é… */
.bg-tab-group {
    display: flex;
    gap: 10px;
    margin: 8px 0 15px 0;
    width: 100%;
}
.bg-tab-btn {
    flex: 1;
    height: 38px;
    background: transparent;
    border: 1px solid var(--glass-border);
    border-radius: 10px;
    color: var(--color-text-sub);
    font-size: 15px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1);
    backdrop-filter: blur(10px) saturate(180%);
    -webkit-backdrop-filter: blur(10px) saturate(180%);
    font-weight: var(--font-weight-medium);
}
/* ç™½è‰²ä¸»é¢˜å£çº¸æ ‡ç­¾æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .bg-tab-btn {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    color: var(--color-text-main);
    box-shadow: 
        0 2px 6px rgba(0, 0, 0, 0.04),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.bg-tab-btn.active {
    color: #fff !important;
    background: linear-gradient(145deg, rgba(56,161,105,0.2), rgba(45,139,105,0.15)) !important;
    border-color: rgba(56, 161, 105, 0.5) !important;
    font-weight: var(--font-weight-bold);
    box-shadow: 0 4px 15px var(--hover-glow);
}
/* ç™½è‰²ä¸»é¢˜æ¿€æ´»æ ‡ç­¾ä¼˜åŒ– */
html[data-theme-mode="light"] .bg-tab-btn.active {
    background: linear-gradient(135deg, var(--color-green), var(--color-green-deep)) !important;
    border-color: var(--color-green) !important;
    box-shadow: 
        0 4px 15px rgba(45, 180, 141, 0.25),
        0 2px 8px rgba(0, 0, 0, 0.05);
}
.bg-tab-btn:hover:not(.active) {
    color: var(--color-green) !important;
    background: rgba(56, 161, 105, 0.08) !important;
    border-color: rgba(56,161,105,0.4) !important;
    box-shadow: 0 4px 12px var(--hover-glow);
}
html[data-theme-mode="light"] .bg-tab-btn:hover:not(.active) {
    background: rgba(45, 180, 141, 0.12) !important;
    border-color: var(--color-green) !important;
    color: var(--color-green-deep) !important;
    box-shadow: 0 4px 12px rgba(45, 180, 141, 0.15);
}
.bg-thumb-item {
    width: 100% !important;
    height: 90px !important;
    border-radius: 10px !important;
    overflow: hidden !important;
    cursor: pointer !important;
    border: 2px solid transparent !important;
    transition: all 0.25s ease !important;
    position: relative !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08) !important;
    background: rgba(0,0,0,0.1) !important;
}
/* ç™½è‰²ä¸»é¢˜ç¼©ç•¥å›¾ä¼˜åŒ– */
html[data-theme-mode="light"] .bg-thumb-item {
    background: rgba(255, 255, 255, 0.9) !important;
    border: 1px solid rgba(255, 255, 255, 0.9) !important;
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.05),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95) !important;
}
.bg-thumb-item:hover {
    transform: scale(1.03) !important;
    box-shadow:0 0 15px var(--hover-glow) !important;
}
html[data-theme-mode="light"] .bg-thumb-item:hover {
    box-shadow: 0 8px 25px rgba(45, 180, 141, 0.15) !important;
}
.bg-thumb-item.active {
    border-color:var(--color-green) !important;
    box-shadow:0 0 20px var(--hover-glow) !important;
}
html[data-theme-mode="light"] .bg-thumb-item.active {
    border-color: var(--color-green) !important;
    box-shadow: 
        0 0 0 3px rgba(45, 180, 141, 0.15),
        0 8px 25px rgba(45, 180, 141, 0.2) !important;
}
.bg-thumb-item img {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    object-position: center !important;
    display: block !important;
    opacity: 1 !important;
}
.bg-thumb-del {
    position:absolute;
    top:5px;
    right:5px;
    width:24px;
    height:24px;
    border-radius:50%;
    background:rgba(0,0,0,0.8);
    color:#fff;
    font-size:12px;
    display:flex;align-items:center;justify-content:center;
    cursor:pointer;
    opacity:0;
    transition:opacity 0.25s ease;
    z-index: 99;
}
.bg-thumb-item:hover .bg-thumb-del {
    opacity:1;
}
/* å…³é—­æŒ‰é’®ä¼˜åŒ–ï¼Œè¶…å¤§å·ï¼Œæ°¸ä¸é®æŒ¡ */
#bgModalCloseBtn {
    position: fixed !important;
    top: 15px !important;
    right: 15px !important;
    width: 45px !important;
    height: 45px !important;
    font-size: 20px !important;
    z-index: 9999999 !important;
}

.img-preview-mask {position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.95);z-index:10000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.4s cubic-bezier(0.16,1,0.3,1);}
/* âœ…æ ¸å¿ƒä¿®å¤ï¼šç‚¹å‡»èƒ½å…³é—­ï¼ŒæŠŠnoneæ”¹æˆall */
.img-preview-mask.show {opacity:1;pointer-events:all;}
.preview-img, .preview-video {
    max-width:90vw;
    max-height:90vh;
    border-radius:8px;
    transform-origin:center center;
    transform:scale(0.95); /* åˆå§‹ç¼©æ”¾ */
    opacity: 0; /* åˆå§‹é€æ˜ */
    transition: all 0.4s cubic-bezier(0.34,1.56,0.64,1); /* åŠ¨ç”»è¿‡æ¸¡ */
    display:none;
    object-fit:contain;
    margin:0 auto;
}
/* æ˜¾ç¤ºçŠ¶æ€çš„åŠ¨ç”» */
.preview-img.show-animate, .preview-video.show-animate {
    transform:scale(1); /* ç¼©æ”¾è‡³æ­£å¸¸ */
    opacity: 1; /* å®Œå…¨æ˜¾ç¤º */
}
.preview-img {z-index:10001;}
.preview-video {z-index:10001;background:#000;}
.img-preview-mask.show .preview-img, .img-preview-mask.show .preview-video {display:block;transform:scale(1);}
/* âœ…æ–°å¢ï¼šé¢„è§ˆå±‚å³ä¸Šè§’å…³é—­æŒ‰é’®æ ·å¼ï¼ˆå’Œä½ é¡µé¢é£æ ¼å®Œå…¨åŒ¹é…ï¼šç»¿è‰²+ç»ç’ƒè´¨æ„Ÿ+åœ†å½¢ï¼‰ */
.preview-close-btn {
    position: fixed;
    top: 25px;
    right: 25px;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 20px;
    display:flex;align-items:center;justify-content:center;
    z-index: 10002;
    backdrop-filter: blur(8px) saturate(180%);
    -webkit-backdrop-filter: blur(8px) saturate(180%);
    border:1px solid rgba(255,255,255,0.08);
    box-shadow:0 2px 8px rgba(0,0,0,0.08),inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);
    color: var(--color-green);
}
.preview-close-btn:hover {
    background:rgba(56,161,105,0.15);
    color:#fff;
    transform:rotate(120deg) scale(1.2);
    box-shadow:0 0 15px var(--hover-glow);
    border-color:rgba(56,161,105,0.3);
}
/* å›¾ç‰‡é¢„è§ˆå·¦å³åˆ‡æ¢æŒ‰é’®æ ·å¼ */
.preview-nav-btn {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: transparent;
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--color-green);
    font-size: 20px;
    cursor: pointer;
    z-index: 10003;
    backdrop-filter: blur(8px) saturate(180%);
    -webkit-backdrop-filter: blur(8px) saturate(180%);
    box-shadow: 0 2px 8px rgba(0,0,0,0.08),
                inset 1px 1px 0 rgba(255,255,255,0.1),
                inset -1px -1px 0 rgba(0,0,0,0.05);
    transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
}
.preview-prev-btn {
    left: 30px;
}
.preview-next-btn {
    right: 30px;
}
.preview-nav-btn:hover {
    background: rgba(56,161,105,0.15);
    color: #fff;
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 0 15px var(--hover-glow);
    border-color: rgba(56,161,105,0.3);
}
.preview-nav-btn:active {
    transform: translateY(-50%) scale(var(--active-scale));
}
/* ç¦ç”¨çŠ¶æ€ */
.preview-nav-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    transform: translateY(-50%);
    box-shadow: none;
}
/* å›¾ç‰‡é¢„è§ˆé¡µç æ ·å¼ */
.preview-pagination {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    padding: 6px 16px;
    background: rgba(0,0,0,0.6);
    border-radius: 20px;
    color: #fff;
    font-size: 14px;
    font-weight: var(--font-weight-medium);
    z-index: 10003;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
}
/* ç™½è‰²ä¸»é¢˜é€‚é… */
html[data-theme-mode="light"] .preview-nav-btn {
    background: rgba(255,255,255,0.8);
    border: 1px solid rgba(255,255,255,0.9);
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}
html[data-theme-mode="light"] .preview-nav-btn:hover {
    background: var(--color-green);
    border-color: var(--color-green);
}
html[data-theme-mode="light"] .preview-pagination {
    background: rgba(255,255,255,0.8);
    color: var(--color-text-title);
    border: 1px solid rgba(255,255,255,0.9);
}
/* ========== æ–°é—»å¼¹çª— ========== */
.news-modal-mask {position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.7);z-index:9999;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.4s cubic-bezier(0.16,1,0.3,1);padding:20px;box-sizing:border-box;}
.news-modal-mask.show {opacity:1;pointer-events:all;}
.news-modal-box {background:var(--glass-bg);border-radius:20px;border:1px solid var(--glass-border);box-shadow:0 12px 48px rgba(0,0,0,0.15),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);width:100%;max-width:800px;max-height:calc(100vh - 40px);color:var(--color-text-main);position:relative;transform:translateY(20px);transition:transform 0.4s cubic-bezier(0.34,1.56,0.64,1),opacity 0.4s cubic-bezier(0.34,1.56,0.64,1);opacity:0;overflow-y:auto;overflow-x:hidden;margin:auto;backdrop-filter:blur(20px) saturate(180%) contrast(1.1);-webkit-backdrop-filter:blur(20px) saturate(180%) contrast(1.1);}
/* ç™½è‰²ä¸»é¢˜å¼¹çª—ä¼˜åŒ– */
html[data-theme-mode="light"] .news-modal-box {
    background: rgba(255, 255, 255, 0.85);
    border: 1px solid rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(30px) saturate(200%) contrast(1.1);
    -webkit-backdrop-filter: blur(30px) saturate(200%) contrast(1.1);
    box-shadow: 
        0 25px 80px rgba(45, 180, 141, 0.1),
        0 15px 40px rgba(0, 0, 0, 0.05),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.news-modal-mask.show .news-modal-box {transform:translateY(0);opacity:1;}
.modal-close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.5s cubic-bezier(0.34,1.56,0.64,1);
    z-index: 99999; /* æé«˜å±‚çº§ï¼Œç¡®ä¿ä¸è¢«é®æŒ¡ */
    backdrop-filter: blur(8px) saturate(180%);
    -webkit-backdrop-filter: blur(8px) saturate(180%);
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow:0 2px 8px rgba(0,0,0,0.08),inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);
    color: var(--color-green);
    /* æ–°å¢ï¼šé˜²æ­¢æŒ‰é’®è¢«å¼¹çª—å†…å®¹è¦†ç›– */
    margin: 0;
    padding: 0;
}
.modal-close-btn:hover {background:rgba(56,161,105,0.15);color:#fff;transform:rotate(120deg) scale(1.2);box-shadow:0 0 15px var(--hover-glow);border-color:rgba(56,161,105,0.3);}
.modal-close-btn:active {transform: rotate(90deg) scale(var(--active-scale));}
.modal-news-content {
    padding:45px 30px 25px 30px; /* ä¿ç•™åŸæœ‰å†…è¾¹è·ï¼Œç»™å…³é—­æŒ‰é’®ç•™ç©ºé—´ */
    width: 60%; 
    overflow-y: auto; /* å†…å®¹è¶…å‡ºæ—¶å‚ç›´æ»šåŠ¨ï¼Œå¦åˆ™æ— æ»šåŠ¨æ¡ */
    max-height: calc(100vh - 90px); /* åŸºäºè§†å£é«˜åº¦ï¼Œå‡å»é¡¶éƒ¨/åº•éƒ¨é—´è· */
    box-sizing: border-box;
    overscroll-behavior: contain; /* å…³é”®ï¼šé˜»æ­¢æ»šåŠ¨ä¼ é€’åˆ°é¡µé¢å…¨å±€ */
    scrollbar-width: thin; /* é€‚é…Firefoxæ»šåŠ¨æ¡æ ·å¼ */
}
.modal-news-title {font-size:25px;color:var(--color-text-title);font-weight:var(--font-weight-bold);margin-bottom:15px;letter-spacing:1px;}
.modal-news-desc {font-size:17px;color:var(--color-text-main);line-height:1.9;margin-bottom:20px;font-weight:var(--font-weight-normal);}
.modal-news-imgs {display:flex;flex-wrap:wrap;gap:12px;margin-bottom:15px;}
.modal-news-img-item {width:calc(33.33% - 8px);height:180px;object-fit:cover;border-radius:8px;border:1px solid rgba(56,161,105,0.08);cursor:pointer;transition:all 0.3s ease;position:relative;}
.modal-news-img-item:hover {transform:scale(1.03);box-shadow:0 0 12px var(--hover-glow);}
.modal-news-date {
    font-size: 12px;
    color: var(--color-text-sub);
    text-align: right;
    margin-bottom: 20px;
    font-weight: var(--font-weight-light);
    display: flex; /* å…³é”®ï¼šè®©ç‚¹èµå’Œæ—¥æœŸåœ¨åŒä¸€è¡Œ */
    align-items: center; /* å‚ç›´å±…ä¸­ */
    gap: 8px; /* é—´è· */
    justify-content: flex-end; /* å³å¯¹é½ */
}
.modal-comment-area {
    padding:0 30px 25px 30px;
    border-top:1px solid rgba(255,255,255,0.08);
    margin-top:10px;
    width: 40%; /* å³ä¾§è¯„è®ºå 40%å®½åº¦ */
    overflow-y: auto; /* è¯„è®ºè¶…å‡ºæ—¶å‚ç›´æ»šåŠ¨ï¼Œå¦åˆ™æ— æ»šåŠ¨æ¡ */
    max-height: calc(100vh - 90px); /* å’Œå†…å®¹åŒºä¿æŒä¸€è‡´çš„æœ€å¤§é«˜åº¦ */
    box-sizing: border-box;
    border-left:1px solid rgba(255,255,255,0.08); /* åŠ ä¸ªåˆ†å‰²çº¿ï¼ŒåŒºåˆ†å†…å®¹å’Œè¯„è®º */
    border-top: none; /* å»æ‰åŸæ¥çš„é¡¶éƒ¨è¾¹æ¡† */
    margin-top: 0; /* å»æ‰åŸæ¥çš„é¡¶éƒ¨å¤–è¾¹è· */
    overscroll-behavior: contain; /* å…³é”®ï¼šé˜»æ­¢æ»šåŠ¨ä¼ é€’åˆ°é¡µé¢å…¨å±€ */
    scrollbar-width: thin; /* é€‚é…Firefoxæ»šåŠ¨æ¡æ ·å¼ */
}
/* ç™½è‰²ä¸»é¢˜ä¸‹çš„åˆ†å‰²çº¿é€‚é… */
html[data-theme-mode="light"] .modal-comment-area {
    border-left:1px solid rgba(0,0,0,0.08);
}
.modal-utter-container {width:100%!important;min-height:200px;max-height:400px;}
.modal-utter-container iframe {width:100%!important;border:0!important;min-height:200px!important;}
.news-modal-box::-webkit-scrollbar {display:none;}
.news-modal-box {-ms-overflow-style:none;scrollbar-width:none;}
.news-modal-box {color: #ffffff !important;}
.news-modal-box .modal-news-title,.news-modal-box .modal-news-desc,.news-modal-box .modal-news-date {color: #ffffff !important;}

/* é‡æ„footeræ ·å¼ï¼šä»…åŒ…è£¹éŸ³ä¹æ’­æ”¾å™¨ï¼Œå®šä½å·¦ä¸‹è§’ */
#footer {
    width: auto; /* å–æ¶ˆå…¨å±å®½åº¦ï¼Œè‡ªé€‚åº”å†…å®¹ */
    height: 50px; /* å›ºå®šé«˜åº¦ */
    color: var(--color-text-sub);
    background: var(--glass-bg);
    position: fixed;
    bottom: 15px;
    left: 15px; /* å›ºå®šåœ¨å·¦ä¸‹è§’ */
    transform: translateX(0); /* å–æ¶ˆåŸæœ‰å±…ä¸­åç§» */
    z-index: 98;
    display: flex;
    align-items: center;
    padding: 0; /* æ¸…ç©ºå†…è¾¹è· */
    border-radius: 25px; /* èƒ¶å›Šåœ†è§’ */
    backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
    -webkit-backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
    box-shadow: var(--glass-shadow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); /* çµåŠ¨çš„è¿‡æ¸¡æ›²çº¿ */
    overflow: hidden; /* éšè—è¶…å‡ºéƒ¨åˆ† */
}
html[data-theme-mode="light"] #footer {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(20px) saturate(200%);
    -webkit-backdrop-filter: blur(20px) saturate(200%);
    box-shadow: 
        0 15px 50px rgba(45, 180, 141, 0.08),
        0 8px 20px rgba(0, 0, 0, 0.03),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
/* æœªæ’­æ”¾çŠ¶æ€ï¼šç¼©æˆå°çƒ */
#footer.music-paused {
    width: 50px; /* åœ†å½¢å®½åº¦=é«˜åº¦ */
    border-radius: 50%; /* åœ†å½¢ */
}

/* æ’­æ”¾çŠ¶æ€ï¼šå±•å¼€æˆèƒ¶å›Š */
#footer.music-playing {
    width: 200px; /* èƒ¶å›Šå®½åº¦ï¼ˆå¯æ ¹æ®éœ€è¦è°ƒæ•´ï¼‰ */
    border-radius: 25px; /* èƒ¶å›Šåœ†è§’ */
}
#footer:hover {box-shadow:0 8px 25px rgba(0,0,0,0.08),0 0 15px var(--hover-glow);}
html[data-theme-mode="light"] #footer:hover {
    box-shadow: 
        0 20px 60px rgba(45, 180, 141, 0.12),
        0 10px 30px rgba(0, 0, 0, 0.05),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
#footer a {color:var(--color-green);transition: color 0.2s ease;font-weight:var(--font-weight-medium);}
#footer a:hover {text-decoration:underline;color:var(--color-green-deep);}
.footer-right {display:flex;align-items:center;gap:8px;margin:0 auto;}

/* âœ… éŸ³ä¹æ’­æ”¾å™¨æŒ‰é’®ã€æ¶²æ€ç»ç’ƒåœ†å½¢é€šé€ç‰ˆã€‘æ ¸å¿ƒåŠ¨ç”»ä¼˜åŒ– */
.music-player {
    display: flex;
    align-items: center;
    gap: 10px;
    position: relative; /* å–æ¶ˆç»å¯¹å®šä½ï¼Œæ”¹ä¸ºç›¸å¯¹å®šä½ */
    left: 0; /* é‡ç½®left */
    top: 0; /* é‡ç½®top */
    transform: none; /* é‡ç½®transform */
    padding: 0 15px; /* å†…è¾¹è·ï¼Œä¿è¯å†…å®¹ä¸è´´è¾¹ */
    width: 100%; /* å æ»¡footerå®½åº¦ */
    height: 100%; /* å æ»¡footeré«˜åº¦ */
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}
/* æœªæ’­æ”¾æ—¶éšè—éŸ³ä¹æ–‡å­— */
#footer.music-paused .music-text {
    opacity: 0;
    width: 0;
    overflow: hidden;
    margin-left: -10px; /* æ”¶ç¼©æ—¶çš„åç§»ï¼Œæ›´çµåŠ¨ */
}

/* æ’­æ”¾æ—¶æ˜¾ç¤ºéŸ³ä¹æ–‡å­— */
#footer.music-playing .music-text {
    opacity: 1;
    width: auto;
    margin-left: 0;
}

/* å¾®è°ƒéŸ³ä¹æŒ‰é’®ä½ç½® */
/* âœ… éŸ³ä¹æ’­æ”¾å™¨æŒ‰é’®ã€æ¶²æ€ç»ç’ƒåœ†å½¢é€šé€ç‰ˆã€‘æ ¸å¿ƒåŠ¨ç”»ä¼˜åŒ– - ä¿®å¤æ¤­åœ†é—®é¢˜ */
.music-btn {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: transparent;
    color: var(--color-green);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.5s cubic-bezier(0.34,1.56,0.64,1);
    /* 1. åˆ é™¤ font-size: 0; è¿™è¡Œï¼Œæˆ–è€…æ”¹æˆ font-size: 16px; */
    font-size: 16px; /* æ–°å¢ï¼šè®¾ç½®å­—ä½“å¤§å°ï¼Œè®©æ’­æ”¾/æš‚åœå›¾æ ‡æ˜¾ç¤º */
    position: relative;
    backdrop-filter: blur(8px) saturate(180%);
    -webkit-backdrop-filter: blur(8px) saturate(180%);
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow:0 3px 10px rgba(0,0,0,0.08),inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);
    flex-shrink: 0;
    overflow: hidden;
    /* 2. åˆ é™¤è¿™è¡Œé”™è¯¯ä»£ç ï¼št */
    /* 3. æ–°å¢z-indexï¼Œç¡®ä¿æŒ‰é’®åœ¨æœ€ä¸Šå±‚ä¸è¢«é®æŒ¡ */
    z-index: 100;
}
/* ç™½è‰²ä¸»é¢˜éŸ³ä¹æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .music-btn {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.05),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.music-btn:hover {background:var(--color-green-deep);color:#fff;transform:scale(1.2);border-color:var(--color-green-deep);box-shadow:0 0 20px var(--hover-glow);}
html[data-theme-mode="light"] .music-btn:hover {
    background: var(--color-green);
    color: #fff;
    border-color: var(--color-green);
    box-shadow: 0 0 25px rgba(45, 180, 141, 0.3);
}
.music-btn:active {transform: scale(var(--active-scale));}
.play-icon::before {content:'';width:0;height:0;border-top:8px solid transparent;border-bottom:8px solid transparent;border-left:13px solid currentColor;margin-left:2px;}
.pause-icon::before {content:'';width:12px;height:14px;background:linear-gradient(to right, currentColor 0, currentColor 3px, transparent 3px, transparent 6px, currentColor 6px, currentColor 9px);}
.music-text {font-size:12px;color:var(--color-text-sub);font-weight:var(--font-weight-light);}
audio {display:none;}

/* âœ…âœ…âœ… è¿”å›é¡¶éƒ¨+ä¾§è¾¹å·¥å…·æŒ‰é’®ã€æ¶²æ€ç»ç’ƒåœ†å½¢é€šé€ç‰ˆã€‘ç»ˆæåŠ¨ç”»ä¼˜åŒ– */
.sidebar-top {position:fixed;bottom:90px;right:30px;z-index:99;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.5s cubic-bezier(0.34,1.56,0.64,1);border:1px solid var(--glass-border);background:transparent;backdrop-filter:blur(12px) saturate(180%);-webkit-backdrop-filter:blur(12px) saturate(180%);box-shadow:var(--glass-shadow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);color: var(--color-text-sub);}
/* ç™½è‰²ä¸»é¢˜è¿”å›é¡¶éƒ¨æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .sidebar-top {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.08),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.sidebar-top:hover {background:var(--color-green);color:#fff;transform:translateY(-6px) scale(1.2);box-shadow:0 0 25px var(--hover-glow);border-color: var(--color-green);}
html[data-theme-mode="light"] .sidebar-top:hover {
    background: var(--color-green);
    color: #fff;
    border-color: var(--color-green);
    box-shadow: 0 0 30px rgba(45, 180, 141, 0.3);
}
.sidebar-top:active {transform: translateY(0) scale(var(--active-scale));}
.sidebar-tools {position:fixed;bottom:140px;right:30px;z-index:99;width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.5s cubic-bezier(0.34,1.56,0.64,1);border:1px solid var(--glass-border);background:transparent;backdrop-filter:blur(12px) saturate(180%);-webkit-backdrop-filter:blur(12px) saturate(180%);font-size:18px;color: var(--color-text-sub);box-shadow:var(--glass-shadow),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);}
/* ç™½è‰²ä¸»é¢˜å·¥å…·æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .sidebar-tools {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.08),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.sidebar-tools:hover {background:var(--color-green);color:#fff;transform:translateY(-6px) scale(1.2);box-shadow:0 0 25px var(--hover-glow);border-color: var(--color-green);}
html[data-theme-mode="light"] .sidebar-tools:hover {
    background: var(--color-green);
    color: #fff;
    border-color: var(--color-green);
    box-shadow: 0 0 30px rgba(45, 180, 141, 0.3);
}
.sidebar-tools:active {transform: translateY(0) scale(var(--active-scale));}

/* æ»šåŠ¨æ¡æ ·å¼ - ç»¿è‰²é€‚é… */
::-webkit-scrollbar {width:8px;height:8px;}
::-webkit-scrollbar-track {background:var(--scrollbar-track);border-radius:10px;}
::-webkit-scrollbar-thumb {background:var(--scrollbar-thumb);border-radius:10px;transition:all 0.2s ease;}
::-webkit-scrollbar-thumb:hover {background:var(--color-green);}
::-webkit-scrollbar-thumb:active {background:var(--color-green-deep);}
.sidebar-wrap::-webkit-scrollbar { width: 6px; }

/* ========== å“åº”å¼è®¾è®¡ ========== */
@media (max-width: 1024px) {
	/* ç§»åŠ¨ç«¯èƒ¶å›Šå®½åº¦ç¼©å° */
    #footer.music-playing {
        width: 160px;
    }
    /* ç§»åŠ¨ç«¯éŸ³ä¹æ–‡å­—å­—å·æ›´å° */
    .music-text {
        font-size: 11px;
    }
    .news-modal-box {
        flex-direction: column; /* ç§»åŠ¨ç«¯æ¢å¤ä¸Šä¸‹å¸ƒå±€ */
        max-width: 100%;
    }
    .modal-news-content {
        width: 100%; /* ç§»åŠ¨ç«¯å æ»¡å®½åº¦ */
        height: auto; /* é«˜åº¦è‡ªé€‚åº” */
        max-height: 50vh; /* é™åˆ¶æœ€å¤§é«˜åº¦ä¸ºè§†å£çš„50% */
        overflow-y: auto; /* ä¿ç•™ç§»åŠ¨ç«¯æ»šåŠ¨ */
        overscroll-behavior: contain; /* ç§»åŠ¨ç«¯ä¹Ÿé˜»æ­¢æ»šåŠ¨å†’æ³¡ */
    }
    .modal-comment-area {
        width: 100%; /* ç§»åŠ¨ç«¯å æ»¡å®½åº¦ */
        height: auto; /* é«˜åº¦è‡ªé€‚åº” */
        max-height: 40vh; /* é™åˆ¶æœ€å¤§é«˜åº¦ä¸ºè§†å£çš„40% */
        overflow-y: auto; /* ä¿ç•™ç§»åŠ¨ç«¯æ»šåŠ¨ */
        border-left: none; /* å»æ‰åˆ†å‰²çº¿ */
        border-top:1px solid rgba(255,255,255,0.08); /* æ¢å¤é¡¶éƒ¨è¾¹æ¡† */
        margin-top: 10px; /* æ¢å¤é¡¶éƒ¨å¤–è¾¹è· */
        overscroll-behavior: contain; /* ç§»åŠ¨ç«¯ä¹Ÿé˜»æ­¢æ»šåŠ¨å†’æ³¡ */
    }
	    html[data-theme-mode="light"] .modal-comment-area {
	        border-top:1px solid rgba(0,0,0,0.08);
	    }
    html, body {overflow-x:hidden!important;}
    .container-main {flex-direction:column;gap:30px;margin:20px auto;}
    #sidebar {position:static;width:100%;left:auto;top:auto;transform:none;margin-bottom:0;height:auto;}
    #content {width:100%;margin-left:0!important;padding:0!important;}
    .sidebar-wrap {max-height:none;overflow-y:visible;}
    .article-title {font-size:24px;}
    .main-nav-link-wrap {margin:0 6px;}
    .sidebar-top {bottom:80px;right:20px;}
    .sidebar-tools {bottom:130px;right:20px;}
    #footer {width:calc(100% - 30px);left:15px;bottom:10px;padding:12px 15px;height:auto;flex-wrap:wrap;gap:8px;justify-content:center;}
    .music-text {display:none;}
    .news-item {flex-direction:column;gap:15px;padding:20px;}
    .news-text-box {flex:1;min-height:auto;}
    .news-media-box {flex:1;width:100%;height:180px;}
    .news-title {font-size:20px;}
    .news-content {font-size:15px;}
    .github-login-btn, .user-name-display {border-radius:24px !important;padding:9px 18px !important;}
    .news-modal-box {max-width:100%;margin:20px 0;}
    .modal-news-img-item {width:calc(50% - 8px);height:150px;}
    .modal-news-content {padding:20px 18px;}
    .modal-comment-area {padding:0 18px 20px 18px;}
    .search-box-container {padding:0 5px;}
    .search-input {height:38px;font-size:14px;}
    .search-btn {height:38px;padding:0 25px;font-size:14px;justify-content:center;}
    .search-btn .iconfont {margin-right:6px;}
}
@media (max-width:768px) {
    .news-media-box {height:160px;}
    .modal-news-img-item {width:100%;height:200px;}
    .nav-center {flex-wrap:wrap;gap:8px;}
    #header-nav {width:calc(100% - 20px);margin:10px auto 0 auto;padding:10px 15px;}
}
/* é˜²æ­¢ä»»ä½•å…ƒç´ å¯¼è‡´æ°´å¹³æ»šåŠ¨æ¡ */
* {
    max-width: 100%;
    box-sizing: border-box;
}
.news-modal-box {
    background:var(--glass-bg);
    border-radius:20px;
    border:1px solid var(--glass-border);
    box-shadow:0 12px 48px rgba(0,0,0,0.15),inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);
    width:100%;
    max-width: 1200px; /* åŠ å®½å¼¹çª—ï¼Œé€‚é…å·¦å³å¸ƒå±€ */
    max-height:calc(100vh - 40px); /* å¼¹çª—æœ€å¤§é«˜åº¦æ¥è¿‘è§†å£ */
    color:var(--color-text-main);
    position:relative;
    transform:translateY(20px);
    transition:transform 0.4s cubic-bezier(0.34,1.56,0.64,1),opacity 0.4s cubic-bezier(0.34,1.56,0.64,1);
    opacity:0;
    /* æ ¸å¿ƒä¿®æ”¹ï¼šæ”¹æˆflexå·¦å³å¸ƒå±€ */
    display: flex;
    flex-direction: row;
    overflow: hidden; /* å¿…é¡»ï¼šéšè—å¼¹çª—æ•´ä½“æ»šåŠ¨ï¼Œç¡®ä¿å­å…ƒç´ ç‹¬ç«‹æ»šåŠ¨ */
    margin:auto;
    backdrop-filter:blur(20px) saturate(180%) contrast(1.1);
    -webkit-backdrop-filter:blur(20px) saturate(180%) contrast(1.1);
}
/* ç¡®ä¿å›¾ç‰‡å’Œè§†é¢‘ä¸ä¼šæº¢å‡º */
img, video, iframe {
    max-width: 100%;
    height: auto;
}

/* ç¡®ä¿è¡¨æ ¼ä¸ä¼šæº¢å‡º */
table {
    max-width: 100%;
    overflow-x: auto;
    display: block;
}
/* âœ…âœ…âœ… æ–°å¢ï¼šQQç™»å½•+ç”¨æˆ·ä¿¡æ¯+è¯„è®ºåŒºæ ·å¼ï¼ˆå®Œç¾åŒ¹é…æ¶²æ€ç»ç’ƒ+æ£®ç³»ç»¿è‰²é£æ ¼ï¼‰ */
/* å³ä¸Šè§’ç”¨æˆ·ä¿¡æ¯å±•ç¤ºæ ·å¼ */
.qq-login-btn, .user-info-display {
    padding:8px 12px;font-size:14px;color:var(--color-text-sub);background:transparent;border:1px solid rgba(255,255,255,0.08);border-radius:20px;cursor:pointer;transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);display:flex;align-items:center;gap:6px;backdrop-filter:blur(8px) saturate(180%);-webkit-backdrop-filter:blur(8px) saturate(180%);box-shadow:inset 1px 1px 0 rgba(255,255,255,0.1),inset -1px -1px 0 rgba(0,0,0,0.05);
-webkit-user-select: none;  /* å…¼å®¹ Chrome/Safari/Opera */
-moz-user-select: none;     /* å…¼å®¹ Firefox */
-ms-user-select: none;      /* å…¼å®¹ IE/Edge */
user-select: none;          /* æ ‡å‡†å±æ€§ï¼šç¦æ­¢æ–‡æœ¬é€‰æ‹© */
-webkit-touch-callout: none;/* ç§»åŠ¨ç«¯ç¦æ­¢é•¿æŒ‰å¼¹å‡ºèœå• */
}
/* ç™½è‰²ä¸»é¢˜QQç™»å½•æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .qq-login-btn,
html[data-theme-mode="light"] .user-info-display {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    color: var(--color-text-main);
    box-shadow: 
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05),
        0 2px 4px rgba(0, 0, 0, 0.02);
}
.qq-login-btn:hover, .user-info-display:hover {
    background:rgba(56,161,105,0.08);color:var(--color-green);transform:translateY(-3px) scale(1.02);border-color:rgba(56,161,105,0.2);box-shadow:0 6px 20px var(--hover-glow);
}
html[data-theme-mode="light"] .qq-login-btn:hover,
html[data-theme-mode="light"] .user-info-display:hover {
    background: rgba(45, 180, 141, 0.12);
    color: var(--color-green-deep);
    border-color: var(--color-green);
    box-shadow: 0 6px 20px rgba(45, 180, 141, 0.15);
}
.qq-login-btn:active, .user-info-display:active {transform:translateY(0) scale(var(--active-scale));}
.user-info-display {color:var(--color-green);}
/* ç”¨æˆ·ä¸‹æ‹‰èœå•æ ·å¼ï¼ˆå’Œé¡µé¢é£æ ¼ç»Ÿä¸€ï¼‰ */
.user-info-display {
  position: relative;
  cursor: pointer;
}
.user-dropdown-trigger {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 0 4px;
}
.user-dropdown-menu {
  position: absolute;
  top: calc(100% + 8px);
  /* æŠŠ right: 0 æ”¹æˆ left: 0 â†“â†“â†“ */
  left: 0; 
  min-width: 100px;
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  box-shadow: var(--glass-shadow), inset 1px 1px 0 var(--glass-inset-light), inset -1px -1px 0 var(--glass-inset-dark);
  backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
  -webkit-backdrop-filter: blur(12px) saturate(180%) contrast(1.1);
  padding: 10px 0;
  display: none;
  z-index: 9999;
}
.user-dropdown-menu.show {
  display: block;
  animation: dropdownFade 0.3s ease forwards;
}
@keyframes dropdownFade {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}
.dropdown-item {
  padding: 8px 18px;
  font-size: 14px;
  color: var(--color-text-main);
  text-align: center;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.dropdown-item:hover {
  background: rgba(56, 161, 105, 0.15);
  color: var(--color-green);
  padding-right: 22px;
}
.user-avatar {width:24px;height:24px;border-radius:50%;object-fit:cover;border:1px solid rgba(56,161,105,0.3);}

/* è¯„è®ºåŒºæ ·å¼ï¼ˆæ¶²æ€ç»ç’ƒ+æ£®ç³»ç»¿è‰²ï¼Œå®Œç¾åŒ¹é…ä½ çš„é¡µé¢ï¼‰ */
.comment-wrap {width:100%;margin-top:20px;border-top:1px solid rgba(255,255,255,0.08);padding-top:20px;}
.comment-title {font-size:18px;font-weight:var(--font-weight-bold);color:var(--color-green);margin-bottom:15px;text-align:left;display:block !important;}
.comment-input-box {width:100%;display:flex;gap:10px;margin-bottom:20px;}
.comment-input {
    flex:1;
    min-height: 42px; /* é»˜è®¤æœ€å°é«˜åº¦ï¼ˆä¸€è¡Œï¼‰ */
    max-height: 200px; /* æœ€å¤§é«˜åº¦ï¼Œé˜²æ­¢æ— é™å¢é«˜ */
    background:transparent;
    border:1px solid var(--glass-border);
    border-radius:12px;
    padding: 12px 15px; /* è°ƒæ•´å†…è¾¹è·ï¼Œé€‚é…å¤šè¡Œæ–‡å­— */
    color:var(--color-text-main);
    font-size:15px;
    outline:none;
    transition:all 0.3s ease;
    backdrop-filter:blur(10px) saturate(150%);
    -webkit-backdrop-filter:blur(10px) saturate(150%);
    box-shadow:inset 1px 1px 0 var(--glass-inset-light),inset -1px -1px 0 var(--glass-inset-dark);
    resize: none; /* ç¦æ­¢æ‰‹åŠ¨æ‹–æ‹½è°ƒæ•´å¤§å° */
    overflow: hidden; /* éšè—æ»šåŠ¨æ¡ï¼Œè®©é«˜åº¦è‡ªé€‚åº” */
    line-height: 1.5; /* ç»Ÿä¸€è¡Œé«˜ï¼Œä¿è¯æ–‡å­—æ’ç‰ˆç¾è§‚ */
}
/* ç™½è‰²ä¸»é¢˜è¯„è®ºè¾“å…¥æ¡†ä¼˜åŒ– */
html[data-theme-mode="light"] .comment-input {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    box-shadow: 
        inset 1px 1px 0 rgba(255, 255, 255, 0.95),
        inset -1px -1px 0 rgba(0, 0, 0, 0.05);
}
.comment-input:focus {border-color:rgba(56,161,105,0.4);box-shadow:0 0 15px var(--hover-glow);}
html[data-theme-mode="light"] .comment-input:focus {
    border-color: var(--color-green);
    box-shadow: 0 0 0 3px rgba(45, 180, 141, 0.15);
}
.comment-submit-btn {height:42px;padding:0 20px;background:transparent;border:1px solid var(--glass-border);border-radius:12px;color:var(--color-green);font-size:14px;cursor:pointer;transition:all 0.4s cubic-bezier(0.34,1.56,0.64,1);}
/* ç™½è‰²ä¸»é¢˜è¯„è®ºæäº¤æŒ‰é’®ä¼˜åŒ– */
html[data-theme-mode="light"] .comment-submit-btn {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
    color: var(--color-green);
    box-shadow: 
        0 2px 6px rgba(0, 0, 0, 0.04),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.comment-submit-btn:hover {background:rgba(56,161,105,0.08);transform:translateY(-3px) scale(1.02);border-color:rgba(56,161,105,0.4);box-shadow:0 8px 20px var(--hover-glow);}
html[data-theme-mode="light"] .comment-submit-btn:hover {
    background: rgba(45, 180, 141, 0.12);
    color: var(--color-green-deep);
    border-color: var(--color-green);
    box-shadow: 0 8px 20px rgba(45, 180, 141, 0.15);
}
.comment-submit-btn:disabled {color:var(--color-text-sub);border-color:rgba(255,255,255,0.08);cursor:not-allowed;background:transparent;transform:none;box-shadow:none;}
.comment-list {width:100%;display:flex;flex-direction:column;gap:15px;}
.comment-item {width:100%;background:var(--glass-bg);border-radius:12px;padding:15px;border:1px solid var(--glass-border);box-shadow:var(--glass-shadow);text-align:left;}
/* ç™½è‰²ä¸»é¢˜è¯„è®ºé¡¹ä¼˜åŒ– */
html[data-theme-mode="light"] .comment-item {
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.8);
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.04),
        inset 1px 1px 0 rgba(255, 255, 255, 0.95);
}
.comment-user-info {display:flex;align-items:center;gap:8px;margin-bottom:8px;}
.comment-user-avatar {width:28px;height:28px;border-radius:50%;object-fit:cover;border:1px solid rgba(56,161,105,0.2);}
.comment-user-name {font-size:14px;font-weight:var(--font-weight-medium);color:var(--color-green);}
.comment-time {font-size:12px;color:var(--color-text-sub);margin-left:auto;}
.comment-content {font-size:15px;color:var(--color-text-main);line-height:1.7;padding-left:36px;}
.comment-empty {text-align:center;color:var(--color-text-sub);padding:20px 0;font-size:14px;}
.comment-login-tip {text-align:center;color:var(--color-green);padding:20px 0;font-size:14px;cursor:pointer;}
.comment-login-tip:hover {text-decoration:underline;}
/* æ—¥è®°è¯¦æƒ…é¡µè·³è½¬æŒ‰é’®æ ·å¼ */
/* æ—¥è®°è¯¦æƒ…é¡µè·³è½¬æŒ‰é’®æ ·å¼ - ç§»åˆ°å¼¹çª—å¤–éƒ¨å³ä¾§ */
.news-nav-btns {
    position: fixed; /* æ”¹ä¸ºfixedå®šä½ï¼Œç›¸å¯¹äºè§†å£ï¼Œç¡®ä¿åœ¨å¼¹çª—å³ä¾§ */
    top: 50%;
    right: 50px; /* è°ƒæ•´å³ä¾§è·ç¦»ï¼Œå¯æ ¹æ®éœ€è¦ä¿®æ”¹ */
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 99999; /* æé«˜å±‚çº§ï¼Œç¡®ä¿ä¸è¢«é®æŒ¡ */
    /* å¢åŠ åª’ä½“æŸ¥è¯¢é€‚é…ï¼Œé¿å…ç§»åŠ¨ç«¯é®æŒ¡ */
}

.news-nav-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--glass-bg);
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    border: 1px solid var(--glass-border);
    color: var(--color-green);
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34,1.56,0.64,1);
    box-shadow: var(--glass-shadow),
                inset 1px 1px 0 var(--glass-inset-light),
                inset -1px -1px 0 var(--glass-inset-dark);
    display: flex;
    align-items: center;
    justify-content: center;
}

/* ç™½è‰²ä¸»é¢˜é€‚é… */
html[data-theme-mode="light"] .news-nav-btn {
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.9);
}

.news-nav-btn:hover {
    background: var(--color-green);
    color: #fff;
    transform: scale(1.1);
    box-shadow: 0 0 20px var(--hover-glow);
}

.news-nav-btn:disabled {
    opacity: 0.2;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
    background: var(--glass-bg);
    color: var(--color-text-sub);
}

/* ç§»åŠ¨ç«¯é€‚é… - è°ƒæ•´ä½ç½®é¿å…é®æŒ¡ */
@media (max-width: 768px) {
    .news-nav-btn {
        width: 40px;
        height: 40px;
        font-size: 16px;
    }
    .news-nav-btns {
        right: 15px; /* ç§»åŠ¨ç«¯æ›´é è¿‘å³ä¾§è¾¹ç¼˜ */
        gap: 10px;
    }
}
/* è‹¹æœé£åŠ è½½å‘¼å¸åŠ¨ç”» */
@keyframes apple-breathe {
  0%, 100% { opacity: 0.4; transform: scale(0.9); }
  50% { opacity: 1; transform: scale(1.1); }
}
.apple-loading-comment {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  font-weight: 300;
  letter-spacing: 0.5px;
  transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
}
.apple-loading-dot {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: rgba(56, 161, 105, 0.8);
  display: inline-block;
  margin: 0 1px;
}
    </style>
</head>
<body>
    <!-- ğŸ”¥ æ–°å¢ï¼šå¼€å±åŠ¨ç”» -->
    <div id="loader">
        <div class="loading-left-bg loading-bg"></div>
        <div class="loading-right-bg loading-bg"></div>
        <div class="spinner-box">
            <div class="loading-taichi rotate">
                <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" xmlns="https://www.w3.org/2000/svg">
                    <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" />
                    <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" />
                </svg>
            </div>
            <div class="loading-word">æ˜¥å¤©æ˜¯å¥¹æœ€çˆ±çš„å­£èŠ‚...</div>
        </div>
    </div>

    <div class="container">
        <nav id="header-nav">
            <div class="theme-bg-switch-group">
                <label class="theme-switch-wrap">
                    <label class="theme-switch">
                        <input type="checkbox" id="themeToggle">
                        <span class="theme-slider"></span>
                    </label>
                </label>
                <div class="bg-switch-wrap">
                    <button class="bg-switch-btn" id="bgChangeBtn">
                        <i class="iconfont icon-refresh"></i>
                        åˆ‡æ¢èƒŒæ™¯
                    </button>
                </div>
            </div>
            <div class="nav-center">
                <span class="main-nav-link-wrap"><a class="main-nav-link active" href="index.html">é¦–é¡µ</a></span>
                <span class="main-nav-link-wrap"><a class="main-nav-link" href="moguone/tool.html">Toolå·¥å…·</a></span>
            </div>
			<div class="nav-right" id="userLoginArea">
			    <!-- åªä¿ç•™ç™»å½•æŒ‰é’®ï¼Œç‚¹å‡»è·³è½¬åˆ°login.html -->
			    <a href="moguone/login.html" class="github-login-btn" id="loginBtn">
			        <i class="iconfont icon-user"></i> ç™»å½•
			    </a>
			    <!-- ç™»å½•åæ˜¾ç¤ºï¼šç”¨æˆ·å + ä¸‹æ‹‰èœå•ï¼ˆæ›¿æ¢åŸæ¥çš„å†…å®¹ï¼‰ -->
			    <div class="user-info-display" id="userInfoBox" style="display: none;">
			      <div class="user-dropdown-trigger">
			        <span id="userNickName">æ˜µç§°</span>
			      </div>
			      <div class="user-dropdown-menu">
			        <div class="dropdown-item" id="userSettingBtn">ä¸ªäººä¸­å¿ƒ</div>
			        <div class="dropdown-item" id="logoutBtn">é€€å‡ºç™»å½•</div>
			      </div>
			    </div>
			</div>
        </nav>
        <div class="container-main">
            <aside id="sidebar">
                <div class="sidebar-wrap" data-aos="fade-up">
                    <div class="sidebar-author">
                        <img src="https://img.wjwj.top/2026/01/16/a27c17b713d7998cebb06b1dde372d64.jpg" alt="ä¸ªäººå¤´åƒ">
                        <div class="sidebar-author-name">Mo GuOne</div>
                        <div class="sidebar-description">çƒ­çˆ±æ˜¯æ‰€æœ‰çš„ç†ç”±å’Œç­”æ¡ˆ</div>
                    </div>
                    <div class="sidebar-social">
                        <a href="https://github.com/migolqn/moguwan" title="Github" target="_blank"><i class='social iconfont icon-github'></i></a>
                        <a href="https://www.zhihu.com/" title="çŸ¥ä¹" target="_blank"><i class='social iconfont icon-zhihu'></i></a>
                        <a href="mailto:2926197119@qq.com" title="é‚®ç®±"><i class='social iconfont icon-email'></i></a>
                    </div>
                    <div class="sidebar-menu">
					    <div class="sidebar-stat-wrap">
					        <div class="stat-item">
					            <div class="stat-num" id="totalCount">0</div>
					            <div class="stat-text">æ€»è®¿é—®é‡</div>
					        </div>
					    </div>
                        <div class="sidebar-update-log"><div class="update-log-title">ğŸ“Œ ç‰ˆæœ¬æ›´æ–°æ—¥å¿—</div></div>
                    </div>
                </div>
            </aside>
        
            <div id="content">
                <section id="main">
                    <article class="article-inner" data-aos="fade-up">
                        <h1 class="article-title" data-aos="slide-up">MY HOME</h1>
                        <p class="article-signature" data-aos="slide-up">
                            ä½ ä¼šä¸ä¼šå¿½ç„¶çš„å‡ºç°ï¼Œåœ¨è¡—è§’çš„å’–å•¡åº—ã€‚<strong>â€”é™ˆå¥•è¿… ã€Šå¥½ä¹…ä¸è§ã€‹</strong><br> 
                            <p class="article-signature" data-aos="slide-up">
                                ç‚¹å‡»ä¸‹æ–¹çš„å¤§æ ‡é¢˜å¯ä»¥æ‰“å¼€è¯¦æƒ…é¡µä»¥åŠæŸ¥çœ‹å‘è¡¨è¯„è®º,è¯„è®ºåŠ è½½æœ‰ç‚¹æ…¢ è¯·è€å¿ƒç­‰å¾…ğŸ˜„<br>
                            </p>
                        </p>
						<div class="search-box-container">
						    <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢æ—¥è®°æ ‡é¢˜/å†…å®¹å…³é”®è¯...">
						    <button class="search-btn" id="searchBtn"><i class="iconfont icon-search"></i> æœç´¢</button>
						    <button class="search-btn" id="resetBtn"><i class="iconfont icon-close"></i> é‡ç½®</button>
						</div>
                    </article>
                    <div class="news-container" id="newsScroll"></div>
                </section>
            </div>
        </div>
    </div>
    <footer id="footer">
    <div class="music-player">
        <div class="music-btn play-icon" id="playBtn"></div>
        <div class="music-text">Top Barry - ä¸€åŠä¸€åŠ</div>
        <audio id="music" loop preload="auto">
            <source src="moguone/song/ä¸€åŠä¸€åŠ.mp3" type="audio/mpeg">
        </audio>
    </div>
    <!-- å·²åˆ é™¤ footer-right éƒ¨åˆ† -->
</footer>
    <div class="sidebar-top" id="sidebarTop">
        <div class="arrow-up">â†‘</div>
    </div>
    
    <!-- æ–°å¢ï¼šè‡ªå®šä¹‰æç¤ºå¼¹çª—ã€ç»ç’ƒè´¨æ„Ÿï¼Œå’Œé¡µé¢é£æ ¼ç»Ÿä¸€ã€‘ -->
    <div class="tip-modal-mask" id="tipModalMask">
        <div class="tip-modal-box glass-effect">
            <button class="tip-modal-close-btn" id="tipModalCloseBtn">âœ•</button>
            <div class="tip-modal-icon">!</div>
            <div class="tip-modal-text">è¯·è¾“å…¥æœç´¢å…³é”®è¯</div>
        </div>
    </div>
	<!-- å³ä¸Šè§’å°å‹æç¤ºæ¡† -->
	<div class="toast-notification" id="toastNotification">
	    <span class="icon loading-spinner" style="display: none;"></span>
	    <span class="icon success-icon">âœ“</span>
	    <span class="text">æ“ä½œæˆåŠŸï¼</span>
	</div>
    
    <div class="img-preview-mask" id="imgPreviewMask">
        <!-- âœ…æ–°å¢ï¼šé¢„è§ˆå±‚å³ä¸Šè§’å…³é—­æŒ‰é’® -->
        <button class="preview-close-btn" id="previewCloseBtn">âœ•</button>
        <!-- âœ…æ–°å¢ï¼šå·¦å³åˆ‡æ¢æŒ‰é’® -->
        <button class="preview-nav-btn preview-prev-btn" id="previewPrevBtn">â—€</button>
        <button class="preview-nav-btn preview-next-btn" id="previewNextBtn">â–¶</button>
        <!-- âœ…æ–°å¢ï¼šé¡µç æ˜¾ç¤º -->
        <div class="preview-pagination" id="previewPagination">1/1</div>
        <img src="" alt="é¢„è§ˆå›¾ç‰‡" class="preview-img" id="previewImg">
        <video class="preview-video" id="previewVideo" controls playsinline webkit-playsinline x5-playsinline preload="auto"></video>
    </div>
	<div class="tip-modal-mask" id="bgModalMask">
	    <button class="tip-modal-close-btn" id="bgModalCloseBtn">âœ•</button>
	    <div class="tip-modal-box glass-effect">
	        <div style="font-size:18px; font-weight:bold; color:var(--color-green); margin-bottom:10px;">å£çº¸é€‰æ‹©ä¸­å¿ƒ âœ¨</div>
	        <!-- âœ… æ–°å¢ï¼šå£çº¸åˆ†ç±»åˆ‡æ¢æŒ‰é’®ã€æˆ‘çš„å£çº¸ é»˜è®¤é€‰ä¸­ã€‘ã€å®˜æ–¹å£çº¸ã€‘ -->
	        <div class="bg-tab-group">
	            <button class="bg-tab-btn active" id="customBgTab">æˆ‘çš„å£çº¸ (è‡ªå®šä¹‰)</button>
	            <button class="bg-tab-btn" id="officialBgTab">å®˜æ–¹å£çº¸</button>
	        </div>
	        <div style="display:flex;gap:10px;margin-bottom:10px;flex-wrap: wrap;">
	            <button class="search-btn" id="addBgBtn" style="padding:0 20px;">+ è‡ªå®šä¹‰æ·»åŠ å£çº¸</button>
	            <input type="file" id="bgFileInput" accept="image/jpg,image/png,image/webp" style="display:none;">
	            <span style="font-size:12px;color:var(--color-text-sub);margin:auto 0;">æ”¯æŒJPG/PNG/WEBPï¼Œå›¾ç‰‡è‡ªåŠ¨æ°¸ä¹…ä¿å­˜</span>
	        </div>
	        <div id="bgThumbList"></div>
	    </div>
	</div>
    <div class="news-modal-mask" id="newsModalMask">
		<div class="news-nav-btns">
			<button class="news-nav-btn news-next-btn" id="newsNextBtn">â†‘</button>
		    <button class="news-nav-btn news-prev-btn" id="newsPrevBtn">â†“</button>
		</div>
        <div class="news-modal-box">
            <button class="modal-close-btn" id="modalCloseBtn">âœ•</button>
            <div class="modal-news-content" id="modalNewsContent"></div>
            <div class="modal-comment-area" id="modalCommentArea"></div>
        </div>
    </div>

    <script type="text/javascript">
	// ====== å£çº¸æ ¸å¿ƒå˜é‡ã€å…¨å±€ç½®é¡¶ï¼Œä¼˜å…ˆåˆå§‹åŒ–ã€‘======
	const GITHUB_TOKEN = ["g","h","p_Eulq5","0oi65","MM7A", "rEk8H7yz","9k5W9l9", "O0e6Xmh"].join('');
	const COUNT_ISSUE_NUMBER = 7; // æ ¸å¿ƒï¼æ”¹æˆä½ æ‰‹åŠ¨åˆ›å»ºçš„ Issue ç¼–å·ï¼ˆå¦‚ #7 å°±å¡« 7ï¼‰
	// æ—¥è®°å†…å®¹å­˜å‚¨çš„Issueç¼–å·ï¼ˆæ›¿æ¢ä¸ºä½ åˆ›å»ºçš„Issueç¼–å·ï¼‰
	const NEWS_ISSUE_NUMBER = 322; 
	// æ—¥è®°å†…å®¹çš„åˆ†éš”ç¬¦ï¼ˆå’ŒåŸnews.txtä¸€è‡´ï¼Œä¸è¦æ”¹ï¼‰
	const NEWS_SEPARATOR = '---';
	const COUNT_REG = /æ€»è®¿é—®é‡ï¼š(\d+)/; // åŒ¹é… Issue æ­£æ–‡ä¸­çš„æ•°å­—ï¼Œä¸è¦æ”¹
	
	// æ–°å¢ï¼šæ–°é—»æµè§ˆé‡ç›¸å…³å˜é‡ï¼ˆåŸæœ‰ä»£ç ç¼ºå¤±ï¼‰
	const NEWS_VIEW_PREFIX = "æµè§ˆ";
	const NEWS_VIEW_SUFFIX = "é‡ï¼š";
	const NEWS_VIEW_REG = /æµè§ˆ(\d+)é‡ï¼š(\d+)/g;
	
	const NEWS_LIKE_PREFIX = "ç‚¹èµ"; // æ–°é—»ç‚¹èµé‡çš„å‰ç¼€
	const NEWS_LIKE_SUFFIX = "æ•°é‡ï¼š";
	const NEWS_LIKE_REG = /ç‚¹èµ(\d+)æ•°é‡ï¼š(\d+)/g; // åŒ¹é…æ‰€æœ‰æ–°é—»çš„ç‚¹èµé‡
	let newsLikeCounts = {}; // å­˜å‚¨æ‰€æœ‰æ–°é—»çš„ç‚¹èµé‡ {0:2, 1:6, 2:1...} ç´¢å¼•å¯¹åº”æ–°é—»ID
	// ====== è‡ªå®šä¹‰ç”¨æˆ·ç³»ç»Ÿé…ç½® ======
	const COMMENT_MAP_ISSUE_NUMBER = 299; 
	// é»˜è®¤å¤´åƒåœ°å€ï¼ˆç”¨æˆ·æ— å¤´åƒæ—¶æ˜¾ç¤ºï¼‰
	const DEFAULT_AVATAR = "https://img.wjwj.top/2026/01/20/d6346e9c8e93165079c5ab74f856358c.png"; 
	const USER_LOCAL_KEY = 'MY_CUSTOM_USER_INFO'; // æœ¬åœ°å­˜å‚¨ç™»å½•çŠ¶æ€çš„key
	let currentUser = null; // å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
	let bgUrlList = []; // å®˜æ–¹å£çº¸åˆ—è¡¨
	let customBgList = []; // æˆ‘çš„å£çº¸(è‡ªå®šä¹‰)åˆ—è¡¨
	let allBgList = []; // â˜…â˜…â˜… å¿…åŠ ï¼šå…¨å±€å£°æ˜æ€»å£çº¸åˆ—è¡¨ï¼Œè§£å†³è‡ªå®šä¹‰å£çº¸ä¸¢å¤±æ ¸å¿ƒé—®é¢˜
	const BG_CUSTOM_KEY = 'custom_bg_list';
	const BG_INDEX_KEY = 'saveBgIndex';
	let currentBgTab = 'custom'; // âœ… æ–°å¢ï¼šå½“å‰é€‰ä¸­çš„åˆ†ç±»ï¼Œé»˜è®¤custom(æˆ‘çš„å£çº¸)
	let isAnimating = false;
	let imgObserver = null;
	let videoObserver = null;
	let newsDataList = [];
	let currentModalIndex = -1;
	let scrollTopVal = 0;
	let newsAnimateObserver = null;
	
	
	const GITHUB_REPO = "moguwan/moguwan.github.io";
	// âœ…âœ…âœ… æ–°å¢ï¼šå…¨å±€æ ¸å¿ƒå˜é‡ - ç™»å½•çŠ¶æ€+ç”¨æˆ·ä¿¡æ¯+è¯„è®ºæ•°æ®
	let isLogin = false; // æ˜¯å¦ç™»å½•
	let userInfo = { // ç”¨æˆ·ä¿¡æ¯ï¼ˆQQå¤´åƒ+æ˜µç§°+openidï¼‰
	    avatar: '',
	    nickname: '',
	    openid: ''
	};
	const COMMENT_KEY = 'MY_HOME_COMMENT_DATA'; // è¯„è®ºæ•°æ®æœ¬åœ°å­˜å‚¨keyï¼Œæ°¸ä¹…ä¿å­˜
	
	function initLoginState() {
	    const saveUser = localStorage.getItem(USER_LOCAL_KEY);
	    if (saveUser) {
	        try {
	            currentUser = JSON.parse(saveUser);
	            userInfo = {
	                avatar: currentUser.avatar || DEFAULT_AVATAR,
	                nickname: currentUser.nickname || "æœªçŸ¥ç”¨æˆ·",
	                openid: currentUser.openid || currentUser.account || ""
	            };
	            document.getElementById('loginBtn').style.display = 'none';
	            document.getElementById('userInfoBox').style.display = 'flex';
	            document.getElementById('userNickName').textContent = userInfo.nickname;
	            
	            // æ¸²æŸ“ä¸‹æ‹‰èœå•
	            const dropdownMenu = document.querySelector('.user-dropdown-menu');
	            dropdownMenu.innerHTML = '';
	            
	            // 1. ä¸ªäººä¸­å¿ƒ
	            const settingItem = document.createElement('div');
	            settingItem.className = 'dropdown-item';
	            settingItem.id = 'userSettingBtn';
	            settingItem.textContent = 'ä¸ªäººä¸­å¿ƒ';
	            dropdownMenu.appendChild(settingItem);
	            
	            // 2. ç®¡ç†å‘˜åå°
	            if (currentUser.isAdmin) {
	                const adminItem = document.createElement('div');
	                adminItem.className = 'dropdown-item';
	                adminItem.id = 'adminManageBtn';
	                adminItem.textContent = 'åå°ç®¡ç†';
	                dropdownMenu.appendChild(adminItem);
	            }
	            
	            // 3. é€€å‡ºç™»å½•
	            const logoutItem = document.createElement('div');
	            logoutItem.className = 'dropdown-item';
	            logoutItem.id = 'logoutBtn';
	            logoutItem.textContent = 'é€€å‡ºç™»å½•';
	            dropdownMenu.appendChild(logoutItem);
	            
	            isLogin = true; 
	            console.log("ç™»å½•çŠ¶æ€åˆå§‹åŒ–æˆåŠŸï¼š", userInfo);
	        } catch (e) {
	            console.error("ç™»å½•çŠ¶æ€è§£æå¤±è´¥ï¼š", e);
	            isLogin = false;
	            userInfo = { avatar: '', nickname: '', openid: '' };
	        }
	    } else {
	        currentUser = null;
	        userInfo = { avatar: '', nickname: '', openid: '' };
	        isLogin = false;
	        console.log("æœªæ£€æµ‹åˆ°ç™»å½•çŠ¶æ€");
	    }
	    
	    // ç»‘å®šæŒ‰é’®äº‹ä»¶
	    document.getElementById('userSettingBtn')?.addEventListener('click', () => {
	        window.location.href = 'moguone/setting.html';
	    });
	    
	    document.getElementById('adminManageBtn')?.addEventListener('click', () => {
	        window.location.href = 'moguone/admin.html';
	    });
	    
	    document.getElementById('logoutBtn')?.addEventListener('click', logout);
	}
	
	async function getAllUsers() {
	    const requestHeaders = {
	        "Authorization": `token ${GITHUB_TOKEN}`,
	        "Accept": "application/vnd.github.v3+json",
	        "User-Agent": "Mozilla/5.0"
	    };
	
	    try {
	        const res = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${USER_ISSUE_NUMBER}`,
	            { headers: requestHeaders, method: "GET" }
	        );
	
	        if (!res.ok) {
	            return [];
	        }
	
	        const issue = await res.json();
	        const userLines = issue.body.split('\n').filter(line => line.includes('|'));
	        const users = [];
	        userLines.forEach(line => {
	            // æ‹†åˆ†å­—æ®µï¼Œå…¼å®¹æœ‰æ— ç®¡ç†å‘˜æ ‡è¯†çš„æƒ…å†µ
	            const parts = line.split('|');
	            const account = parts[0]?.trim() || '';
	            const pwd = parts[1]?.trim() || '';
	            const email = parts[2]?.trim() || '';
	            const nickname = parts[3]?.trim() || account;
	            // æ–°å¢ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯ç®¡ç†å‘˜ï¼ˆç¬¬äº”ä¸ªå­—æ®µä¸º"ç®¡ç†å‘˜"åˆ™æ˜¯ï¼‰
	            const isAdmin = parts[4]?.trim() === 'ç®¡ç†å‘˜';
	            
	            if (account && pwd) {
	                users.push({
	                    account: account,
	                    password: pwd,
	                    email: email,
	                    nickname: nickname,
	                    isAdmin: isAdmin // æ–°å¢ç®¡ç†å‘˜æ ‡è¯†å­—æ®µ
	                });
	            }
	        });
	        return users;
	    } catch (err) {
	        console.log('è¯»å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼š', err);
	        const localUsers = localStorage.getItem('temp_users');
	        return localUsers ? JSON.parse(localUsers) : [];
	    }
	}
	
	// ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°GitHub Issue
	async function saveUserToIssue(newUser) {
	    const requestHeaders = {
	        "Authorization": `token ${GITHUB_TOKEN}`,
	        "Accept": "application/vnd.github.v3+json",
	        "User-Agent": "Mozilla/5.0"
	    };
	
	    try {
	        // å…ˆè¯»å–ç°æœ‰ç”¨æˆ·
	        const users = await getAllUsers();
	        // æ·»åŠ æ–°ç”¨æˆ·
	        users.push(newUser);
	        // æ‹¼æ¥ä¸ºæ–‡æœ¬ï¼šè´¦å·|åŠ å¯†å¯†ç |é‚®ç®±|ç”¨æˆ·å
	        let body = "ç½‘ç«™ç”¨æˆ·ä¿¡æ¯åˆ—è¡¨ï¼ˆè¯·å‹¿æ‰‹åŠ¨ä¿®æ”¹ï¼‰\n";
	        users.forEach(user => {
	            body += `${user.account}|${user.password}|${user.email}|${user.nickname}\n`;
	        });
	
	        // æ›´æ–°Issue
	        const res = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${USER_ISSUE_NUMBER}`,
	            {
	                headers: requestHeaders,
	                method: "PATCH",
	                body: JSON.stringify({ 
	                    title: "ç½‘ç«™ç”¨æˆ·ä¿¡æ¯å­˜å‚¨",
	                    body: body.trim()
	                })
	            }
	        );
	
	        if (res.ok) {
	            // æœ¬åœ°ç¼“å­˜ç”¨æˆ·åˆ—è¡¨
	            localStorage.setItem('temp_users', JSON.stringify(users));
	            return true;
	        } else {
	            return false;
	        }
	    } catch (err) {
	        console.log('ä¿å­˜ç”¨æˆ·å¤±è´¥ï¼š', err);
	        return false;
	    }
	}
	function logout() {
	    currentUser = null;
	    isLogin = false;
	    localStorage.removeItem(USER_LOCAL_KEY);
	    // æ›´æ–°é¡µé¢æ˜¾ç¤º
	    document.getElementById('userInfoBox').style.display = 'none';
	    document.getElementById('loginBtn').style.display = 'flex';
	    
	    // æ˜¾ç¤ºå³ä¸Šè§’å°å‹æç¤ºæ¡†
	    const toast = document.getElementById('toastNotification');
	    toast.querySelector('.text').textContent = 'é€€å‡ºç™»å½•æˆåŠŸï¼';
	    toast.classList.add('show');
	    
	    // 3ç§’åè‡ªåŠ¨å…³é—­æç¤ºæ¡†
	    setTimeout(() => {
	        toast.classList.remove('show');
	    }, 2000);
	}

	// ä»æœ¬åœ°ç¼“å­˜+GitHubè·å–è¯„è®ºï¼ˆä¼˜å…ˆæœ¬åœ°ï¼‰
	async function getCommentData(newsIndex) {
	    // 1. å…ˆè¯»æœ¬åœ°ç¼“å­˜çš„è¯„è®ºï¼ˆç”¨æˆ·å‘è¡¨çš„å†…å®¹å­˜åœ¨è¿™é‡Œï¼‰
	    const commentData = localStorage.getItem(COMMENT_KEY);
	    const allComments = commentData ? JSON.parse(commentData) : {};
	    const localComments = allComments[`news_${newsIndex}`] || [];
	
	    // 2. å°è¯•ä»GitHubåŒæ­¥è¯„è®ºï¼ˆå¯é€‰ï¼Œå¤±è´¥åˆ™ç”¨æœ¬åœ°ï¼‰
	    const requestHeaders = {
	        "Authorization": `token ${GITHUB_TOKEN}`,
	        "Accept": "application/vnd.github.v3+json",
	        "User-Agent": "Mozilla/5.0"
	    };
	
	    try {
	        const commentIssueNumber = await getCommentIssueNumber(newsIndex);
	        const res = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${commentIssueNumber}/comments`,
	            { headers: requestHeaders, method: "GET" }
	        );
	
	        if (!res.ok) {
	            console.log('GitHubè¯„è®ºæ¥å£å¤±è´¥ï¼Œç”¨æœ¬åœ°ç¼“å­˜');
	            return localComments;
	        }
	
	        const githubComments = await res.json();
	        const githubMainComments = [];
	        const githubReplyComments = [];
	        
	        // è§£æGitHubè¯„è®º
	        githubComments.forEach(comment => {
	            const parts = comment.body.split('|');
	            let openid = parts[0] || "unknown";
	            let nickname = parts[1] || "åŒ¿åç”¨æˆ·";
	            let content = parts[2] || comment.body;
	            if (content.startsWith('ã€') && content.endsWith('ã€‘')) content = content.slice(1, -1);
	            
	            const commentObj = {
	                avatar: userInfo.avatar || DEFAULT_AVATAR,
	                nickname: nickname,
	                content: content,
	                time: new Date(comment.created_at).getTime(),
	                openid: openid,
	                replies: []
	            };
	            
	            // åˆ¤æ–­æ˜¯å¦æ˜¯å›å¤
	            if (parts.length >= 5 && parts[3] === 'reply') {
	                githubReplyComments.push({
	                    ...commentObj,
	                    replyToId: parts[4],
	                    replyTo: { nickname: parts[5] || '' }
	                });
	            } else {
	                githubMainComments.push(commentObj);
	            }
	        });
	        
	        // åŒ¹é…GitHubå›å¤åˆ°ä¸»è¯„è®º
	        githubReplyComments.forEach(reply => {
	            const parentComment = githubMainComments.find(c => c.time.toString() === reply.replyToId);
	            if (parentComment) {
	                parentComment.replies.push({
	                    avatar: reply.avatar,
	                    nickname: reply.nickname,
	                    content: reply.content,
	                    time: reply.time,
	                    openid: reply.openid,
	                    replyTo: reply.replyTo
	                });
	            }
	        });
	
	        // åˆå¹¶æœ¬åœ°+GitHubè¯„è®ºï¼ˆå¢å¼ºå»é‡ï¼štime+content+openidç»„åˆå»é‡ï¼‰
	        const mergedComments = [...localComments, ...githubMainComments].filter(
	            (comment, index, self) => {
	                // ç»„åˆå”¯ä¸€æ ‡è¯†ï¼štimeï¼ˆæ—¶é—´ï¼‰+ openidï¼ˆç”¨æˆ·ï¼‰+ contentï¼ˆå†…å®¹ï¼‰ï¼Œé¿å…é‡å¤
	                const uniqueKey = `${comment.time}-${comment.openid}-${comment.content.substring(0, 20)}`;
	                return index === self.findIndex(c => {
	                    const cKey = `${c.time}-${c.openid}-${c.content.substring(0, 20)}`;
	                    return cKey === uniqueKey;
	                });
	            }
	        ).sort((a, b) => b.time - a.time); // æœ€æ–°è¯„è®ºåœ¨å‰
	
	        return mergedComments;
	    } catch (err) {
	        console.log('GitHubè¯„è®ºè¯»å–å¤±è´¥ï¼Œç”¨æœ¬åœ°ç¼“å­˜ï¼š', err);
	        return localComments;
	    }
	}
	
	// è·å–æŸä¸ªæ—¥è®°IDå¯¹åº”çš„è¯„è®ºIssueç¼–å·ï¼ˆè‡ªåŠ¨åˆ›å»ºIssueå¹¶è®°å½•æ˜ å°„å…³ç³»ï¼‰
	async function getCommentIssueNumber(newsIndex) {
	    const requestHeaders = {
	        "Authorization": `token ${GITHUB_TOKEN}`,
	        "Accept": "application/vnd.github.v3+json",
	        "User-Agent": "Mozilla/5.0"
	    };
	
	    try {
	        // æ­¥éª¤1ï¼šè¯»å–ã€Œè¯„è®ºæ˜ å°„Issueã€çš„å†…å®¹ï¼ˆé‡Œé¢å­˜äº†æ—¥è®°IDå’Œè¯„è®ºIssueçš„å¯¹åº”å…³ç³»ï¼‰
	        const mapRes = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${COMMENT_MAP_ISSUE_NUMBER}`,
	            { headers: requestHeaders, method: "GET" }
	        );
	        if (!mapRes.ok) throw new Error(`è¯·å…ˆæ‰‹åŠ¨åˆ›å»ºã€Œè¯„è®ºæ˜ å°„Issueã€ï¼ˆç¼–å·${COMMENT_MAP_ISSUE_NUMBER}ï¼‰`);
	        
	        const mapIssue = await mapRes.json();
	        const mapBody = mapIssue.body || '';
	        const issueMap = {};
	        // è§£ææ˜ å°„æ ¼å¼ï¼šnews_0: 100ï¼ˆè¡¨ç¤ºæ—¥è®°0å¯¹åº”è¯„è®ºIssue 100ï¼‰
	        mapBody.split('\n').forEach(line => {
	            const match = line.match(/^news_(\d+): (\d+)$/);
	            if (match) issueMap[parseInt(match[1])] = parseInt(match[2]);
	        });
	
	        // æ­¥éª¤2ï¼šå¦‚æœå·²æœ‰å¯¹åº”å…³ç³»ï¼Œç›´æ¥è¿”å›Issueç¼–å·
	        if (issueMap[newsIndex] !== undefined) return issueMap[newsIndex];
	
	        // æ­¥éª¤3ï¼šæ²¡æœ‰å¯¹åº”å…³ç³» â†’ åˆ›å»ºæ–°çš„è¯„è®ºIssue
	        const newIssueRes = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues`,
	            {
	                headers: requestHeaders,
	                method: "POST",
	                body: JSON.stringify({
	                    title: `comment_#${newsIndex}`, // è¯„è®ºIssueæ ‡é¢˜ï¼ˆå’Œä½ è¦æ±‚çš„ä¸€è‡´ï¼‰
	                    body: `è¯¥Issueç”¨äºå­˜å‚¨æ—¥è®°IDä¸º ${newsIndex} çš„è¯„è®ºå†…å®¹ï¼Œæ ¼å¼ï¼šè´¦å·|ç”¨æˆ·å|ã€è¯„è®ºå†…å®¹ã€‘`,
	                    labels: ["comment", `news-${newsIndex}`]
	                })
	            }
	        );
	        if (!newIssueRes.ok) {
	            const errText = await newIssueRes.text();
	            throw new Error(`åˆ›å»ºè¯„è®ºIssueå¤±è´¥ï¼š${newIssueRes.status} - ${errText}`);
	        }
	        const newIssue = await newIssueRes.json();
	        const newIssueNumber = newIssue.number; // GitHubè‡ªåŠ¨åˆ†é…çš„æ­£ç¡®Issueç¼–å·
	
	        // æ­¥éª¤4ï¼šæ›´æ–°ã€Œè¯„è®ºæ˜ å°„Issueã€ï¼Œè®°å½•æ–°çš„å¯¹åº”å…³ç³»
	        const newMapBody = `${mapBody}\nnews_${newsIndex}: ${newIssueNumber}`.trim();
	        await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${COMMENT_MAP_ISSUE_NUMBER}`,
	            {
	                headers: requestHeaders,
	                method: "PATCH",
	                body: JSON.stringify({ body: newMapBody })
	            }
	        );
	
	        return newIssueNumber; // è¿”å›æ­£ç¡®çš„è¯„è®ºIssueç¼–å·
	    } catch (err) {
	        console.log('è·å–è¯„è®ºIssueç¼–å·å¤±è´¥ï¼š', err);
	        throw err;
	    }
	}
	
	async function saveCommentData(newsIndex, comment, isReply = false, replyToId = null, replyToNickname = '') {
	    try {
	        // 1. å…ˆä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜ï¼ˆåŸæœ‰é€»è¾‘ä¿ç•™ï¼‰
	        const commentData = localStorage.getItem(COMMENT_KEY);
	        const allComments = commentData ? JSON.parse(commentData) : {};
	        if (!allComments[`news_${newsIndex}`]) {
	            allComments[`news_${newsIndex}`] = [];
	        }
	        
	        if (isReply && replyToId) {
	            // æ‰¾åˆ°å¯¹åº”çš„ä¸»è¯„è®ºï¼ˆæŒ‰timeå”¯ä¸€æ ‡è¯†ï¼‰
	            const parentCommentIndex = allComments[`news_${newsIndex}`].findIndex(c => 
	                c.time.toString() === replyToId
	            );
	            
	            if (parentCommentIndex !== -1) {
	                // åˆå§‹åŒ–repliesæ•°ç»„ï¼ˆé˜²æ­¢ä¸å­˜åœ¨ï¼‰
	                if (!allComments[`news_${newsIndex}`][parentCommentIndex].replies) {
	                    allComments[`news_${newsIndex}`][parentCommentIndex].replies = [];
	                }
	                // æ·»åŠ å›å¤åˆ°ä¸»è¯„è®º
	                allComments[`news_${newsIndex}`][parentCommentIndex].replies.push({
	                    avatar: comment.avatar,
	                    nickname: comment.nickname,
	                    content: comment.content,
	                    time: comment.time,
	                    openid: comment.openid,
	                    replyTo: { nickname: replyToNickname }
	                });
	            }
	        } else {
	            // æ™®é€šè¯„è®ºï¼šæ·»åŠ åˆ°åˆ—è¡¨å¼€å¤´
	            allComments[`news_${newsIndex}`].unshift(comment);
	        }
	        
	        // ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
	        localStorage.setItem(COMMENT_KEY, JSON.stringify(allComments));
	
	        // 2. æ–°å¢ï¼šæäº¤è¯„è®ºåˆ°GitHub Issue Commentsï¼ˆæ ¸å¿ƒæ–°å¢é€»è¾‘ï¼‰
	        const commentIssueNumber = await getCommentIssueNumber(newsIndex);
	        const requestHeaders = {
	            "Authorization": `token ${GITHUB_TOKEN}`,
	            "Accept": "application/vnd.github.v3+json",
	            "User-Agent": "Mozilla/5.0"
	        };
	
	        // æ„å»ºGitHubè¯„è®ºå†…å®¹æ ¼å¼
	        let commentBody = '';
	        if (isReply && replyToId) {
	            // å›å¤æ ¼å¼ï¼šopenid|æ˜µç§°|ã€å†…å®¹ã€‘|reply|å›å¤çš„è¯„è®ºID|å›å¤çš„ç”¨æˆ·æ˜µç§°
	            commentBody = `${comment.openid}|${comment.nickname}|ã€${comment.content}ã€‘|reply|${replyToId}|${replyToNickname}`;
	        } else {
	            // æ™®é€šè¯„è®ºæ ¼å¼ï¼šopenid|æ˜µç§°|ã€å†…å®¹ã€‘
	            commentBody = `${comment.openid}|${comment.nickname}|ã€${comment.content}ã€‘`;
	        }
	
	        // è°ƒç”¨GitHub APIæäº¤è¯„è®º
	        const res = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${commentIssueNumber}/comments`,
	            {
	                headers: requestHeaders,
	                method: "POST",
	                body: JSON.stringify({ body: commentBody })
	            }
	        );
	
	        if (!res.ok) {
	            const errText = await res.text();
	            console.error("æäº¤è¯„è®ºåˆ°GitHubå¤±è´¥ï¼š", res.status, errText);
	            // æœ¬åœ°ä¿å­˜æˆåŠŸï¼Œä½†GitHubæäº¤å¤±è´¥ï¼Œè¿”å›trueï¼ˆä¿è¯æœ¬åœ°èƒ½ç”¨ï¼‰
	            return true;
	        }
	
	        console.log("è¯„è®ºæˆåŠŸæäº¤åˆ°GitHub Issue #", commentIssueNumber);
	        return true;
	    } catch (err) {
	        console.log('ä¿å­˜è¯„è®ºå‡ºé”™ï¼ˆGitHubæäº¤å¤±è´¥ï¼Œæœ¬åœ°ä¿å­˜æˆåŠŸï¼‰ï¼š', err);
	        // å³ä½¿GitHubæäº¤å¤±è´¥ï¼Œæœ¬åœ°ä¿å­˜æˆåŠŸä¹Ÿç®—æˆåŠŸ
	        return true;
	    }
	}
	async function deleteComment(newsIndex, commentId) {
	    try {
	        // 1. å…ˆåˆ é™¤æœ¬åœ°ç¼“å­˜ä¸­çš„è¯„è®ºï¼ˆåŸæœ‰é€»è¾‘ï¼‰
	        const commentData = localStorage.getItem(COMMENT_KEY);
	        const allComments = commentData ? JSON.parse(commentData) : {};
	        
	        if (allComments[`news_${newsIndex}`]) {
	            // æ‰¾åˆ°è¦åˆ é™¤çš„è¯„è®º
	            const commentIndex = allComments[`news_${newsIndex}`].findIndex(
	                comment => comment.time.toString() === commentId.toString()
	            );
	            
	            if (commentIndex === -1) {
	                console.log("æœªæ‰¾åˆ°è¦åˆ é™¤çš„è¯„è®ºï¼š", commentId);
	                return false;
	            }
	            
	            // æƒé™éªŒè¯ï¼šç®¡ç†å‘˜å¯åˆ æ‰€æœ‰äººï¼Œæ™®é€šç”¨æˆ·åªèƒ½åˆ è‡ªå·±çš„
	            const targetComment = allComments[`news_${newsIndex}`][commentIndex];
	            const userOpenId = userInfo.openid || userInfo.account || "";
	            if (!currentUser?.isAdmin && targetComment.openid !== userOpenId) {
	                alert("ä½ æ²¡æœ‰æƒé™åˆ é™¤è¿™æ¡è¯„è®ºï¼");
	                return false;
	            }
	            
	            // æ‰§è¡Œæœ¬åœ°åˆ é™¤
	            allComments[`news_${newsIndex}`].splice(commentIndex, 1);
	            localStorage.setItem(COMMENT_KEY, JSON.stringify(allComments));
	
	            // 2. æ–°å¢ï¼šåˆ é™¤GitHubä¸Šçš„å¯¹åº”è¯„è®º
	            try {
	                const commentIssueNumber = await getCommentIssueNumber(newsIndex);
	                const requestHeaders = {
	                    "Authorization": `token ${GITHUB_TOKEN}`,
	                    "Accept": "application/vnd.github.v3+json",
	                    "User-Agent": "Mozilla/5.0"
	                };
	
	                // å…ˆè·å–è¯¥Issueä¸‹çš„æ‰€æœ‰è¯„è®º
	                const commentsRes = await fetch(
	                    `https://api.github.com/repos/${GITHUB_REPO}/issues/${commentIssueNumber}/comments`,
	                    { headers: requestHeaders, method: "GET" }
	                );
	
	                if (commentsRes.ok) {
	                    const githubComments = await commentsRes.json();
	                    // æ‰¾åˆ°å¯¹åº”æ—¶é—´çš„è¯„è®ºï¼ˆé€šè¿‡å†…å®¹ä¸­çš„timeåŒ¹é…ï¼‰
	                    for (const ghComment of githubComments) {
	                        const parts = ghComment.body.split('|');
	                        if (parts.length >= 3 && !parts.includes('reply')) {
	                            // æ™®é€šè¯„è®ºï¼šæŸ¥æ‰¾åˆ›å»ºæ—¶é—´åŒ¹é…çš„ï¼ˆæˆ–å†…å®¹ä¸­çš„timeï¼‰
	                            const commentTime = new Date(ghComment.created_at).getTime().toString();
	                            if (commentTime === commentId || ghComment.body.includes(`|ã€${targetComment.content}ã€‘`)) {
	                                // è°ƒç”¨åˆ é™¤API
	                                await fetch(
	                                    `https://api.github.com/repos/${GITHUB_REPO}/issues/comments/${ghComment.id}`,
	                                    { headers: requestHeaders, method: "DELETE" }
	                                );
	                                console.log("æˆåŠŸåˆ é™¤GitHubä¸Šçš„è¯„è®º ID:", ghComment.id);
	                                break;
	                            }
	                        }
	                    }
	                }
	            } catch (err) {
	                console.error("åˆ é™¤GitHubè¯„è®ºå¤±è´¥ï¼š", err);
	                // GitHubåˆ é™¤å¤±è´¥ä¸å½±å“æœ¬åœ°åˆ é™¤
	            }
	
	            console.log("è¯„è®ºåˆ é™¤æˆåŠŸï¼š", commentId);
	            
	            // æ˜¾ç¤ºæç¤º
	            const toast = document.getElementById('toastNotification');
	            toast.querySelector('.text').textContent = 'è¯„è®ºåˆ é™¤æˆåŠŸï¼';
	            toast.classList.add('show');
	            setTimeout(() => {
	                toast.classList.remove('show');
	            }, 2000);
	            
	            return true;
	        } else {
	            console.log("è¯¥æ—¥è®°æ— è¯„è®ºæ•°æ®ï¼š", newsIndex);
	            return false;
	        }
	    } catch (err) {
	        console.error('åˆ é™¤è¯„è®ºå¤±è´¥ï¼š', err);
	        alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
	        return false;
	    }
	}
	
	async function deleteReply(newsIndex, commentId, replyId) {
	    try {
	        // 1. æœ¬åœ°åˆ é™¤é€»è¾‘ï¼ˆåŸæœ‰ï¼‰
	        const commentData = localStorage.getItem(COMMENT_KEY);
	        const allComments = commentData ? JSON.parse(commentData) : {};
	        
	        if (allComments[`news_${newsIndex}`]) {
	            // æ‰¾åˆ°å¯¹åº”çš„ä¸»è¯„è®º
	            const commentIndex = allComments[`news_${newsIndex}`].findIndex(
	                comment => comment.time.toString() === commentId.toString()
	            );
	            
	            if (commentIndex !== -1) {
	                const replies = allComments[`news_${newsIndex}`][commentIndex].replies || [];
	                const replyIndex = replies.findIndex(
	                    reply => reply.time.toString() === replyId.toString()
	                );
	                
	                if (replyIndex === -1) {
	                    console.log("æœªæ‰¾åˆ°è¦åˆ é™¤çš„å›å¤ï¼š", replyId);
	                    return false;
	                }
	                
	                // æƒé™éªŒè¯
	                const targetReply = replies[replyIndex];
	                const userOpenId = userInfo.openid || userInfo.account || "";
	                if (!currentUser?.isAdmin && targetReply.openid !== userOpenId) {
	                    alert("ä½ æ²¡æœ‰æƒé™åˆ é™¤è¿™æ¡å›å¤ï¼");
	                    return false;
	                }
	                
	                // æœ¬åœ°åˆ é™¤
	                const deletedReply = replies.splice(replyIndex, 1)[0];
	                allComments[`news_${newsIndex}`][commentIndex].replies = replies;
	                localStorage.setItem(COMMENT_KEY, JSON.stringify(allComments));
	
	                // 2. æ–°å¢ï¼šåˆ é™¤GitHubä¸Šçš„å›å¤
	                try {
	                    const commentIssueNumber = await getCommentIssueNumber(newsIndex);
	                    const requestHeaders = {
	                        "Authorization": `token ${GITHUB_TOKEN}`,
	                        "Accept": "application/vnd.github.v3+json",
	                        "User-Agent": "Mozilla/5.0"
	                    };
	
	                    // è·å–æ‰€æœ‰è¯„è®º
	                    const commentsRes = await fetch(
	                        `https://api.github.com/repos/${GITHUB_REPO}/issues/${commentIssueNumber}/comments`,
	                        { headers: requestHeaders, method: "GET" }
	                    );
	
	                    if (commentsRes.ok) {
	                        const githubComments = await commentsRes.json();
	                        // æŸ¥æ‰¾å¯¹åº”çš„å›å¤è¯„è®º
	                        for (const ghComment of githubComments) {
	                            const parts = ghComment.body.split('|');
	                            if (parts.length >= 6 && parts[3] === 'reply' && parts[4] === commentId) {
	                                // åŒ¹é…å›å¤å†…å®¹å’Œç”¨æˆ·
	                                if (ghComment.body.includes(`|ã€${deletedReply.content}ã€‘|reply|`) && 
	                                    ghComment.body.includes(`|${deletedReply.nickname}`)) {
	                                    // åˆ é™¤GitHubè¯„è®º
	                                    await fetch(
	                                        `https://api.github.com/repos/${GITHUB_REPO}/issues/comments/${ghComment.id}`,
	                                        { headers: requestHeaders, method: "DELETE" }
	                                    );
	                                    console.log("æˆåŠŸåˆ é™¤GitHubä¸Šçš„å›å¤ ID:", ghComment.id);
	                                    break;
	                                }
	                            }
	                        }
	                    }
	                } catch (err) {
	                    console.error("åˆ é™¤GitHubå›å¤å¤±è´¥ï¼š", err);
	                }
	
	                console.log("å›å¤åˆ é™¤æˆåŠŸï¼š", replyId);
	                
	                // æ˜¾ç¤ºæç¤º
	                const toast = document.getElementById('toastNotification');
	                toast.querySelector('.text').textContent = 'å›å¤åˆ é™¤æˆåŠŸï¼';
	                toast.classList.add('show');
	                setTimeout(() => {
	                    toast.classList.remove('show');
	                }, 2000);
	                
	                return true;
	            } else {
	                console.log("æœªæ‰¾åˆ°å¯¹åº”çš„ä¸»è¯„è®ºï¼š", commentId);
	                return false;
	            }
	        } else {
	            console.log("è¯¥æ—¥è®°æ— è¯„è®ºæ•°æ®ï¼š", newsIndex);
	            return false;
	        }
	    } catch (err) {
	        console.error('åˆ é™¤å›å¤å¤±è´¥ï¼š', err);
	        alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
	        return false;
	    }
	}
	// âœ…âœ…âœ… æ–°å¢ï¼šæ ¼å¼åŒ–æ—¶é—´ - è¯„è®ºæ˜¾ç¤ºå‘å¸ƒæ—¶é—´
	function formatTime(timestamp) {
	    const date = new Date(timestamp);
	    const year = date.getFullYear();
	    const month = (date.getMonth() + 1).toString().padStart(2, '0');
	    const day = date.getDate().toString().padStart(2, '0');
	    const hour = date.getHours().toString().padStart(2, '0');
	    const minute = date.getMinutes().toString().padStart(2, '0');
	    return `${year}-${month}-${day} ${hour}:${minute}`;
	}
	
	// æ¸²æŸ“è¯„è®ºåŒºã€æ”¯æŒä¸€å±‚å›å¤ã€æ”¶èµ·/å±•å¼€ã€åˆ é™¤ã€æŒ‰å›å¤æ•°æ’åºã€‘
	function renderCommentArea(newsIndex) {
	    const commentArea = document.getElementById('modalCommentArea');
	    commentArea.innerHTML = '';
	    const commentWrap = document.createElement('div');
	    commentWrap.className = 'comment-wrap';
	    
	    // è¯„è®ºæ ‡é¢˜
	    const commentTitle = document.createElement('div');
	    commentTitle.className = 'comment-title';
	    commentTitle.textContent = 'ğŸ’¬ comment';
	    commentWrap.appendChild(commentTitle);
	    
	    if (!isLogin) {
	        // æœªç™»å½•ï¼šæ˜¾ç¤ºç™»å½•æç¤º
	        const loginTip = document.createElement('div');
	        loginTip.className = 'comment-login-tip';
	        loginTip.textContent = 'ä½ è¿˜æœªç™»å½•ï¼Œç‚¹å‡»æ­¤å¤„ç™»å½• â†’ ç™»å½•åå³å¯å‘è¡¨è¯„è®º/å›å¤';
	        loginTip.onclick = openLoginModal; // è°ƒç”¨æ–°å¢çš„ç™»å½•å‡½æ•°
	        commentWrap.appendChild(loginTip);
	        commentArea.appendChild(commentWrap);
	        return;
	    }
	    
	    // å·²ç™»å½•ï¼šè¯„è®ºè¾“å…¥æ¡†
	    const inputBox = document.createElement('div');
	    inputBox.className = 'comment-input-box';
	    const commentInput = document.createElement('textarea');
	    commentInput.className = 'comment-input';
	    commentInput.placeholder = 'å†™ä¸‹ä½ çš„è¯„è®ºå§...';
	    commentInput.rows = 1;
	    const submitBtn = document.createElement('button');
	    submitBtn.className = 'comment-submit-btn';
	    submitBtn.textContent = 'å‘è¡¨è¯„è®º';
	    submitBtn.disabled = true;
	    inputBox.appendChild(commentInput);
	    inputBox.appendChild(submitBtn);
	    commentWrap.appendChild(inputBox);
	    
	    // è¾“å…¥æ¡†è‡ªåŠ¨è°ƒæ•´é«˜åº¦ - ä¿®å¤åˆå§‹åŒ–é«˜åº¦é—®é¢˜
	    commentInput.addEventListener('focus', () => {
	        commentInput.style.height = 'auto';
	        commentInput.style.height = commentInput.scrollHeight + 'px';
	    });
	    
	    // å›å¤çŠ¶æ€å˜é‡ï¼ˆé™åˆ¶åªèƒ½å›å¤ä¸»è¯„è®ºï¼Œä¸èƒ½å›å¤å›å¤ï¼‰
	    let isReplying = false;
	    let replyToId = null;
	    let replyToNickname = '';
	    const replyInputBox = document.createElement('div');
	    replyInputBox.className = 'comment-input-box reply-input-box';
	    replyInputBox.style.display = 'none';
	    replyInputBox.style.marginLeft = '36px';
	    const replyInput = document.createElement('textarea');
	    replyInput.className = 'comment-input';
	    replyInput.placeholder = 'å›å¤TA...';
	    replyInput.rows = 1;
	    const replySubmitBtn = document.createElement('button');
	    replySubmitBtn.className = 'comment-submit-btn';
	    replySubmitBtn.textContent = 'å›å¤';
	    replySubmitBtn.disabled = true;
	    const replyCancelBtn = document.createElement('button');
	    replyCancelBtn.className = 'comment-submit-btn';
	    replyCancelBtn.textContent = 'å–æ¶ˆ';
	    replyInputBox.appendChild(replyInput);
	    replyInputBox.appendChild(replySubmitBtn);
	    replyInputBox.appendChild(replyCancelBtn);
	    commentWrap.appendChild(replyInputBox);
	    
	    // å–æ¶ˆå›å¤
	    replyCancelBtn.addEventListener('click', () => {
	        isReplying = false;
	        replyToId = null;
	        replyToNickname = '';
	        replyInputBox.style.display = 'none';
	        replyInput.value = '';
	        replyInput.style.height = 'auto';
	        replyInput.style.height = replyInput.scrollHeight + 'px';
	        replySubmitBtn.disabled = true;
	    });
	    
	    // è¾“å…¥æ¡†è‡ªåŠ¨è°ƒæ•´é«˜åº¦
	    commentInput.addEventListener('input', () => {
	        const content = commentInput.value.trim();
	        submitBtn.disabled = content.length === 0 || !isLogin; // åŒæ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
	        commentInput.style.height = 'auto';
	        const contentHeight = commentInput.scrollHeight;
	        const maxHeight = parseInt(getComputedStyle(commentInput).maxHeight);
	        commentInput.style.height = Math.min(contentHeight, maxHeight) + 'px';
	    });
	    
	    replyInput.addEventListener('input', () => {
	        const content = replyInput.value.trim();
	        replySubmitBtn.disabled = content.length === 0 || !isLogin; // åŒæ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
	        replyInput.style.height = 'auto';
	        const contentHeight = replyInput.scrollHeight;
	        const maxHeight = parseInt(getComputedStyle(replyInput).maxHeight);
	        replyInput.style.height = Math.min(contentHeight, maxHeight) + 'px';
	    });
	    // åˆå§‹åŒ–è¾“å…¥æ¡†ï¼ˆå¼ºåˆ¶è§¦å‘ä¸€æ¬¡inputäº‹ä»¶ï¼‰
	    commentInput.dispatchEvent(new Event('input'));
	    replyInput.dispatchEvent(new Event('input'));
	    
	    // å‘è¡¨ä¸»è¯„è®º
	    submitBtn.addEventListener('click', async () => {
	        const content = commentInput.value.trim();
	        if (!content || !isLogin) { // å¢åŠ ç™»å½•çŠ¶æ€æ£€æŸ¥
	            alert(isLogin ? "è¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©ºï¼" : "è¯·å…ˆç™»å½•åå‘è¡¨è¯„è®ºï¼");
	            return;
	        }
	        
	        submitBtn.disabled = true;
	        submitBtn.textContent = 'æäº¤ä¸­...';
	        
	        const newComment = {
	            avatar: userInfo.avatar || DEFAULT_AVATAR,
	            nickname: userInfo.nickname || "æœªçŸ¥ç”¨æˆ·",
	            content: content,
	            time: Date.now(),
	            openid: userInfo.openid || "unknown",
	            replies: [] // åˆå§‹åŒ–å›å¤æ•°ç»„
	        };
	        
	        console.log("å‘è¡¨ä¸»è¯„è®ºï¼š", newComment); // æ–°å¢ï¼šè°ƒè¯•æ—¥å¿—
	        const saveResult = await saveCommentData(newsIndex, newComment);
	        
	        if (saveResult) {
	            commentInput.value = '';
	            commentInput.style.height = 'auto';
	            commentInput.style.height = commentInput.scrollHeight + 'px';
	            // æ˜¾ç¤ºæˆåŠŸæç¤º
	            const toast = document.getElementById('toastNotification');
	            toast.querySelector('.text').textContent = 'è¯„è®ºå‘è¡¨æˆåŠŸï¼';
	            toast.classList.add('show');
	            setTimeout(() => {
	                toast.classList.remove('show');
	            }, 2000);
	            
	            // ä¼˜åŒ–ï¼šç›´æ¥æ›´æ–°è¯„è®ºåˆ—è¡¨ï¼Œä¸é‡æ–°æ¸²æŸ“æ•´ä¸ªè¯„è®ºåŒºï¼ˆé¿å…é‡å¤ï¼‰
	            const commentList = document.querySelector('.comment-list');
	            if (commentList) {
	                // æ¸…ç©ºåŠ è½½çŠ¶æ€ï¼Œç›´æ¥æ’å…¥æ–°è¯„è®ºåˆ°é¡¶éƒ¨
	                commentList.innerHTML = '';
	                // å…ˆæ’å…¥æ–°è¯„è®º
	                const newCommentItem = createCommentElement(newComment);
	                commentList.appendChild(newCommentItem);
	                // å†åŠ è½½å‰©ä½™è¯„è®ºï¼ˆè·³è¿‡å·²æ·»åŠ çš„æ–°è¯„è®ºï¼‰
	                getCommentData(newsIndex).then(comments => {
	                    const existingComments = comments.filter(c => c.time !== newComment.time);
	                    existingComments.forEach(comment => {
	                        const commentItem = createCommentElement(comment);
	                        commentList.appendChild(commentItem);
	                    });
	                });
	            }
	        } else {
	            alert("è¯„è®ºå‘è¡¨å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	        }
	        
	        submitBtn.textContent = 'å‘è¡¨è¯„è®º';
	        submitBtn.disabled = false; // ä¿®å¤ï¼šé‡æ–°å¯ç”¨æŒ‰é’®
	    });
	    
	    // å‘è¡¨å›å¤ï¼ˆä»…æ”¯æŒå›å¤ä¸»è¯„è®ºï¼‰
	    replySubmitBtn.addEventListener('click', async () => {
	        const content = replyInput.value.trim();
	        if (!content || !isLogin || !isReplying || !replyToId) { // å¢åŠ ç™»å½•çŠ¶æ€æ£€æŸ¥
	            alert(isLogin ? "å›å¤å†…å®¹ä¸èƒ½ä¸ºç©ºï¼" : "è¯·å…ˆç™»å½•åå‘è¡¨å›å¤ï¼");
	            return;
	        }
	        
	        replySubmitBtn.disabled = true;
	        replySubmitBtn.textContent = 'å›å¤ä¸­...';
	        
	        const newReply = {
	            avatar: userInfo.avatar || DEFAULT_AVATAR,
	            nickname: userInfo.nickname || "æœªçŸ¥ç”¨æˆ·",
	            content: content,
	            time: Date.now(),
	            openid: userInfo.openid || "unknown",
	            replyTo: { nickname: replyToNickname }
	        };
	        
	        console.log("å‘è¡¨å›å¤ï¼š", newReply); // æ–°å¢ï¼šè°ƒè¯•æ—¥å¿—
	        const saveResult = await saveCommentData(newsIndex, newReply, true, replyToId, replyToNickname);
	        
	        if (saveResult) {
	            isReplying = false;
	            replyToId = null;
	            replyToNickname = '';
	            replyInput.value = '';
	            replyInput.style.height = 'auto';
	            replyInput.style.height = replyInput.scrollHeight + 'px';
	            replyInputBox.style.display = 'none';
	            // æ˜¾ç¤ºæˆåŠŸæç¤º
	            const toast = document.getElementById('toastNotification');
	            toast.querySelector('.text').textContent = 'å›å¤å‘è¡¨æˆåŠŸï¼';
	            toast.classList.add('show');
	            setTimeout(() => {
	                toast.classList.remove('show');
	            }, 2000);
	            
	            // ä¼˜åŒ–ï¼šç›´æ¥æ›´æ–°å¯¹åº”è¯„è®ºçš„å›å¤åˆ—è¡¨ï¼Œä¸é‡æ–°æ¸²æŸ“æ•´ä¸ªè¯„è®ºåŒº
	            const parentCommentItem = document.querySelector(`.comment-item .comment-time[data-comment-id="${replyToId}"]`)?.closest('.comment-item');
	            if (parentCommentItem) {
	                const replyListContainer = parentCommentItem.querySelector('.reply-list-container');
	                const replyToggleBtn = parentCommentItem.querySelector('.reply-toggle-btn');
	                // åˆ›å»ºæ–°å›å¤å…ƒç´ 
	                const newReplyItem = document.createElement('div');
	                const isOwnReply = newReply.openid && userInfo.openid && newReply.openid === userInfo.openid;
	                newReplyItem.className = `comment-item reply-item ${isOwnReply ? 'own-reply' : ''}`;
	                newReplyItem.style.padding = '10px';
	                newReplyItem.style.marginBottom = '8px';
	                newReplyItem.style.backgroundColor = 'rgba(56, 161, 105, 0.05)';
	                
	                newReplyItem.innerHTML = `
	                    <div class="comment-user-info" style="margin-bottom: 4px;">
	                        <img src="${newReply.avatar || DEFAULT_AVATAR}" alt="å¤´åƒ" class="comment-user-avatar" style="width: 24px; height: 24px;">
	                        <span class="comment-user-name" style="font-size: 13px;">${newReply.nickname}</span>
	                        <span style="font-size: 12px; color: var(--color-text-sub);">
	                            @${newReply.replyTo?.nickname || 'æœªçŸ¥ç”¨æˆ·'}
	                        </span>
	                        <span class="comment-time" style="font-size: 11px;">${formatTime(newReply.time)}</span>
	                        <button class="reply-delete-btn ${(currentUser?.isAdmin ? 'admin-visible' : '')}" data-comment-id="${replyToId}" data-reply-id="${newReply.time}" data-openid="${newReply.openid || ''}">åˆ é™¤</button>
	                    </div>
	                    <div class="comment-content" style="padding-left: 30px; font-size: 14px;">${newReply.content}</div>
	                `;
	                
	                // æ’å…¥æ–°å›å¤åˆ°å›å¤åˆ—è¡¨é¡¶éƒ¨
	                replyListContainer.appendChild(newReplyItem);
	                replyListContainer.classList.add('expanded'); // è‡ªåŠ¨å±•å¼€å›å¤
	                
	                // æ›´æ–°å›å¤æ•°é‡
	                const currentReplyCount = (replyListContainer.querySelectorAll('.reply-item').length) || 1;
	                replyToggleBtn.innerHTML = `â–² æ”¶èµ·å›å¤`;
	                replyToggleBtn.disabled = false;
	                
	                // ç»‘å®šåˆ é™¤äº‹ä»¶
	                const deleteBtn = newReplyItem.querySelector('.reply-delete-btn');
	                deleteBtn.addEventListener('click', async (e) => {
	                    e.stopPropagation();
	                    if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å›å¤å—ï¼Ÿ')) return;
	                    const deleteResult = await deleteReply(newsIndex, replyToId, newReply.time);
	                    if (deleteResult) {
	                        newReplyItem.remove();
	                    } else {
	                        alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	                    }
	                });
	            }
	        } else {
	            alert("å›å¤å‘è¡¨å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	        }
	        
	        replySubmitBtn.textContent = 'å›å¤';
	        replySubmitBtn.disabled = false; // ä¿®å¤ï¼šé‡æ–°å¯ç”¨æŒ‰é’®
	        
	        // ç§»é™¤é‡å¤çš„renderCommentAreaè°ƒç”¨
	        // renderCommentArea(newsIndex);
	    });
	    
	    // è¯„è®ºåˆ—è¡¨å®¹å™¨
	    const commentList = document.createElement('div');
	    commentList.className = 'comment-list';
	    commentList.innerHTML = `
	      <div class="comment-empty apple-loading-comment" style="text-align:center; padding:20px; color:var(--color-green); font-weight:300; letter-spacing:0.5px; font-family: -apple-system, BlinkMacSystemFont, sans-serif;">
	        <span style="display:inline-flex; align-items:center; gap:8px;">
	          åŠ è½½è¯„è®ºä¸­
	          <span style="display:flex; gap:2px; margin-top:2px;">
	            <span style="width:4px; height:4px; border-radius:50%; background:var(--color-green); animation: apple-breathe 1.2s infinite ease-in-out 0s;"></span>
	            <span style="width:4px; height:4px; border-radius:50%; background:var(--color-green); animation: apple-breathe 1.2s infinite ease-in-out 0.2s;"></span>
	            <span style="width:4px; height:4px; border-radius:50%; background:var(--color-green); animation: apple-breathe 1.2s infinite ease-in-out 0.4s;"></span>
	          </span>
	        </span>
	      </div>
	    `;
	    // å†…è”æ ·å¼å®šä¹‰åŠ¨ç”»ï¼ˆè§£å†³åŠ¨ç”»æœªå®šä¹‰é—®é¢˜ï¼‰
	    const style = document.createElement('style');
	    style.textContent = `
	      @keyframes apple-breathe {
	        0%, 100% { opacity: 0.4; transform: scale(0.9); }
	        50% { opacity: 1; transform: scale(1.1); }
	      }
	    `;
	    commentList.appendChild(style);
	    commentWrap.appendChild(commentList);
	    
	    // å¼‚æ­¥è·å–è¯„è®ºå¹¶æ¸²æŸ“ï¼ˆæŒ‰å›å¤æ•°æ’åºï¼‰
	    getCommentData(newsIndex).then(comments => {
	        commentList.innerHTML = '';
	        
	        // æŒ‰å›å¤æ•°ä»å¤šåˆ°å°‘æ’åº
	        const sortedComments = [...comments].sort((a, b) => {
	            const aReplyCount = a.replies ? a.replies.length : 0;
	            const bReplyCount = b.replies ? b.replies.length : 0;
	            return bReplyCount - aReplyCount;
	        });
	        
	        if (sortedComments.length === 0) {
	            const emptyTip = document.createElement('div');
	            emptyTip.className = 'comment-empty';
	            emptyTip.textContent = 'æš‚æ— è¯„è®ºï¼Œå¿«æ¥æŠ¢æ²™å‘å§ï½';
	            commentList.appendChild(emptyTip);
	        } else {
	            sortedComments.forEach(comment => {
	                const commentItem = document.createElement('div');
	                commentItem.className = 'comment-item';
	                // æ ‡è®°æ˜¯å¦æ˜¯è‡ªå·±çš„è¯„è®º
	                const commentOpenId = comment.openid || "";
	                const userOpenId = userInfo.openid || userInfo.account || ""; // å…¼å®¹accountå­—æ®µ
	                if (commentOpenId && userOpenId && commentOpenId === userOpenId) {
	                    commentItem.classList.add('own-comment');
	                    console.log("æ ‡è®°ä¸ºè‡ªå·±çš„è¯„è®ºï¼š", comment.time);
	                }
	                // è¯„è®ºå¤´éƒ¨ï¼ˆç”¨æˆ·ä¿¡æ¯+æ—¶é—´+å›å¤+åˆ é™¤æŒ‰é’®ï¼‰
	                const commentHeader = document.createElement('div');
	                commentHeader.className = 'comment-user-info';
	                commentHeader.innerHTML = `
	                    <img src="${comment.avatar || DEFAULT_AVATAR}" alt="å¤´åƒ" class="comment-user-avatar">
	                    <span class="comment-user-name">${comment.nickname}</span>
	                    <span class="comment-time">${formatTime(comment.time)}</span>
	                    <button class="comment-reply-btn" style="margin-left: 10px; padding: 2px 8px; font-size: 12px; background: transparent; border: 1px solid var(--color-green); color: var(--color-green); border-radius: 4px; cursor: pointer; transition: all 0.2s ease;">
	                        å›å¤
	                    </button>
	                    <button class="comment-delete-btn ${(currentUser?.isAdmin ? 'admin-visible' : '')}" data-comment-id="${comment.time}" data-openid="${comment.openid || ''}">åˆ é™¤</button>
	                `;
	                
	                // è¯„è®ºå†…å®¹
	                const commentContent = document.createElement('div');
	                commentContent.className = 'comment-content';
	                commentContent.textContent = comment.content;
	                
	                // å›å¤æ•°é‡å’Œå±•å¼€/æ”¶èµ·æŒ‰é’®
	                const replyCount = comment.replies ? comment.replies.length : 0;
	                const replyToggleBtn = document.createElement('button');
	                replyToggleBtn.className = 'reply-toggle-btn';
	                replyToggleBtn.innerHTML = replyCount > 0 
	                    ? `â–¼ æŸ¥çœ‹${replyCount}æ¡å›å¤` 
	                    : 'æš‚æ— å›å¤';
	                replyToggleBtn.disabled = replyCount === 0;
	                
	                // å›å¤åˆ—è¡¨å®¹å™¨ï¼ˆé»˜è®¤æ”¶èµ·ï¼‰
	                const replyListContainer = document.createElement('div');
	                replyListContainer.className = 'reply-list-container';
	                
	                // æ¸²æŸ“å›å¤åˆ—è¡¨
	                if (comment.replies && comment.replies.length > 0) {
						comment.replies.forEach(reply => {
	                    const replyItem = document.createElement('div');
	                    // æ ¸å¿ƒä¿®æ”¹ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰ç”¨æˆ·çš„å›å¤ï¼Œæ·»åŠ own-replyç±»
	                    const isOwnReply = reply.openid && userInfo.openid && reply.openid === userInfo.openid;
	                    replyItem.className = `comment-item reply-item ${isOwnReply ? 'own-reply' : ''}`;
	                    replyItem.style.padding = '10px';
	                    replyItem.style.marginBottom = '8px';
	                    replyItem.style.backgroundColor = 'rgba(56, 161, 105, 0.05)';
	                    
	                    const replyHeader = document.createElement('div');
	                    replyHeader.className = 'comment-user-info';
	                    replyHeader.style.marginBottom = '4px';
	                    // ä¼˜åŒ–ï¼šåªæœ‰è‡ªå·±çš„å›å¤æ‰æ˜¾ç¤ºåˆ é™¤æŒ‰é’®ï¼ˆåŒé‡ä¿éšœï¼‰
	                    const deleteBtnHtml = isOwnReply || currentUser?.isAdmin ? 
	                        `<button class="reply-delete-btn ${(currentUser?.isAdmin ? 'admin-visible' : '')}" data-comment-id="${comment.time}" data-reply-id="${reply.time}" data-openid="${reply.openid || ''}">åˆ é™¤</button>` : '';
	                    
	                    replyHeader.innerHTML = `
	                        <img src="${reply.avatar || DEFAULT_AVATAR}" alt="å¤´åƒ" class="comment-user-avatar" style="width: 24px; height: 24px;">
	                        <span class="comment-user-name" style="font-size: 13px;">${reply.nickname}</span>
	                        <span style="font-size: 12px; color: var(--color-text-sub);">
	                            @${reply.replyTo?.nickname || 'æœªçŸ¥ç”¨æˆ·'}
	                        </span>
	                        <span class="comment-time" style="font-size: 11px;">${formatTime(reply.time)}</span>
	                        ${deleteBtnHtml}
	                    `;
	                    
	                    const replyContent = document.createElement('div');
	                    replyContent.className = 'comment-content';
	                    replyContent.style.paddingLeft = '30px';
	                    replyContent.style.fontSize = '14px';
	                    replyContent.textContent = reply.content;
	                    
	                    replyItem.appendChild(replyHeader);
	                    replyItem.appendChild(replyContent);
	                    replyListContainer.appendChild(replyItem);
	                });
	                }
	                
	                // å±•å¼€/æ”¶èµ·å›å¤
	                replyToggleBtn.addEventListener('click', () => {
	                    replyListContainer.classList.toggle('expanded');
	                    replyToggleBtn.innerHTML = replyListContainer.classList.contains('expanded')
	                        ? `â–² æ”¶èµ·å›å¤`
	                        : `â–¼ æŸ¥çœ‹${replyCount}æ¡å›å¤`;
	                });
	                
	                // ç»‘å®šå›å¤æŒ‰é’®äº‹ä»¶ï¼ˆä»…å…è®¸å›å¤ä¸»è¯„è®ºï¼‰
	                const replyBtn = commentHeader.querySelector('.comment-reply-btn');
	                replyBtn.addEventListener('click', () => {
	                    isReplying = true;
	                    replyToId = comment.time.toString();
	                    replyToNickname = comment.nickname;
	                    replyInput.placeholder = `å›å¤ ${comment.nickname}...`;
	                    replyInputBox.style.display = 'flex';
	                    replyInput.focus();
	                });
	                
	                // ç»‘å®šè¯„è®ºåˆ é™¤äº‹ä»¶
	                const deleteBtn = commentHeader.querySelector('.comment-delete-btn');
	                if (deleteBtn) {
	                    deleteBtn.addEventListener('click', async (e) => {
	                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
	                        if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åæ‰€æœ‰å›å¤ä¹Ÿä¼šè¢«åˆ é™¤ã€‚')) return;
	                        
	                        console.log("åˆ é™¤è¯„è®ºï¼š", comment.time); // æ–°å¢ï¼šè°ƒè¯•æ—¥å¿—
	                        // åˆ é™¤ä¸»è¯„è®ºåŠæ‰€æœ‰å›å¤
	                        const deleteResult = await deleteComment(newsIndex, comment.time);
	                        if (deleteResult) {
	                            // ç«‹å³åˆ·æ–°è¯„è®ºåŒº
	                            renderCommentArea(newsIndex);
	                        } else {
	                            alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	                        }
	                    });
	                }
	                
	                // ç»‘å®šå›å¤åˆ é™¤äº‹ä»¶
	                const replyDeleteBtns = replyListContainer.querySelectorAll('.reply-delete-btn');
	                replyDeleteBtns.forEach(btn => {
	                    btn.addEventListener('click', async (e) => {
	                        e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
	                        if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å›å¤å—ï¼Ÿ')) return;
	                        
	                        const commentId = btn.dataset.commentId;
	                        const replyId = btn.dataset.replyId;
	                        console.log("åˆ é™¤å›å¤ï¼š", commentId, replyId); // æ–°å¢ï¼šè°ƒè¯•æ—¥å¿—
	                        
	                        // åˆ é™¤å•æ¡å›å¤
	                        const deleteResult = await deleteReply(newsIndex, commentId, replyId);
	                        if (deleteResult) {
	                            // ç«‹å³åˆ·æ–°è¯„è®ºåŒº
	                            renderCommentArea(newsIndex);
	                        } else {
	                            alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	                        }
	                    });
	                });
	
	                
	                // ç»„è£…è¯„è®ºé¡¹
	                commentItem.appendChild(commentHeader);
	                commentItem.appendChild(commentContent);
	                commentItem.appendChild(replyToggleBtn);
	                commentItem.appendChild(replyListContainer);
	                commentList.appendChild(commentItem);
	            });
	        }
	    });
	    
	    commentArea.appendChild(commentWrap);
	}
	// è¾…åŠ©å‡½æ•°ï¼šåˆ›å»ºå•ä¸ªè¯„è®ºå…ƒç´ ï¼ˆé¿å…é‡å¤ä»£ç ï¼‰
	function createCommentElement(comment) {
	    const commentItem = document.createElement('div');
	    commentItem.className = 'comment-item';
	    // æ ‡è®°æ˜¯å¦æ˜¯è‡ªå·±çš„è¯„è®º
	    const commentOpenId = comment.openid || "";
	    const userOpenId = userInfo.openid || userInfo.account || "";
	    if (commentOpenId && userOpenId && commentOpenId === userOpenId) {
	        commentItem.classList.add('own-comment');
	    }
	    
	    // è¯„è®ºå¤´éƒ¨
	    const commentHeader = document.createElement('div');
	    commentHeader.className = 'comment-user-info';
	    commentHeader.innerHTML = `
	        <img src="${comment.avatar || DEFAULT_AVATAR}" alt="å¤´åƒ" class="comment-user-avatar">
	        <span class="comment-user-name">${comment.nickname}</span>
	        <span class="comment-time">${formatTime(comment.time)}</span>
	        <button class="comment-reply-btn" style="margin-left: 10px; padding: 2px 8px; font-size: 12px; background: transparent; border: 1px solid var(--color-green); color: var(--color-green); border-radius: 4px; cursor: pointer; transition: all 0.2s ease;">
	            å›å¤
	        </button>
	        <button class="comment-delete-btn ${(currentUser?.isAdmin ? 'admin-visible' : '')}" data-comment-id="${comment.time}" data-openid="${comment.openid || ''}">åˆ é™¤</button>
	    `;
	    
	    // è¯„è®ºå†…å®¹
	    const commentContent = document.createElement('div');
	    commentContent.className = 'comment-content';
	    commentContent.textContent = comment.content;
	    
	    // å›å¤æ•°é‡å’Œå±•å¼€/æ”¶èµ·æŒ‰é’®
	    const replyCount = comment.replies ? comment.replies.length : 0;
	    const replyToggleBtn = document.createElement('button');
	    replyToggleBtn.className = 'reply-toggle-btn';
	    replyToggleBtn.innerHTML = replyCount > 0 
	        ? `â–¼ æŸ¥çœ‹${replyCount}æ¡å›å¤` 
	        : 'æš‚æ— å›å¤';
	    replyToggleBtn.disabled = replyCount === 0;
	    
	    // å›å¤åˆ—è¡¨å®¹å™¨
	    const replyListContainer = document.createElement('div');
	    replyListContainer.className = 'reply-list-container';
	    
	    // æ¸²æŸ“å›å¤
	    if (comment.replies && comment.replies.length > 0) {
	        comment.replies.forEach(reply => {
	            const replyItem = document.createElement('div');
	            const isOwnReply = reply.openid && userInfo.openid && reply.openid === userInfo.openid;
	            replyItem.className = `comment-item reply-item ${isOwnReply ? 'own-reply' : ''}`;
	            replyItem.style.padding = '10px';
	            replyItem.style.marginBottom = '8px';
	            replyItem.style.backgroundColor = 'rgba(56, 161, 105, 0.05)';
	            
	            const replyHeader = document.createElement('div');
	            replyHeader.className = 'comment-user-info';
	            replyHeader.style.marginBottom = '4px';
	            const deleteBtnHtml = isOwnReply || currentUser?.isAdmin ? 
	                `<button class="reply-delete-btn ${(currentUser?.isAdmin ? 'admin-visible' : '')}" data-comment-id="${comment.time}" data-reply-id="${reply.time}" data-openid="${reply.openid || ''}">åˆ é™¤</button>` : '';
	            
	            replyHeader.innerHTML = `
	                <img src="${reply.avatar || DEFAULT_AVATAR}" alt="å¤´åƒ" class="comment-user-avatar" style="width: 24px; height: 24px;">
	                <span class="comment-user-name" style="font-size: 13px;">${reply.nickname}</span>
	                <span style="font-size: 12px; color: var(--color-text-sub);">
	                    @${reply.replyTo?.nickname || 'æœªçŸ¥ç”¨æˆ·'}
	                </span>
	                <span class="comment-time" style="font-size: 11px;">${formatTime(reply.time)}</span>
	                ${deleteBtnHtml}
	            `;
	            
	            const replyContent = document.createElement('div');
	            replyContent.className = 'comment-content';
	            replyContent.style.paddingLeft = '30px';
	            replyContent.style.fontSize = '14px';
	            replyContent.textContent = reply.content;
	            
	            replyItem.appendChild(replyHeader);
	            replyItem.appendChild(replyContent);
	            replyListContainer.appendChild(replyItem);
	        });
	    }
	    
	    // ç»‘å®šå›å¤æŒ‰é’®äº‹ä»¶
	    const replyBtn = commentHeader.querySelector('.comment-reply-btn');
	    replyBtn.addEventListener('click', () => {
	        isReplying = true;
	        replyToId = comment.time.toString();
	        replyToNickname = comment.nickname;
	        replyInput.placeholder = `å›å¤ ${comment.nickname}...`;
	        replyInputBox.style.display = 'flex';
	        replyInput.focus();
	    });
	    
	    // ç»‘å®šåˆ é™¤äº‹ä»¶
	    const deleteBtn = commentHeader.querySelector('.comment-delete-btn');
	    if (deleteBtn) {
	        deleteBtn.addEventListener('click', async (e) => {
	            e.stopPropagation();
	            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è¯„è®ºå—ï¼Ÿåˆ é™¤åæ‰€æœ‰å›å¤ä¹Ÿä¼šè¢«åˆ é™¤ã€‚')) return;
	            const deleteResult = await deleteComment(newsIndex, comment.time);
	            if (deleteResult) {
	                commentItem.remove();
	            } else {
	                alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	            }
	        });
	    }
	    
	    // ç»‘å®šå›å¤åˆ é™¤äº‹ä»¶
	    const replyDeleteBtns = replyListContainer.querySelectorAll('.reply-delete-btn');
	    replyDeleteBtns.forEach(btn => {
	        btn.addEventListener('click', async (e) => {
	            e.stopPropagation();
	            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å›å¤å—ï¼Ÿ')) return;
	            const commentId = btn.dataset.commentId;
	            const replyId = btn.dataset.replyId;
	            const deleteResult = await deleteReply(newsIndex, commentId, replyId);
	            if (deleteResult) {
	                btn.closest('.reply-item').remove();
	            } else {
	                alert("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
	            }
	        });
	    });
	    
	    // å±•å¼€/æ”¶èµ·å›å¤
	    replyToggleBtn.addEventListener('click', () => {
	        replyListContainer.classList.toggle('expanded');
	        replyToggleBtn.innerHTML = replyListContainer.classList.contains('expanded')
	            ? `â–² æ”¶èµ·å›å¤`
	            : `â–¼ æŸ¥çœ‹${replyCount}æ¡å›å¤`;
	    });
	    
	    // ç»„è£…è¯„è®ºé¡¹
	    commentItem.appendChild(commentHeader);
	    commentItem.appendChild(commentContent);
	    commentItem.appendChild(replyToggleBtn);
	    commentItem.appendChild(replyListContainer);
	    
	    return commentItem;
	}
	
	// æ–°å¢ï¼šæ‰“å¼€ç™»å½•é¡µé¢å‡½æ•°
	function openLoginModal() {
	    window.location.href = 'moguone/login.html';
	}
	
	// âœ…âœ…âœ… é‡å†™ï¼šåŸcreateCommentAreaå‡½æ•°ï¼Œæ”¹ä¸ºç©ºå‡½æ•°ï¼ˆå…¼å®¹åŸæœ‰è°ƒç”¨ï¼Œæ— å®é™…ä½œç”¨ï¼‰
	function createCommentArea(newsItem, index) {}
	// ======== æ ¸å¿ƒé…ç½®ï¼šæŒ‡å®š Issue ç¼–å·ï¼ˆæ”¹æˆä½ è‡ªå·±çš„ï¼Œæ¯”å¦‚ 7ï¼‰ ========
	// æ— æ•Œç‰ˆï¼šæ•°ç»„+æ‹†åˆ†ï¼ŒGitHub è¿é—¨éƒ½æ‘¸ä¸åˆ°ï¼Œäººå·¥çœ‹éƒ½è¦æ‹¼æ¥æ‰èƒ½çœ‹åˆ°å®Œæ•´ä»¤ç‰Œ
	
	// å¯†ç åŠ å¯†ï¼ˆMD5ï¼Œé¿å…æ˜æ–‡å­˜å‚¨ï¼‰
	initLoginState();
	function md5(str) {
	    let hash = 0;
	    if (str.length === 0) return hash.toString();
	    for (let i = 0; i < str.length; i++) {
	        const char = str.charCodeAt(i);
	        hash = ((hash << 5) - hash) + char;
	        hash = hash & hash; // è½¬æ¢ä¸º32ä½æ•´æ•°
	    }
	    return hash.toString(16);
	}
	function initNewsLikeCounts() {
	    // ä»æœ¬åœ°ç¼“å­˜åŠ è½½ç‚¹èµæ•°
	    const localData = JSON.parse(localStorage.getItem('temp_count_all')) || { total: 0, likes: {} };
	    newsLikeCounts = localData.likes || {};
	    
	    // åˆå§‹åŒ–æœªå®šä¹‰çš„ç‚¹èµæ•°ä¸º0
	    if (newsDataList.length > 0) {
	        newsDataList.forEach((_, index) => {
	            if (typeof newsLikeCounts[index] === 'undefined') {
	                newsLikeCounts[index] = 0;
	            }
	        });
	    }
	    // ç«‹å³æ¸²æŸ“ä¸€æ¬¡
	    renderNewsLikeCounts();
	}
	const LIKED_NEWS_KEY = 'liked_news_ids'; // æœ¬åœ°å­˜å‚¨ï¼šç”¨æˆ·å·²ç‚¹èµçš„æ–°é—»IDï¼Œé˜²é‡å¤ç‚¹èµ
	// ================================================================
    // âœ…âœ…âœ… ä¿®å¤æ ¸å¿ƒ1ï¼šä¼˜å…ˆåˆå§‹åŒ–æœ¬åœ°å£çº¸ç¼“å­˜ï¼Œä¿è¯åˆ·æ–°ä¸ä¸¢å¤±ã€æœ€ç»ˆä¿®å¤ç‰ˆã€‘
    function initCustomBg() {
        try {
            const saveCustomBg = localStorage.getItem(BG_CUSTOM_KEY);
            // è¯»å–æœ¬åœ°ç¼“å­˜+å®¹é”™ï¼Œä¸ä¼šæ¸…ç©ºåŸæœ‰å£çº¸
            customBgList = saveCustomBg ? JSON.parse(saveCustomBg) : [];
            // åˆå§‹åŒ–å°±æ‹¼æ¥å®Œæ•´åˆ—è¡¨ï¼Œä¿è¯ä»»ä½•æ—¶å€™éƒ½èƒ½è¯»åˆ°è‡ªå®šä¹‰å£çº¸
            allBgList = [...bgUrlList, ...customBgList];
        } catch (e) {
            console.log('è¯»å–è‡ªå®šä¹‰å£çº¸ç¼“å­˜å®¹é”™', e);
            customBgList = [];
            allBgList = [...bgUrlList];
            localStorage.setItem(BG_CUSTOM_KEY, JSON.stringify([]));
        }
    }

    // âœ…âœ…âœ… æ ¸å¿ƒä¿®æ”¹ï¼šæ¸²æŸ“å£çº¸åˆ—è¡¨ï¼Œæ”¯æŒã€æˆ‘çš„å£çº¸/å®˜æ–¹å£çº¸ã€‘åˆ†ç±»æ¸²æŸ“
    function renderBgThumbnails(renderList) {
        const bgThumbList = document.getElementById('bgThumbList');
        bgThumbList.innerHTML = '';
        const saveBgIndex = Number(localStorage.getItem(BG_INDEX_KEY)) || 0;
        // åŒºåˆ†æ˜¯å®˜æ–¹å£çº¸è¿˜æ˜¯æˆ‘çš„å£çº¸ï¼Œç”Ÿæˆå¯¹åº”çš„ç´¢å¼•
        renderList.forEach((bgUrl, showIndex) => {
            let realIndex = 0;
            if(currentBgTab === 'custom'){
                realIndex = bgUrlList.length + showIndex; // æˆ‘çš„å£çº¸çš„çœŸå®ç´¢å¼•
            }else{
                realIndex = showIndex; // å®˜æ–¹å£çº¸çš„çœŸå®ç´¢å¼•
            }
            const isBuiltIn = currentBgTab === 'official';
            const item = document.createElement('div');
            item.className = `bg-thumb-item ${realIndex == saveBgIndex ? 'active' : ''}`;
            item.innerHTML = `
                <img src="${bgUrl}" alt="å£çº¸${showIndex+1}" style="width:100%;height:100%;object-fit:cover;">
                ${!isBuiltIn ? '<div class="bg-thumb-del" data-index="'+showIndex+'">âœ•</div>' : ''}
            `;
            // ç‚¹å‡»å£çº¸åº”ç”¨èƒŒæ™¯
            item.addEventListener('click', () => {
                applyBg(bgUrl, realIndex);
                document.querySelectorAll('.bg-thumb-item').forEach(el => el.classList.remove('active'));
                item.classList.add('active');
            });
            bgThumbList.appendChild(item);
        });
        document.querySelectorAll('.bg-thumb-del').forEach(delBtn => {
            delBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                const delIndex = parseInt(delBtn.dataset.index);
                if(delIndex >=0 && delIndex < customBgList.length){
                    customBgList.splice(delIndex, 1);
                    // 1. æ°¸ä¹…ä¿å­˜åˆ é™¤åçš„åˆ—è¡¨ï¼Œåˆ·æ–°ä¸ä¸¢
                    localStorage.setItem(BG_CUSTOM_KEY, JSON.stringify(customBgList));
                    // 2. åŒæ­¥å…¨å±€åˆ—è¡¨ï¼Œé˜²æ­¢ç´¢å¼•é”™ä½
                    allBgList = [...bgUrlList, ...customBgList];
                    // 3. é‡æ–°æ¸²æŸ“åˆ—è¡¨
                    renderBgThumbnails(customBgList);
                }
            });
        });
        // æ‰“å¼€å¼¹çª—å¼ºåˆ¶æ»šåŠ¨åˆ°é¡¶éƒ¨
        bgThumbList.scrollTop = 0;
    }

    // åº”ç”¨å£çº¸+æ°¸ä¹…ä¿å­˜ç´¢å¼•ï¼Œé€‰ä¸­å³æ°¸ä¹…ç”Ÿæ•ˆ
    function applyBg(bgUrl, index) {
        document.body.style.background = `url(${bgUrl}) no-repeat fixed center center`;
        document.body.style.backgroundSize = "cover";
        document.body.style.backgroundAttachment = "fixed";
        document.body.style.backgroundPosition = "center center";
        document.body.style.transition = "background 1.5s ease-in-out";
        // â˜…â˜…â˜… å¼ºåˆ¶å†™å…¥æœ¬åœ°å­˜å‚¨ï¼Œæ°¸ä¹…ä¿å­˜ï¼Œåˆ·æ–°ä¸ä¸¢
        localStorage.setItem(BG_INDEX_KEY, index);
        // â˜…â˜…â˜… åŒæ­¥æ›´æ–°å…¨å±€åˆ—è¡¨ï¼Œé˜²æ­¢ç´¢å¼•é”™ä½
        allBgList = [...bgUrlList, ...customBgList];
    }

function openBgModal() {
    document.getElementById('bgModalMask').classList.add('show');
    document.body.style.overflow = 'hidden';
    // âœ… æ ¸å¿ƒä¼˜åŒ–ï¼šé»˜è®¤é€‰ä¸­ã€æˆ‘çš„å£çº¸ã€‘ï¼Œåªæ¸²æŸ“è‡ªå®šä¹‰å£çº¸ï¼Œç§’å¼€ä¸å¡é¡¿
    currentBgTab = 'custom';
    document.getElementById('customBgTab').classList.add('active');
    document.getElementById('officialBgTab').classList.remove('active');
    renderBgThumbnails(customBgList);
    // âœ… å¼ºåˆ¶æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼Œæ‰“å¼€å¼¹çª—å°±çœ‹åˆ°ç¬¬ä¸€è¡Œå£çº¸
    document.querySelector('#bgThumbList').scrollTop = 0;
    // ========== æ–°å¢ï¼šå¼ºåˆ¶é«˜äº®é€‰ä¸­çš„å£çº¸ã€ä¿®å¤é«˜äº®å¤±æ•ˆBUGã€‘ ==========
    setTimeout(()=>{
        const saveBgIndex = Number(localStorage.getItem(BG_INDEX_KEY)) || 0;
        document.querySelectorAll('.bg-thumb-item').forEach((el,index) => {
            let realIndex = currentBgTab === 'custom' ? (bgUrlList.length + index) : index;
            if(realIndex === saveBgIndex) {
                el.classList.add('active');
            } else {
                el.classList.remove('active');
            }
        });
    },100);
}
	function closeBgModal() {
	    document.getElementById('bgModalMask').classList.remove('show');
	    document.body.style.overflow = 'auto';
	}

    // âœ…âœ…âœ… ä¿®å¤æ ¸å¿ƒ5ï¼šè‡ªå®šä¹‰å£çº¸æ·»åŠ +æ°¸ä¹…ä¿å­˜ï¼Œæ— ä¸¢å¤±ã€å®Œç¾ä¿®å¤ï¼šæ·»åŠ åå¼‚æ­¥å³æ—¶æ˜¾ç¤ºã€æ»šåŠ¨åˆ°åº•éƒ¨ã€ç«‹å³é«˜äº®ã€‘
    function initAddBgFunc() {
        const addBgBtn = document.getElementById('addBgBtn');
        const bgFileInput = document.getElementById('bgFileInput');
        addBgBtn.addEventListener('click', () => bgFileInput.click());
        bgFileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if(!file) return;
            // è¿‡æ»¤éå›¾ç‰‡æ–‡ä»¶
            if(!file.type.includes('image')){
                alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼æ”¯æŒJPG/PNG/WEBP');
                bgFileInput.value = '';
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                const base64Url = e.target.result;
                customBgList.push(base64Url);
                // 1. æ°¸ä¹…ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜ï¼Œåˆ·æ–°ä¸ä¸¢
                localStorage.setItem(BG_CUSTOM_KEY, JSON.stringify(customBgList));
                // 2. åŒæ­¥å…¨å±€å£çº¸åˆ—è¡¨ï¼Œé˜²æ­¢ç´¢å¼•é”™ä½
                allBgList = [...bgUrlList, ...customBgList];
                // 3. åˆ‡æ¢å›ã€æˆ‘çš„å£çº¸ã€‘åˆ†ç±»ï¼Œå›ºå®šæ˜¾ç¤º
                currentBgTab = 'custom';
                document.getElementById('customBgTab').classList.add('active');
                document.getElementById('officialBgTab').classList.remove('active');
                // 4. é‡æ–°æ¸²æŸ“å£çº¸åˆ—è¡¨ â†’ å¼‚æ­¥å³æ—¶æ˜¾ç¤ºæ–°å£çº¸ âœ…æ ¸å¿ƒä¿®å¤
                renderBgThumbnails(customBgList);
                // 5. âœ…æ ¸å¿ƒæ–°å¢ï¼šæ·»åŠ åè‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œç›´æ¥çœ‹åˆ°æ–°å¢çš„å£çº¸ï¼Œä¸ç”¨æ‰‹åŠ¨æ»‘
                const bgThumbList = document.getElementById('bgThumbList');
                bgThumbList.scrollTop = bgThumbList.scrollHeight;
                // 6. æ¸…ç©ºæ–‡ä»¶é€‰æ‹©å™¨ï¼Œå¯é‡å¤é€‰æ‹©åŒä¸€å¼ å›¾ç‰‡æ·»åŠ 
                bgFileInput.value = '';
            };
            reader.readAsDataURL(file);
        });
    }
	// âœ…âœ…âœ… æ–°å¢ï¼šå£çº¸åˆ†ç±»åˆ‡æ¢æŒ‰é’®ç»‘å®šäº‹ä»¶
	function initBgTabSwitch() {
	    const customTab = document.getElementById('customBgTab');
	    const officialTab = document.getElementById('officialBgTab');
	    // åˆ‡æ¢åˆ°ã€æˆ‘çš„å£çº¸ã€‘
	    customTab.addEventListener('click', () => {
	        currentBgTab = 'custom';
	        customTab.classList.add('active');
	        officialTab.classList.remove('active');
	        renderBgThumbnails(customBgList); // åªæ¸²æŸ“è‡ªå®šä¹‰å£çº¸
	    });
	    // åˆ‡æ¢åˆ°ã€å®˜æ–¹å£çº¸ã€‘
	    officialTab.addEventListener('click', () => {
	        currentBgTab = 'official';
	        officialTab.classList.add('active');
	        customTab.classList.remove('active');
	        renderBgThumbnails(bgUrlList); // æ¸²æŸ“å®˜æ–¹å£çº¸
	    });
	}
	// åˆå§‹åŒ–åˆ†ç±»åˆ‡æ¢
	initBgTabSwitch();

// åˆå§‹åŒ–èƒŒæ™¯ã€è¯»å–ä¸Šæ¬¡ä¿å­˜çš„å£çº¸+å†…ç½®å£çº¸ã€‘ã€å½»åº•ä¿®å¤åˆ·æ–°ä¸¢å¤±ï¼Œæ°¸ä¹…ä¿å­˜ã€‘ã€å·²ä¿®å¤æ ¸å¿ƒBUGã€‘
async function initRandomBg() {
    try {
        const res = await fetch('moguone/background.txt');
        const bgText = await res.text();
        bgUrlList = bgText.replace(/\r\n/g, '\n').split('\n').map(line => line.trim()).filter(line => line);
    } catch (err) { 
        console.log('èƒŒæ™¯åˆ—è¡¨åŠ è½½å¤±è´¥', err); 
        bgUrlList = []; 
    }
    // ========== æ ¸å¿ƒä¿®å¤ï¼šå¼‚æ­¥åŠ è½½å®˜æ–¹å£çº¸åï¼Œå¼ºåˆ¶é‡æ–°è¯»å–æœ¬åœ°ç¼“å­˜+åŒæ­¥è‡ªå®šä¹‰å£çº¸ ==========
    const saveCustomBg = localStorage.getItem(BG_CUSTOM_KEY);
    customBgList = saveCustomBg ? JSON.parse(saveCustomBg) : [];
    // â˜…â˜…â˜… å¼ºåˆ¶æ‹¼æ¥ï¼šå†…ç½®å£çº¸ + è‡ªå®šä¹‰å£çº¸ï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼Œæ°¸ä¸ä¸¢å¤±ï¼Œåˆ·æ–°å¿…åœ¨
    allBgList = [...bgUrlList, ...customBgList];
    // â˜…â˜…â˜… å¼ºåˆ¶è¯»å–æœ¬åœ°ä¿å­˜çš„å£çº¸ç´¢å¼•ï¼Œå½»åº•å®¹é”™ï¼Œä¸ä¼šä¸ºç©ºã€ä¸ä¼šè¶Šç•Œ
    let saveBgIndex = localStorage.getItem(BG_INDEX_KEY);
    let useBgIndex = 0;
    // å®¹é”™å¤„ç†ï¼šå¦‚æœè¯»å–åˆ°ç´¢å¼•ã€ä¸æ˜¯ç©ºã€æ˜¯æ•°å­—ã€åœ¨åˆæ³•èŒƒå›´å†…ï¼Œå°±ç”¨è¿™ä¸ªç´¢å¼•
    if(saveBgIndex !== null && saveBgIndex !== '' && !isNaN(saveBgIndex)){
        useBgIndex = parseInt(saveBgIndex);
        if(useBgIndex <0 || useBgIndex >= allBgList.length){
            useBgIndex = allBgList.length - 1 < 0 ? 0 : allBgList.length -1;
        }
    }
    // â˜…â˜…â˜… åº”ç”¨å£çº¸ + å›ºåŒ–æ ·å¼ï¼Œæ°¸ä¸é”™ä½ã€æ°¸ä¸ç©ºç™½ã€ç«‹å³ç”Ÿæ•ˆ
    const useBg = allBgList[useBgIndex] || "";
    if(useBg){
        document.body.style.background = `url(${useBg}) no-repeat fixed center center`;
        document.body.style.backgroundSize = "cover";
        document.body.style.backgroundAttachment = "fixed";
        document.body.style.backgroundPosition = "center center";
    }else{
        document.body.style.background = "#151823";
    }
    document.body.style.transition = "background 1.5s ease-in-out";
}

	function changeRandomBg() {
	    openBgModal();
	}

	// å¯¼èˆªé“¾æ¥ç‚¹å‡»å¤„ç†
	const navLinks = document.querySelectorAll('.main-nav-link');
	navLinks.forEach(link => {
	    link.addEventListener('click', function(e) {
	        if (this.classList.contains('active')) return;
	        e.preventDefault();
	        const targetHref = this.getAttribute('href');
	        if (isAnimating || !targetHref) return;
	        
	        isAnimating = true;
	        const loader = document.getElementById('loader');
	        loader.classList.remove('loaded');
	        document.body.style.overflow = 'hidden';
	        
	        if (window.saveMusicState) saveMusicState();
	        
	        setTimeout(() => {
	            window.location.href = targetHref;
	            isAnimating = false;
	        }, 600);
	        
	        setTimeout(() => isAnimating = false, 1000);
	    });
	});



	// å›¾ç‰‡æ‡’åŠ è½½
	function initLazyImgLoad() {
	    const lazyElements = document.querySelectorAll('img[data-src]');
	    
	    if (!imgObserver) {
	        imgObserver = new IntersectionObserver((entries) => {
	            entries.forEach(entry => {
	                if (entry.isIntersecting) {
	                    const el = entry.target;
	                    el.src = el.dataset.src;
	                    el.onload = () => { el.classList.add('loaded'); };
	                    imgObserver.unobserve(el);
	                }
	            });
	        }, { rootMargin: '0px 0px 150px 0px', threshold: 0.1 });
	    }
	    
	    lazyElements.forEach(el => {
	        if (!el.classList.contains('loaded')) imgObserver.observe(el);
	    });
	}

	// è§†é¢‘æ‚¬æµ®é¢„è§ˆ
	function initVideoHoverPreview() {
	    const videos = document.querySelectorAll('video[data-src]');
	    
	    if (!videoObserver) {
	        videoObserver = new IntersectionObserver((entries) => {
	            entries.forEach(entry => {
	                if (entry.isIntersecting) {
	                    const video = entry.target;
	                    video.src = video.dataset.src;
	                    video.muted = true;
	                    video.loop = false;
	                    video.load();
	                    video.classList.add('loaded');
	                    video.onloadeddata = function() { video.play(); }
	                    video.ontimeupdate = function() {
	                        if (video.currentTime >=3) {video.currentTime=0;video.play();}
	                    }
	                    videoObserver.unobserve(video);
	                }
	            });
	        }, { rootMargin: '0px 0px 200px 0px', threshold:0.1 });
	    }
	    
	    videos.forEach(video => {
	        if (!video.classList.contains('loaded')) videoObserver.observe(video);
	    });
	}

	// âœ…âœ…âœ… ä¿®å¤ç‰ˆï¼šè®¿é—®é‡ç»Ÿè®¡æ ¸å¿ƒå‡½æ•°ï¼ˆæ— é‡å¤å®šä¹‰+å®¹é”™æ›´å¼º+å¿…æ˜¾ç¤ºæ•°å­—ï¼‰
	// ========== è®¿é—®é‡æ•°å­—æ ¼å¼åŒ–ï¼ˆä¸å˜ï¼Œå’Œä½ åŸæ¥çš„ä¸€æ ·ï¼‰ ==========
	function formatVisitCount(num) {
	    if (num >= 1000) {
	        return (num / 1000).toFixed(2) + 'K';
	    } else {
	        return num;
	    }
	}
	// ========== å…¨å±€å®šæ—¶å™¨ï¼šæ§åˆ¶æ•°å­—ä¹±è·³/åœæ­¢ ==========
	let randomJumpTimer = null;
	// ========== âœ…æ ¸å¿ƒä¿®æ”¹ï¼šé¡µé¢ä¸€åŠ è½½ ç«‹åˆ»éšæœºä¹±è·³ã€æ— å»¶è¿Ÿã€æ— å¹³æ»‘ã€çº¯é—ªçƒã€‘ ==========
	function startRandomJump(element) {
	    randomJumpTimer = setInterval(() => {
	        const randomNum = Math.floor(Math.random() * 1000); // â˜…æ”¹è¿™é‡Œï¼š0-999ä¹±è·³ï¼Œæ”¹10000å°±æ˜¯0-9999
	        element.innerText = formatVisitCount(randomNum);
	    }, 40); // â˜…æ”¹è¿™é‡Œï¼šä¹±è·³é€Ÿåº¦ï¼Œæ•°å­—è¶Šå°è¶Šå¿«ï¼Œ40æ˜¯æœ€å¿«çš„æ•ˆæœ
	}
	// ========== âœ…æ ¸å¿ƒä¿®æ”¹ï¼šæ‹¿åˆ°çœŸå®æ•°å­— ç«‹åˆ»åœæ­¢ä¹±è·³ ==========
	function stopRandomJump() {
	    if (randomJumpTimer) {
	        clearInterval(randomJumpTimer);
	        randomJumpTimer = null;
	    }
	}
	// âœ…âœ…âœ… å‡çº§ç‰ˆï¼šè®¿é—®é‡ç»Ÿè®¡æ ¸å¿ƒå‡½æ•° - å…¼å®¹ã€Œæ€»è®¿é—®é‡ã€+ã€Œæ‰€æœ‰æ–°é—»ç‹¬ç«‹æµè§ˆé‡ã€+ã€Œæ‰€æœ‰æ–°é—»ç‹¬ç«‹ç‚¹èµé‡ã€
	// æ€»è®¿é—®é‡ã€æµè§ˆé‡ã€ç‚¹èµé‡ å…±å­˜äºåŒä¸€ä¸ªIssue #7ï¼Œæ•°æ®äº’ä¸æ··æ·†ï¼Œé›¶å†²çª
	async function initVisitCount() {
	    // ===== æ‰“å¼€é¡µé¢ã€ç«‹åˆ»å¼€å§‹ä¹±è·³ã€‘ï¼Œä¸€ç§’éƒ½ä¸å»¶è¿Ÿ =====
	    const totalCountEl = document.getElementById('totalCount');
	    startRandomJump(totalCountEl);
	
	    const requestHeaders = {
	        "Authorization": `token ${GITHUB_TOKEN}`,
	        "Accept": "application/vnd.github.v3+json",
	        "User-Agent": "Mozilla/5.0"
	    };
	
	    try {
	        const issueRes = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${COUNT_ISSUE_NUMBER}`,
	            { headers: requestHeaders, method: "GET" }
	        );
	
	        if (!issueRes.ok) {
	            throw new Error(`Issue #${COUNT_ISSUE_NUMBER} ä¸å­˜åœ¨`);
	        }
	
	        const countIssue = await issueRes.json();
	        let currentCount = 0;
	        // 1. è¯»å–æ€»è®¿é—®é‡
	        const match = countIssue.body.match(COUNT_REG);
	        if (match) {
	            currentCount = parseInt(match[1]);
	        }
	        currentCount += 1;
	
	        // 2. è¯»å–æ‰€æœ‰æ–°é—»çš„æµè§ˆé‡
	        const newsMatches = countIssue.body.matchAll(NEWS_VIEW_REG);
	        for (const m of newsMatches) {
	            const newsIndex = parseInt(m[1]);
	            const viewCount = parseInt(m[2]);
	        }
	        
	        // ========== æ–°å¢ â†“â†“â†“ è¯»å–æ‰€æœ‰æ–°é—»çš„ç‚¹èµé‡ ==========
	        newsLikeCounts = {};
	        const likeMatches = countIssue.body.matchAll(NEWS_LIKE_REG);
	        for (const m of likeMatches) {
	            const newsIndex = parseInt(m[1]);
	            const likeCount = parseInt(m[2]);
	            newsLikeCounts[newsIndex] = likeCount;
	        }
	
	        // 3. é‡æ–°æ‹¼æ¥Issueå†…å®¹ï¼šæ€»è®¿é—®é‡ + æ‰€æœ‰æ–°é—»æµè§ˆé‡ + æ‰€æœ‰æ–°é—»ç‚¹èµé‡
	        let newIssueBody = `æ€»è®¿é—®é‡ï¼š${currentCount}\n`;
	        // ========== æ–°å¢ â†“â†“â†“ æ‹¼æ¥ç‚¹èµé‡åˆ°Issue ==========
	        for (const key in newsLikeCounts) {
	            newIssueBody += `${NEWS_LIKE_PREFIX}${key}${NEWS_LIKE_SUFFIX}${newsLikeCounts[key]}\n`;
	        }
	
	        // 4. æ›´æ–°Issueï¼ˆæ€»è®¿é—®é‡+1ï¼Œæ–°é—»æµè§ˆé‡/ç‚¹èµé‡åŸæ ·ä¿å­˜ï¼‰
	        await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${COUNT_ISSUE_NUMBER}`,
	            {
	                headers: requestHeaders,
	                method: "PATCH",
	                body: JSON.stringify({ body: newIssueBody.trim() })
	            }
	        );
	        // ===== æ‹¿åˆ°çœŸå®æ•°å­—ï¼šç«‹åˆ»åœæ­¢ä¹±è·³ + ç¬é—´æ˜¾ç¤ºçœŸå®æ•° =====
	        stopRandomJump();
	        totalCountEl.innerText = formatVisitCount(currentCount);
	        // ========== ä¿®æ”¹ â†“â†“â†“ æœ¬åœ°ç¼“å­˜å¢åŠ ç‚¹èµé‡ ==========
	        localStorage.setItem('temp_count_all', JSON.stringify({ total: currentCount, likes: newsLikeCounts }));
	        // åŠ è½½å®Œæˆåï¼Œæ¸²æŸ“æ‰€æœ‰æ–°é—»çš„æµè§ˆé‡+ç‚¹èµé‡æ•°å­—
	        renderNewsLikeCounts(); // æ–°å¢ï¼šæ¸²æŸ“ç‚¹èµæ•°
	
	    } catch (err) {
	        console.log('ç»Ÿè®¡å®¹é”™ï¼š', err);
	        let localData = JSON.parse(localStorage.getItem('temp_count_all')) || { total: 0, news: {}, likes: {} };
	        localData.total += 1;
	        newsLikeCounts = localData.likes || {}; // æ–°å¢ï¼šè¯»å–ç¼“å­˜ç‚¹èµæ•°
	        localStorage.setItem('temp_count_all', JSON.stringify(localData));
	        // ===== åŠ è½½å¤±è´¥ä¹Ÿåœæ­¢ä¹±è·³ + æ˜¾ç¤ºç¼“å­˜æ•° =====
	        stopRandomJump();
	        totalCountEl.innerText = formatVisitCount(localData.total);
	        // æ¸²æŸ“æœ¬åœ°ç¼“å­˜çš„æ–°é—»æµè§ˆé‡+ç‚¹èµé‡
	        renderNewsLikeCounts(); // æ–°å¢ï¼šæ¸²æŸ“ç‚¹èµæ•°
	    }
	}
	
	// âœ…âœ…âœ… æ–°å¢å‡½æ•°ï¼šæ¸²æŸ“æ‰€æœ‰æ–°é—»çš„æµè§ˆé‡æ•°å­—åˆ°é¡µé¢ä¸Š

	// âœ…âœ…âœ… æ–°å¢å‡½æ•°ï¼šæ¸²æŸ“æ‰€æœ‰æ–°é—»çš„ç‚¹èµé‡æ•°å­—åˆ°é¡µé¢ä¸Š
	function renderNewsLikeCounts() {
	    // æ¸²æŸ“åˆ—è¡¨ä¸­çš„ç‚¹èµæ•°
	    const likeElements = document.querySelectorAll('.news-like-count');
	    likeElements.forEach(el => {
	        const index = parseInt(el.dataset.index);
	        const count = newsLikeCounts[index] || 0;
	        el.innerText = formatVisitCount(count);
	    });
	    // æ¸²æŸ“å¼¹çª—ä¸­çš„ç‚¹èµæ•°
	    const modalLikeElements = document.querySelectorAll('.modal-news-like-count');
	    modalLikeElements.forEach(el => {
	        const index = parseInt(el.dataset.index);
	        const count = newsLikeCounts[index] || 0;
	        el.innerText = formatVisitCount(count);
	    });
	    // æ¸²æŸ“å·²ç‚¹èµæ ·å¼
	    renderLikedStyle();
	}
	
	// æ ¸å¿ƒä¼˜åŒ–ï¼šç‚¹èµ - æ— é™åˆ¶ç‚¹èµï¼Œç‚¹å‡»ä¸€æ¬¡åŠ ä¸€æ¬¡
	async function updateNewsLikeCount(index) {
	    // ========== ç§»é™¤æ‰€æœ‰å·²ç‚¹èµæ£€æŸ¥é€»è¾‘ ==========
	    // ç¬¬ä¸€æ­¥ï¼šç«‹å³æ›´æ–°UIï¼ˆæ— éœ€ç­‰å¾…æ¥å£ï¼Œå³æ—¶åé¦ˆï¼‰
	    // ç‚¹èµï¼šæ•°é‡+1ï¼ˆåˆå§‹åŒ–å¦‚æœæœªå®šä¹‰åˆ™è®¾ä¸º0ï¼‰
	    if (typeof newsLikeCounts[index] === 'undefined') {
	        newsLikeCounts[index] = 0;
	    }
	    newsLikeCounts[index] += 1;
	    
	    // å¼ºåˆ¶åŒæ­¥æ‰€æœ‰ç‚¹èµæŒ‰é’®çŠ¶æ€ï¼ˆä¸å†åŒºåˆ†å·²ç‚¹èµ/æœªç‚¹èµï¼‰
	    renderLikedStyle();
	
	    // ========== ç¬¬äºŒæ­¥ï¼šå¼‚æ­¥æ›´æ–°GitHubï¼ˆä¸å½±å“UIå³æ—¶æ€§ï¼‰ ==========
	    const requestHeaders = {
	        "Authorization": `token ${GITHUB_TOKEN}`,
	        "Accept": "application/vnd.github.v3+json",
	        "User-Agent": "Mozilla/5.0"
	    };
	    
	    try {
	        const issueRes = await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${COUNT_ISSUE_NUMBER}`,
	            { headers: requestHeaders, method: "GET" }
	        );
	        if (!issueRes.ok) throw new Error('Issueè¯·æ±‚å¤±è´¥');
	        const countIssue = await issueRes.json();
	
	        // è¯»å–æ€»è®¿é—®é‡
	        let currentTotal = 0;
	        const totalMatch = countIssue.body.match(COUNT_REG);
	        if (totalMatch) currentTotal = parseInt(totalMatch[1]);
	
	        // è¯»å–æ‰€æœ‰ç‚¹èµé‡å¹¶æ›´æ–°
	        const tempNewsLikes = {};
	        const likeMatches = countIssue.body.matchAll(NEWS_LIKE_REG);
	        for (const m of likeMatches) {
	            tempNewsLikes[parseInt(m[1])] = parseInt(m[2]);
	        }
	        // æ›´æ–°å½“å‰æ–°é—»çš„ç‚¹èµæ•°
	        tempNewsLikes[index] = newsLikeCounts[index];
	        newsLikeCounts = tempNewsLikes;
	
	        // é‡æ–°æ‹¼æ¥Issueå†…å®¹
	        let newIssueBody = `æ€»è®¿é—®é‡ï¼š${currentTotal}\n`;
	        for (const key in tempNewsLikes) {
	            newIssueBody += `${NEWS_LIKE_PREFIX}${key}${NEWS_LIKE_SUFFIX}${tempNewsLikes[key]}\n`;
	        }
	        
	        // æäº¤æ›´æ–°
	        await fetch(
	            `https://api.github.com/repos/${GITHUB_REPO}/issues/${COUNT_ISSUE_NUMBER}`,
	            {
	                headers: requestHeaders,
	                method: "PATCH",
	                body: JSON.stringify({ body: newIssueBody.trim() })
	            }
	        );
	        
	        // æ›´æ–°æœ¬åœ°ç¼“å­˜
	        localStorage.setItem('temp_count_all', JSON.stringify({ 
	            total: currentTotal, 
	            likes: newsLikeCounts 
	        }));
	
	    } catch (err) {
	        console.log('æ–°é—»ç‚¹èµé‡å®¹é”™ï¼š', err);
	        // å®¹é”™ï¼šä»…æ›´æ–°æœ¬åœ°ç¼“å­˜ï¼Œä¸å½±å“UI
	        let localData = JSON.parse(localStorage.getItem('temp_count_all')) || { total: 0, likes: {} };
	        localData.likes[index] = newsLikeCounts[index];
	        localStorage.setItem('temp_count_all', JSON.stringify(localData));
	    }
	}
	
	// æ ¸å¿ƒä¿®å¤ï¼šåŒæ­¥æ‰€æœ‰ç‚¹èµæŒ‰é’®çš„çŠ¶æ€ï¼ˆä»…æ›´æ–°æ•°å­—ï¼Œä¸ç§»é™¤å¯ç‚¹å‡»çŠ¶æ€ï¼‰
	function renderLikedStyle() {
	    // åŒæ­¥åˆ—è¡¨ä¸­çš„ç‚¹èµæŒ‰é’®
	    document.querySelectorAll('.news-like-btn').forEach(btn => {
	        const index = parseInt(btn.dataset.index);
	        const count = formatVisitCount(newsLikeCounts[index] || 0);
	        // ä»…æ›´æ–°æ•°å­—ï¼Œä¸æ·»åŠ likedæ ·å¼ï¼ˆæˆ–æ·»åŠ ä½†ä¸å½±å“ç‚¹å‡»ï¼‰
	        btn.innerHTML = `ğŸ‘ <span class="news-like-count" data-index="${index}">${count}</span>`;
	        // å¼ºåˆ¶è§¦å‘UIé‡ç»˜
	        void btn.offsetWidth;
	    });
	    
	    // åŒæ­¥å¼¹çª—ä¸­çš„ç‚¹èµæŒ‰é’®
	    document.querySelectorAll('.modal-news-like-btn').forEach(btn => {
	        const index = parseInt(btn.dataset.index);
	        const count = formatVisitCount(newsLikeCounts[index] || 0);
	        // ä»…æ›´æ–°æ•°å­—ï¼Œä¸æ·»åŠ likedæ ·å¼ï¼ˆæˆ–æ·»åŠ ä½†ä¸å½±å“ç‚¹å‡»ï¼‰
	        btn.innerHTML = `ğŸ‘ <span class="modal-news-like-count" data-index="${index}">${count}</span>`;
	        // å¼ºåˆ¶è§¦å‘UIé‡ç»˜
	        void btn.offsetWidth;
	    });
	}
	function initTheme() {
	    const themeToggle = document.getElementById('themeToggle');
	    const htmlDom = document.documentElement;
	    const savedTheme = localStorage.getItem('theme_mode');
	    if(savedTheme==='light'){
	        htmlDom.setAttribute('data-theme-mode','light');
	        themeToggle.checked = true;
	    } else {
	        htmlDom.setAttribute('data-theme-mode','dark');
	        themeToggle.checked = false;
	    }
	    // åˆ æ‰è¿™è¡Œï¼šupdateUtterancesTheme(); ï¼ˆè¿™ä¸ªå‡½æ•°å·²ç»ä¸å­˜åœ¨äº†ï¼‰
	    
	    themeToggle.addEventListener('change', function() {
	        if(this.checked){
	            htmlDom.setAttribute('data-theme-mode','light');
	            localStorage.setItem('theme_mode','light');
	        } else {
	            htmlDom.setAttribute('data-theme-mode','dark');
	            localStorage.setItem('theme_mode','dark');
	        }
	        // åˆ æ‰è¿™è¡Œï¼šupdateUtterancesTheme();
	    });
	}

function openNewsModal(index) {
    currentModalIndex = index;
    const newsData = newsDataList[index];
    const modalContent = document.getElementById('modalNewsContent');
    let imgHtml = '';
    if(newsData.imgSrcList.length>0||newsData.videoSrcList.length>0) {
        imgHtml = `<div class="modal-news-imgs">`;
        newsData.imgSrcList.forEach(url=>{
            imgHtml+=`<img class="modal-news-img-item" data-src="${url}" alt="${newsData.title}" src="">`;
        });
        newsData.videoSrcList.forEach(url=>{
            imgHtml+=`<video class="modal-news-img-item" tag="video" data-src="${url}" muted playsinline preload="metadata"></video>`;
        });
        imgHtml += `</div>`;
    }
    modalContent.innerHTML = `
        <div class="modal-news-title">${newsData.title}</div>
        <div class="modal-news-desc">${newsData.content}</div>
        ${imgHtml}
        <div class="modal-news-date"><span class="modal-news-like-btn" data-index="${index}">ğŸ‘ <span class="modal-news-like-count" data-index="${index}">${formatVisitCount(newsLikeCounts[index] || 0)}</span></span> | å‘å¸ƒæ—¶é—´ï¼š${newsData.date}</div>
    `;
    // ç¬¬ä¸€æ­¥ï¼šç«‹å³æ¸…ç©ºè¯„è®ºåŒºï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ˆå…³é”®ï¼šé˜²æ­¢æ—§å†…å®¹æ®‹ç•™ï¼‰
    const modalCommentArea = document.getElementById('modalCommentArea');
    modalCommentArea.innerHTML = `
      <div class="apple-loading-comment" style="text-align:center; padding:20px; color:var(--color-green); font-weight:300; letter-spacing:0.5px;">
        <span style="display:inline-flex; align-items:center; gap:8px;">
          Loading
          <span style="display:flex; gap:2px; margin-top:2px;">
            <span style="width:4px; height:4px; border-radius:50%; background:var(--color-green); animation: apple-breathe 1.2s infinite ease-in-out 0s;"></span>
            <span style="width:4px; height:4px; border-radius:50%; background:var(--color-green); animation: apple-breathe 1.2s infinite ease-in-out 0.2s;"></span>
            <span style="width:4px; height:4px; border-radius:50%; background:var(--color-green); animation: apple-breathe 1.2s infinite ease-in-out 0.4s;"></span>
          </span>
        </span>
      </div>
      <style>
        @keyframes apple-breathe {
          0%, 100% { opacity: 0.4; transform: scale(0.9); }
          50% { opacity: 1; transform: scale(1.1); }
        }
        .apple-loading-comment {
          transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
          font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
      </style>
    `;
    
    // ç¬¬äºŒæ­¥ï¼šå¼‚æ­¥è·å–è¯„è®ºå¹¶æ¸²æŸ“ï¼ˆå¢åŠ é˜²é‡å¤æ ‡è®°ï¼‰
    const commentArea = document.getElementById('modalCommentArea');
    if (!commentArea.dataset.loading) {
        commentArea.dataset.loading = 'true';
        getCommentData(index).then(() => {
            // æ‰“å¼€å¼¹çª—æ—¶å¼ºåˆ¶æ¸²æŸ“ç‚¹èµæ•°
            renderNewsLikeCounts();
            renderLikedStyle();
            // ç„¶åå†æ¸²æŸ“è¯„è®ºåŒº
            renderCommentArea(index);
            delete commentArea.dataset.loading;
        });
    }
    renderLikedStyle(); // æ‰“å¼€å¼¹çª—æ—¶ç«‹å³åŒæ­¥ç‚¹èµæ ·å¼
	updateNavBtnStatus();
    const modalMask = document.getElementById('newsModalMask');
    modalMask.classList.add('show');
    scrollTopVal=window.scrollY;
    document.body.style.overflow='hidden';
    setTimeout(()=>{
        initPreviewAnimation();
        initLazyImgLoad();
        initVideoHoverPreview();
        // å¼¹çª—ç‚¹èµæŒ‰é’®ç»‘å®š
        const modalLikeBtn = document.querySelector('.modal-news-like-btn');
        if(modalLikeBtn) {
            modalLikeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                // ç›´æ¥è°ƒç”¨æ ¸å¿ƒå‡½æ•°ï¼Œè‡ªåŠ¨åŒæ­¥UI
                updateNewsLikeCount(index);
            });
        }
    },100);
}

function createModalCommentArea(index) {
    const modalCommentArea = document.getElementById('modalCommentArea');
    modalCommentArea.innerHTML = '';
    const utterContainer = document.createElement('div');
    utterContainer.className='modal-utter-container';
    modalCommentArea.appendChild(utterContainer);
    const utterScript = document.createElement('script');
    utterScript.src='https://utteranc.es/client.js';
    utterScript.setAttribute('repo',GITHUB_REPO);
    utterScript.setAttribute('issue-term',`news_${index}`);
    utterScript.setAttribute('theme',getUtterancesTheme());
    utterScript.setAttribute('crossorigin','anonymous');
    utterScript.setAttribute('async',true);
    utterContainer.appendChild(utterScript);
}

function closeNewsModal() {
    const modalMask = document.getElementById('newsModalMask');
    modalMask.classList.remove('show');
    document.body.style.overflow='auto';
    window.scrollTo(0,scrollTopVal);
    currentModalIndex=-1;
    document.querySelectorAll('.modal-news-img-item[tag=video]').forEach(v=>v.pause());
    // æ–°å¢ï¼šå…³é—­å¼¹çª—æ—¶å½»åº•æ¸…ç©ºè¯„è®ºåŒºï¼Œé˜²æ­¢æ®‹ç•™
    document.getElementById('modalCommentArea').innerHTML = '';
}
// æ—¥è®°åˆ‡æ¢æ ¸å¿ƒå‡½æ•°
function switchNews(direction) {
    if (currentModalIndex === -1 || newsDataList.length === 0) return;
    
    let newIndex = currentModalIndex;
    if (direction === 'prev') {
        newIndex = currentModalIndex - 1;
    } else if (direction === 'next') {
        newIndex = currentModalIndex + 1;
    }
    
    // è¾¹ç•Œæ£€æŸ¥
    if (newIndex < 0 || newIndex >= newsDataList.length) return;
    
    // å…³é—­å½“å‰å¼¹çª—ï¼ˆæ¸…é™¤æ—§å†…å®¹ï¼‰
    closeNewsModal();
    // æ‰“å¼€æ–°æ—¥è®°
    setTimeout(() => {
        openNewsModal(newIndex);
    }, 100);
}

// æ›´æ–°è·³è½¬æŒ‰é’®çŠ¶æ€ï¼ˆæ§åˆ¶æ˜¾ç¤º/éšè—ï¼‰
function updateNavBtnStatus() {
    const prevBtn = document.getElementById('newsPrevBtn');
    const nextBtn = document.getElementById('newsNextBtn');
    
    if (!prevBtn || !nextBtn || currentModalIndex === -1) return;
    
    // ç¬¬ä¸€ä¸ªæ—¥è®°ï¼šç¦ç”¨ä¸ŠæŒ‰é’®
    prevBtn.disabled = currentModalIndex === 0;
    // æœ€åä¸€ä¸ªæ—¥è®°ï¼šç¦ç”¨ä¸‹æŒ‰é’®
    nextBtn.disabled = currentModalIndex === newsDataList.length - 1;
}
// è‡ªå®šä¹‰æç¤ºå¼¹çª—
function showTipModal() {
    const tipMask = document.getElementById('tipModalMask');
    tipMask.classList.add('show');
    document.body.style.overflow = 'hidden';
}

function hideTipModal() {
    const tipMask = document.getElementById('tipModalMask');
    tipMask.classList.remove('show');
    document.body.style.overflow = 'auto';
}

// æ–°é—»åŠ¨ç”» â†’ æ”¹ä¸ºã€æ—¥è®°åŠ¨ç”»ã€‘
function initNewsScrollAnimation() {
    const newsItems = document.querySelectorAll('.news-item');
    if (newsAnimateObserver) {
        newsAnimateObserver.disconnect();
        newsAnimateObserver = null;
    }
    
    newsAnimateObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const newsItem = entry.target;
            if (entry.isIntersecting) {
                newsItem.classList.add('active');
                newsItem.classList.remove('out');
            } else {
                newsItem.classList.add('out');
                newsItem.classList.remove('active');
            }
        });
    }, {
        root: null,
        rootMargin: "0px 0px 100px 0px", // âœ… ä¿®æ”¹è¿™é‡Œå³å¯ï¼Œå…¶ä»–ä¸å˜
        threshold: 0.05
    });
    
    newsItems.forEach(item => {
        newsAnimateObserver.observe(item);
    });
}

// æ¸²æŸ“æ–°é—»åˆ—è¡¨
function renderNewsList(newsList) {
    const newsContainer = document.getElementById('newsScroll');
	// æ˜¾ç¤ºåŠ è½½æç¤º
	showLoadingToast();
    newsContainer.innerHTML = '';
    if(newsList.length === 0) {
        newsContainer.innerHTML = '<div class="search-empty-tips">ğŸ” æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å†…å®¹ï¼Œè¯•è¯•æ¢ä¸ªå…³é”®è¯å§</div>';
        return;
    }
    const resourcesToLoad = [];
    newsList.forEach((newsData) => {
        const originalIndex = newsDataList.indexOf(newsData);
        const item = document.createElement('div');
        item.className='news-item';
        let mediaHtml = '';
        let firstMedia = null;
        if(newsData.imgSrcList.length>0){
            firstMedia={type:'image',url:newsData.imgSrcList[0]};
            mediaHtml = `<img class="news-img-item" data-src="${firstMedia.url}" alt="${newsData.title}" src="">`;
        }else if(newsData.videoSrcList.length>0){
            firstMedia={type:'video',url:newsData.videoSrcList[0]};
            mediaHtml = `<video class="news-video-item" tag="video" data-src="${firstMedia.url}" muted playsinline preload="metadata"></video>`;
        }
        item.innerHTML = `
            <div class="news-text-box">
                <div class="news-title">${newsData.title}</div>
                <div class="news-content">${newsData.content}</div>
                <div class="news-date"><span class="news-like-btn" data-index="${originalIndex}">ğŸ‘ <span class="news-like-count" data-index="${originalIndex}">${formatVisitCount(newsLikeCounts[originalIndex] || 0)}</span></span> | ğŸ“… ${newsData.date}</div>
            </div>
            <div class="news-media-box">${mediaHtml}</div>
        `;
        newsContainer.appendChild(item);
        createCommentArea(item, originalIndex);
        const newsTitleEl = item.querySelector('.news-title');
        // æ–°å¢æ ‡é¢˜ç‚¹å‡»äº‹ä»¶ï¼ˆå¤åˆ¶è¿™æ®µä»£ç åˆ°ç‚¹èµæŒ‰é’®ç»‘å®šä»£ç ä¸‹æ–¹ï¼‰
        newsTitleEl.addEventListener('click', () => {
            // ç‚¹å‡»æ ‡é¢˜æ‰“å¼€æ–°é—»å¼¹çª— + ç»Ÿè®¡æµè§ˆé‡
            openNewsModal(originalIndex);
        });
        const newsLikeBtn = item.querySelector('.news-like-btn');
        newsLikeBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // é˜»æ­¢è§¦å‘æ ‡é¢˜ç‚¹å‡»
            // ç›´æ¥è°ƒç”¨æ ¸å¿ƒå‡½æ•°ï¼Œè‡ªåŠ¨åŒæ­¥UI
            updateNewsLikeCount(originalIndex);
        });
        // ========== æ–°å¢ç»“æŸ ==========
        if(firstMedia) resourcesToLoad.push(firstMedia);
    });
    Promise.all(resourcesToLoad.map(resource=>{
        return new Promise((resolveLoad)=>{
            if(resource.type==='image'){
                const img=new Image();
                img.onload=resolveLoad;
                img.onerror=resolveLoad;
                img.src=resource.url;
            }else{
                const video=document.createElement('video');
                video.preload='metadata';
                video.onloadedmetadata=resolveLoad;
                video.onerror=resolveLoad;
                video.src=resource.url;
            }
        });
    })).then(()=>{
        initLazyImgLoad();
        initVideoHoverPreview();
        initPreviewAnimation();
        initNewsScrollAnimation();
		showSuccessToast();
    });
}

// åŠ è½½æ—¥è®°å†…å®¹ï¼ˆä»GitHub Issueè¯»å–ï¼Œæ›¿æ¢åŸæœ¬åœ°news.txté€»è¾‘ï¼‰
function loadNewsContent() {
    const newsContainer = document.getElementById('newsScroll');
        newsContainer.innerHTML = `<div class="news-loading">âœ¨ åŠ è½½æ—¥è®°å†…å®¹ä¸­...</div>`;
        
        const requestHeaders = {
            "Authorization": `token ${GITHUB_TOKEN}`,
            "Accept": "application/vnd.github.v3+json",
            "User-Agent": "Mozilla/5.0"
        };
    
        return new Promise((resolve) => {
            fetch(`https://api.github.com/repos/${GITHUB_REPO}/issues/${NEWS_ISSUE_NUMBER}`, {
                headers: requestHeaders,
                method: "GET"
            })
            .then(res => {
                if (!res.ok) throw new Error(`è·å–Issueå¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š${res.status}`);
                return res.json();
            })
            .then(issueData => {
                const issueBody = issueData.body || '';
                const newsList = issueBody.replace(/\r\n/g,'\n').split(NEWS_SEPARATOR).map(n=>n.trim()).filter(n=>n.length);
                
                newsDataList = [];
                newsList.forEach((newsStr, index) => {
                    let title="æœ€æ–°æ—¥è®°",content="",imgSrcList=[],videoSrcList=[],date="2026-01-18 00:00";
                    // è§£ææ¯æ¡æ—¥è®°çš„æ ¼å¼
                    // 1. æ–°å¢ï¼šæå‰å®šä¹‰idå˜é‡ï¼ˆé¿å…æœªå®šä¹‰é”™è¯¯ï¼‰
                    let id = 0;
                    newsStr.split('\n').map(l=>l.trim()).filter(l=>l).forEach(line=>{
                        // 2. æ–°å¢ï¼šä¼˜å…ˆå¤„ç†id::æ ¼å¼çš„è¡Œï¼Œä¸åŠ å…¥å†…å®¹
                        if(line.startsWith('id::')) id = parseInt(line.slice(4)) || 0;
                        else if(line.startsWith('ã€')&&line.endsWith('ã€‘')) title=line.slice(1,-1);
                        else if(line.startsWith('img::')) imgSrcList.push(line.slice(5));
                        else if(line.startsWith('video::')) videoSrcList.push(line.slice(7));
                        else if(line.startsWith('date::')) date=line.slice(5);
                        else content += line + '<br>';
                    });
                    newsDataList.push({id: id || (index + 1), title,content,imgSrcList,videoSrcList,date});
                });
                
                // âœ… æ›¿æ¢åŸreverse()ï¼šæŒ‰IDé™åºæ’åºï¼ˆæœ€æ–°çš„IDåœ¨å‰ï¼‰
                newsDataList = newsDataList.sort((a, b) => a.id - b.id);
                
                initNewsLikeCounts(); 
                renderNewsList(newsDataList);
                renderNewsLikeCounts(); 
                renderLikedStyle();     
                
                // ========== æ–°å¢ï¼šé¢„åŠ è½½æ‰€æœ‰èµ„æº ==========
                preloadAllMedia(); // é¢„åŠ è½½æ‰€æœ‰å›¾ç‰‡/è§†é¢‘
                setTimeout(preloadAllComments, 500); // å»¶è¿Ÿ500msé¢„åŠ è½½è¯„è®ºï¼ˆé¿å…é˜»å¡UIï¼‰
                // =======================================
                
                resolve();
            })
        .catch((err)=>{
            console.error('åŠ è½½æ—¥è®°å¤±è´¥ï¼š', err);
            // éšè—åŠ è½½æç¤ºï¼Œæ˜¾ç¤ºå¤±è´¥æç¤º
            const toast = document.getElementById('toastNotification');
            toast.classList.remove('show');
            setTimeout(() => {
                const spinner = toast.querySelector('.loading-spinner');
                const successIcon = toast.querySelector('.success-icon');
                toast.querySelector('.text').textContent = 'æ—¥è®°åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•';
                spinner.style.display = 'none';
                successIcon.style.display = 'inline-block';
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }, 300);
            // é”™è¯¯å…œåº•ï¼šæ˜¾ç¤ºæç¤ºï¼Œå…¼å®¹åŸæœ¬åœ°æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
            newsContainer.innerHTML='';
            const errorDom=document.createElement('div');
            errorDom.className='news-item';
            errorDom.style.color='#38a169';
            errorDom.style.textAlign='center';
            errorDom.style.padding='30px';
            errorDom.textContent='æ—¥è®°åŠ è½½å¤±è´¥ âœ˜ï¼Œè¯·æ£€æŸ¥GitHub Issueé…ç½®æˆ–ç½‘ç»œ';
            newsContainer.appendChild(errorDom);
            
            // å¯é€‰ï¼šå¦‚æœGitHubåŠ è½½å¤±è´¥ï¼Œé™çº§è¯»å–æœ¬åœ°news.txtï¼ˆä¿è¯å¯ç”¨æ€§ï¼‰
            fetch('moguone/news.txt')
                .then(res => res.text())
                .then(text => {
                    const newsList = text.replace(/\r\n/g,'\n').split('---').map(n=>n.trim()).filter(n=>n.length);
                    newsDataList = [];
                    newsList.forEach((newsStr, index) => {
                        let title="æœ€æ–°æ—¥è®°",content="",imgSrcList=[],videoSrcList=[],date="2026-01-18 00:00";
                        // 1. æ–°å¢ï¼šæå‰å®šä¹‰idå˜é‡ï¼ˆé¿å…æœªå®šä¹‰é”™è¯¯ï¼‰
                        let id = 0;
                        newsStr.split('\n').map(l=>l.trim()).filter(l=>l).forEach(line=>{
                            // 2. æ–°å¢ï¼šä¼˜å…ˆå¤„ç†id::æ ¼å¼çš„è¡Œï¼Œä¸åŠ å…¥å†…å®¹
                            if(line.startsWith('id::')) id = parseInt(line.slice(4)) || 0;
                            else if(line.startsWith('ã€')&&line.endsWith('ã€‘')) title=line.slice(1,-1);
                            else if(line.startsWith('img::')) imgSrcList.push(line.slice(5));
                            else if(line.startsWith('video::')) videoSrcList.push(line.slice(7));
                            else if(line.startsWith('date::')) date=line.slice(5);
                            else content += line + '<br>';
                        });
                        newsDataList.push({title,content,imgSrcList,videoSrcList,date});
                    });
                    
                    initNewsLikeCounts();
                    renderNewsList(newsDataList);
                    renderNewsLikeCounts();
                    renderLikedStyle();
                });
            resolve();
        });
    });
}
// æ˜¾ç¤ºåŠ è½½æç¤ºï¼ˆæ—¥è®°åŠ è½½ä¸­ï¼‰
function showLoadingToast() {
    const toast = document.getElementById('toastNotification');
    const spinner = toast.querySelector('.loading-spinner');
    const successIcon = toast.querySelector('.success-icon');
    
    // è®¾ç½®æç¤ºæ–‡æœ¬
    toast.querySelector('.text').innerHTML = 'é¦–æ¬¡åŠ è½½æ–°æ—¥è®°è¾ƒæ…¢<br>è¯· æ‰£æ‰‹æŒ‡ è€å¿ƒç­‰å¾…';
    // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼Œéšè—æˆåŠŸå›¾æ ‡
    spinner.style.display = 'inline-block';
    successIcon.style.display = 'none';
    // æ˜¾ç¤ºæç¤ºæ¡†
    toast.classList.add('show');
}

// æ˜¾ç¤ºæˆåŠŸæç¤ºï¼ˆæ—¥è®°è·å–æˆåŠŸï¼‰
function showSuccessToast() {
    const toast = document.getElementById('toastNotification');
    const spinner = toast.querySelector('.loading-spinner');
    const successIcon = toast.querySelector('.success-icon');
    
    // å…ˆéšè—åŠ è½½æç¤º
    toast.classList.remove('show');
    
    // çŸ­æš‚å»¶è¿Ÿï¼ˆè§†è§‰è¿‡æ¸¡ï¼‰åæ˜¾ç¤ºæˆåŠŸæç¤º
    setTimeout(() => {
        toast.querySelector('.text').textContent = 'æ—¥è®°è·å–æˆåŠŸ';
        // éšè—åŠ è½½åŠ¨ç”»ï¼Œæ˜¾ç¤ºæˆåŠŸå›¾æ ‡
        spinner.style.display = 'none';
        successIcon.style.display = 'inline-block';
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        toast.classList.add('show');
        
        // 3ç§’åè‡ªåŠ¨éšè—æˆåŠŸæç¤º
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }, 300);
}
// æœç´¢åŠŸèƒ½
function initSearchFunc() {
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const resetBtn = document.getElementById('resetBtn');
    let searchDebounce = null;

    const doSearch = () => {
        const keyword = searchInput.value.trim().toLowerCase();
        if (!keyword) {
            showTipModal();
            searchInput.focus();
            return;
        }
        const filterList = newsDataList.filter(item => {
            return item.title.toLowerCase().includes(keyword) || item.content.toLowerCase().includes(keyword);
        });
        renderNewsList(filterList);
    }

    searchBtn.addEventListener('click', doSearch);
    searchInput.addEventListener('keyup', (e) => {
        if(e.key === 'Enter') {
            clearTimeout(searchDebounce);
            doSearch();
        }
    });

    resetBtn.addEventListener('click', () => {
        searchInput.value = '';
        document.getElementById('imgPreviewMask').classList.remove('show');
        closeNewsModal();
        renderNewsList(newsDataList);
        searchInput.focus();
        window.scrollTo({top: 0, behavior: 'smooth'});
    });
}
function refreshNewsContent() {
    loadNewsContent();
    // æ˜¾ç¤ºåˆ·æ–°æˆåŠŸæç¤º
    const toast = document.getElementById('toastNotification');
    toast.querySelector('.text').textContent = 'æ—¥è®°å·²åˆ·æ–°ï¼';
    toast.classList.add('show');
    setTimeout(() => {
        toast.classList.remove('show');
    }, 2000);
}
// ========== æ–°å¢ï¼šé¢„åŠ è½½æ‰€æœ‰æ—¥è®°çš„å›¾ç‰‡/è§†é¢‘èµ„æº ==========
function preloadAllMedia() {
    // ç¡®ä¿æ—¥è®°æ•°æ®å·²åŠ è½½
    if (!newsDataList || newsDataList.length === 0) return;
    
    console.log('å¼€å§‹é¢„åŠ è½½æ‰€æœ‰æ—¥è®°çš„åª’ä½“èµ„æº...');
    const preloadPromises = [];
    
    // éå†æ‰€æœ‰æ—¥è®°
    newsDataList.forEach((newsData, index) => {
        // é¢„åŠ è½½å›¾ç‰‡
        newsData.imgSrcList.forEach(imgUrl => {
            preloadPromises.push(new Promise((resolve) => {
                const img = new Image();
                img.onload = resolve;
                img.onerror = resolve; // åŠ è½½å¤±è´¥ä¹Ÿresolveï¼Œä¸é˜»å¡å…¶ä»–èµ„æº
                img.src = imgUrl;
                console.log(`é¢„åŠ è½½å›¾ç‰‡[æ—¥è®°${index}]ï¼š${imgUrl}`);
            }));
        });
        
        // é¢„åŠ è½½è§†é¢‘ï¼ˆä»…åŠ è½½å…ƒæ•°æ®ï¼Œä¸åŠ è½½å®Œæ•´è§†é¢‘ï¼‰
        newsData.videoSrcList.forEach(videoUrl => {
            preloadPromises.push(new Promise((resolve) => {
                const video = document.createElement('video');
                video.preload = 'metadata'; // ä»…åŠ è½½å…ƒæ•°æ®ï¼ŒèŠ‚çœå¸¦å®½
                video.onloadedmetadata = resolve;
                video.onerror = resolve;
                video.src = videoUrl;
                console.log(`é¢„åŠ è½½è§†é¢‘[æ—¥è®°${index}]ï¼š${videoUrl}`);
            }));
        });
    });
    
    // ç­‰å¾…æ‰€æœ‰åª’ä½“é¢„åŠ è½½å®Œæˆ
    Promise.all(preloadPromises).then(() => {
        console.log('æ‰€æœ‰æ—¥è®°åª’ä½“èµ„æºé¢„åŠ è½½å®Œæˆï¼');
        // é¢„åŠ è½½å®Œæˆååˆå§‹åŒ–æ‡’åŠ è½½ï¼ˆç¡®ä¿èµ„æºå·²ç¼“å­˜ï¼‰
        initLazyImgLoad();
        initVideoHoverPreview();
    });
}

// ========== æ–°å¢ï¼šé¢„åŠ è½½æ‰€æœ‰æ—¥è®°çš„è¯„è®ºæ•°æ® ==========
function preloadAllComments() {
    // ç¡®ä¿æ—¥è®°æ•°æ®å·²åŠ è½½
    if (!newsDataList || newsDataList.length === 0) return;
    
    console.log('å¼€å§‹é¢„åŠ è½½æ‰€æœ‰æ—¥è®°çš„è¯„è®ºæ•°æ®...');
    const commentPromises = [];
    
    // éå†æ‰€æœ‰æ—¥è®°ï¼Œæå‰è·å–è¯„è®ºæ•°æ®
    newsDataList.forEach((_, index) => {
        commentPromises.push(
            getCommentData(index).then(comments => {
                // å°†è¯„è®ºæ•°æ®ç¼“å­˜åˆ°æœ¬åœ°ï¼Œé¿å…é‡å¤è¯·æ±‚
                const commentData = localStorage.getItem(COMMENT_KEY);
                const allComments = commentData ? JSON.parse(commentData) : {};
                allComments[`news_${index}`] = comments;
                localStorage.setItem(COMMENT_KEY, JSON.stringify(allComments));
                console.log(`é¢„åŠ è½½è¯„è®º[æ—¥è®°${index}]ï¼š${comments.length}æ¡`);
                return comments;
            }).catch(err => {
                console.log(`é¢„åŠ è½½è¯„è®º[æ—¥è®°${index}]å¤±è´¥ï¼š`, err);
                return [];
            })
        );
    });
    
    // ç­‰å¾…æ‰€æœ‰è¯„è®ºé¢„åŠ è½½å®Œæˆ
    Promise.all(commentPromises).then(() => {
        console.log('æ‰€æœ‰æ—¥è®°è¯„è®ºæ•°æ®é¢„åŠ è½½å®Œæˆï¼');
    });
}
// å›¾ç‰‡é¢„è§ˆåŠ¨ç”»ï¼ˆæ–°å¢å·¦å³åˆ‡æ¢+é¡µç ï¼‰
function initPreviewAnimation() {
    const mask = document.getElementById('imgPreviewMask');
    const previewImg = document.getElementById('previewImg');
    const previewVideo = document.getElementById('previewVideo');
    const previewCloseBtn = document.getElementById('previewCloseBtn');
    const previewPrevBtn = document.getElementById('previewPrevBtn');
    const previewNextBtn = document.getElementById('previewNextBtn');
    const previewPagination = document.getElementById('previewPagination');
    
    // æ–°å¢ï¼šå­˜å‚¨å½“å‰é¢„è§ˆçš„å›¾ç‰‡åˆ—è¡¨å’Œç´¢å¼•
    let currentMediaList = []; // å½“å‰æ—¥è®°çš„æ‰€æœ‰å›¾ç‰‡/è§†é¢‘
    let currentMediaIndex = 0; // å½“å‰æ˜¾ç¤ºçš„ç´¢å¼•
    
    // å°è£…æ›´æ–°é¢„è§ˆå†…å®¹çš„å‡½æ•°
    function updatePreviewContent(index) {
        if (currentMediaList.length === 0) return;
        
        // å…ˆéšè—å½“å‰å†…å®¹ï¼ˆè§¦å‘æ·¡å‡ºåŠ¨ç”»ï¼‰
        previewImg.classList.remove('show-animate');
        previewVideo.classList.remove('show-animate');
        
        // å»¶è¿Ÿä¸€å°æ®µæ—¶é—´ï¼ˆç­‰æ·¡å‡ºåŠ¨ç”»å®Œæˆï¼‰å†æ›´æ–°å†…å®¹
        setTimeout(() => {
            // æ›´æ–°ç´¢å¼•è¾¹ç•Œ
            currentMediaIndex = index;
            if (currentMediaIndex < 0) currentMediaIndex = currentMediaList.length - 1;
            if (currentMediaIndex >= currentMediaList.length) currentMediaIndex = 0;
            
            // æ›´æ–°æŒ‰é’®ç¦ç”¨çŠ¶æ€
            previewPrevBtn.disabled = currentMediaList.length <= 1 || currentMediaIndex === 0;
            previewNextBtn.disabled = currentMediaList.length <= 1 || currentMediaIndex === currentMediaList.length - 1;
            
            // æ›´æ–°é¡µç æ˜¾ç¤º
            previewPagination.textContent = `${currentMediaIndex + 1}/${currentMediaList.length}`;
            
            // æ›´æ–°é¢„è§ˆå†…å®¹
            const media = currentMediaList[currentMediaIndex];
            previewImg.style.display = 'none';
            previewVideo.style.display = 'none';
            previewVideo.pause();
            previewVideo.currentTime = 0;
            previewVideo.muted = false;
            
            if (media.type === 'image') {
                previewImg.src = media.url;
                previewImg.style.display = 'block';
                // è§¦å‘æ·¡å…¥åŠ¨ç”»
                setTimeout(() => previewImg.classList.add('show-animate'), 50);
            } else if (media.type === 'video') {
                previewVideo.src = media.url;
                previewVideo.style.display = 'block';
                // è§¦å‘æ·¡å…¥åŠ¨ç”»
                setTimeout(() => {
                    previewVideo.classList.add('show-animate');
                    previewVideo.play().catch(e => {});
                }, 50);
            }
        }, 200); // åŒ¹é…CSSåŠ¨ç”»æ—¶é•¿
    }
    
    // å·¦å³åˆ‡æ¢æŒ‰é’®äº‹ä»¶
    previewPrevBtn.addEventListener('click', () => {
        updatePreviewContent(currentMediaIndex - 1);
    });
    previewNextBtn.addEventListener('click', () => {
        updatePreviewContent(currentMediaIndex + 1);
    });
    
    // é”®ç›˜äº‹ä»¶ï¼šå›¾ç‰‡é¢„è§ˆåˆ‡æ¢ + æ—¥è®°è·³è½¬
    // é”®ç›˜äº‹ä»¶ï¼šå›¾ç‰‡é¢„è§ˆåˆ‡æ¢ + æ—¥è®°è·³è½¬ + ç¦æ­¢ä¸Šä¸‹é”®æ»šåŠ¨é¡µé¢
    document.addEventListener('keydown', (e) => {
        // å›¾ç‰‡é¢„è§ˆå¼¹çª—æ‰“å¼€æ—¶
        if (mask.classList.contains('show')) {
            // é˜»æ­¢ä¸Šä¸‹é”®çš„é»˜è®¤æ»šåŠ¨è¡Œä¸º
            if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
            }
            if (e.key === 'ArrowLeft') {
                updatePreviewContent(currentMediaIndex - 1);
            } else if (e.key === 'ArrowRight') {
                updatePreviewContent(currentMediaIndex + 1);
            } else if (e.key === 'Escape') {
                closePreview();
            }
        }
        // æ—¥è®°è¯¦æƒ…å¼¹çª—æ‰“å¼€æ—¶
        else if (document.getElementById('newsModalMask').classList.contains('show')) {
            // é˜»æ­¢ä¸Šä¸‹é”®çš„é»˜è®¤æ»šåŠ¨è¡Œä¸º
            if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
            }
            if (e.key === 'ArrowUp') {
                switchNews('next'); // åŸprevï¼Œæ”¹ä¸ºnext
            } else if (e.key === 'ArrowDown') {
                switchNews('prev'); // åŸnextï¼Œæ”¹ä¸ºprev
            } else if (e.key === 'Escape') {
                closeNewsModal();
            }
        }
        // å…¨å±€ç¦æ­¢ä¸Šä¸‹é”®æ»šåŠ¨ï¼ˆå¦‚æœéœ€è¦åœ¨ä»»ä½•æ—¶å€™éƒ½ç¦æ­¢ï¼Œå–æ¶ˆä¸‹é¢çš„æ³¨é‡Šï¼‰
        // else if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
        //     e.preventDefault();
        // }
    });
    
    // å…³é—­é¢„è§ˆå‡½æ•°
    function closePreview() {
        mask.classList.remove('show');
        if(!document.getElementById('newsModalMask').classList.contains('show')) {
            document.body.style.overflow = 'auto';
            window.scrollTo(0, scrollTopVal);
        }
        previewVideo.pause();
        previewVideo.src = '';
        previewVideo.muted = true;
        previewImg.src = '';
        // é‡ç½®çŠ¶æ€
        currentMediaList = [];
        currentMediaIndex = 0;
    }
    
    // ç‚¹å‡»é®ç½©å…³é—­
    mask.addEventListener('click', function(e) {
        if(e.target === mask) {
            closePreview();
        }
    });
    
    // å…³é—­æŒ‰é’®äº‹ä»¶
    previewCloseBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        closePreview();
    });
    
    // åª’ä½“é¡¹ç‚¹å‡»äº‹ä»¶
    const mediaItems = document.querySelectorAll('.news-img-item, .news-video-item, .modal-news-img-item');
    mediaItems.forEach(item => {
        item.addEventListener('click', function(e) {
            e.stopPropagation();
            scrollTopVal = window.scrollY;
            document.body.style.overflow = 'hidden';
            mask.classList.add('show');
            
            // è·å–å½“å‰æ—¥è®°çš„æ‰€æœ‰åª’ä½“
            const newsItem = this.closest('.news-item') || this.closest('.modal-news-imgs');
            const currentNewsIndex = currentModalIndex >= 0 ? currentModalIndex : Array.from(document.querySelectorAll('.news-item')).indexOf(newsItem);
            
            // æ„å»ºå½“å‰æ—¥è®°çš„åª’ä½“åˆ—è¡¨
            if (currentNewsIndex >= 0 && newsDataList[currentNewsIndex]) {
                const newsData = newsDataList[currentNewsIndex];
                currentMediaList = [];
                
                // æ·»åŠ å›¾ç‰‡
                newsData.imgSrcList.forEach(url => {
                    currentMediaList.push({ type: 'image', url });
                });
                
                // æ·»åŠ è§†é¢‘
                newsData.videoSrcList.forEach(url => {
                    currentMediaList.push({ type: 'video', url });
                });
                
                // æ‰¾åˆ°å½“å‰ç‚¹å‡»çš„åª’ä½“ç´¢å¼•
                const currentUrl = this.src || this.dataset.src;
                currentMediaIndex = currentMediaList.findIndex(media => media.url === currentUrl);
                if (currentMediaIndex === -1) currentMediaIndex = 0;
                
                // æ›´æ–°é¢„è§ˆ
                updatePreviewContent(currentMediaIndex);
            } else {
                // å…¼å®¹å•å¼ å›¾ç‰‡é¢„è§ˆ
                currentMediaList = [{ 
                    type: this.tagName === 'IMG' ? 'image' : 'video', 
                    url: this.src || this.dataset.src 
                }];
                currentMediaIndex = 0;
				previewImg.classList.remove('show-animate');
				previewVideo.classList.remove('show-animate');
                updatePreviewContent(0);
            }
        });
    });
}

function initMusicPlayer() {
    const playBtn = document.getElementById('playBtn');
    const music = document.getElementById('music');
    const footer = document.getElementById('footer'); // æ–°å¢ï¼šè·å–footerå…ƒç´ 
    music.volume = 0.5;
    let isPlay = false;

    // è¯»å–æœ¬åœ°éŸ³ä¹æ’­æ”¾çŠ¶æ€
    const musicState = JSON.parse(localStorage.getItem('musicPlayerState')) || {
        isPlay: false,
        currentTime: 0,
        volume: 0.5
    };
    music.volume = musicState.volume;
    music.currentTime = musicState.currentTime;
    isPlay = musicState.isPlay;

    // åˆå§‹åŒ–footerçš„æ’­æ”¾çŠ¶æ€æ ·å¼
    if (isPlay) {
        playBtn.className = 'music-btn pause-icon';
        footer.className = 'music-playing'; // æ’­æ”¾çŠ¶æ€ï¼šèƒ¶å›Š
        music.play().then(() => {}).catch(e => {});
    } else {
        playBtn.className = 'music-btn play-icon';
        footer.className = 'music-paused'; // æš‚åœçŠ¶æ€ï¼šå°çƒ
        music.pause();
    }

    playBtn.addEventListener('click', function() {
        if (isPlay) {
            music.pause();
            playBtn.className = 'music-btn play-icon';
            footer.className = 'music-paused'; // åˆ‡æ¢ä¸ºå°çƒ
            isPlay = false;
        } else {
            music.play().then(() => {
                playBtn.className = 'music-btn pause-icon';
                footer.className = 'music-playing'; // åˆ‡æ¢ä¸ºèƒ¶å›Š
                isPlay = true;
            }).catch(e => {});
        }
        saveMusicState();
    });

    music.addEventListener('timeupdate', function() {
        saveMusicState();
    });

    function saveMusicState() {
        localStorage.setItem('musicPlayerState', JSON.stringify({
            isPlay: isPlay,
            currentTime: music.currentTime,
            volume: music.volume
        }));
    }

    // è‡ªåŠ¨æ’­æ”¾å°è¯•
    setTimeout(() => {
        if (!isPlay) {
            music.play().then(() => {
                playBtn.className = 'music-btn pause-icon';
                footer.className = 'music-playing'; // è‡ªåŠ¨æ’­æ”¾æ—¶åˆ‡æ¢ä¸ºèƒ¶å›Š
                isPlay = true;
                saveMusicState();
            }).catch(e => {});
        }
    }, 1500);
}

// é¡µé¢åˆå§‹åŒ–
async function initPageWithLoader() {
    const loader = document.getElementById('loader');
    document.body.style.overflow = 'hidden';
    
    await Promise.all([
        loadNewsContent(),
        new Promise(resolve => setTimeout(resolve, 1000))
    ]);

    setTimeout(() => {
        loader.classList.add('loaded');
        document.body.style.overflow = 'auto';
        initTheme();
        initVisitCount();
        initMusicPlayer();
        initSearchFunc();
        initAddBgFunc();
        
        // ========== å…œåº•ï¼šç¡®ä¿é¢„åŠ è½½æ‰§è¡Œ ==========
        if (newsDataList && newsDataList.length > 0) {
            preloadAllMedia();
            setTimeout(preloadAllComments, 1000);
        }
        // =========================================
    }, 300);
}

// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
document.addEventListener('DOMContentLoaded', function() {
    const loader = document.getElementById('loader');
    loader.classList.remove('loaded');
    
    // ç¬¬ä¸€æ­¥ï¼šå…ˆåˆå§‹åŒ–ç™»å½•çŠ¶æ€ï¼ˆè§£å†³è¯„è®ºç™»å½•åˆ¤æ–­é”™è¯¯ï¼‰
    initLoginState();
    // ========== æ ¸å¿ƒä¿®æ”¹1ï¼šå…ˆè¯»å–æœ¬åœ°è‡ªå®šä¹‰å£çº¸ç¼“å­˜ï¼Œå†åŠ è½½å†…ç½®å£çº¸ ==========
    initCustomBg();
    // å†åˆå§‹åŒ–å£çº¸ï¼ˆæ­¤æ—¶è‡ªå®šä¹‰å£çº¸å·²ç»åŠ è½½åˆ°å†…å­˜é‡Œäº†ï¼‰
    initRandomBg();
    document.getElementById('bgChangeBtn').addEventListener('click', changeRandomBg);
    // å£çº¸å¼¹çª—å…³é—­æŒ‰é’®ç»‘å®š
    document.getElementById('bgModalCloseBtn').addEventListener('click', function(e) {
        e.stopPropagation();
        closeBgModal();
    });

    // åŠ è½½æ›´æ–°æ—¥å¿—
    fetch('moguone/log.txt').then(res => res.text()).then(text => {
        const logContainer = document.querySelector('.sidebar-update-log');
        text.replace(/\r\n/g, '\n').split('\n').filter(l => l.trim()).forEach(line => {
            const dom = document.createElement('div');
            if (line.startsWith('V')) {
                dom.className = 'update-log-version';
            } else if (line.startsWith('20')) {
                dom.className = 'update-log-time-text';
            } else {
                dom.className = 'update-log-content';
            }
            dom.textContent = line.trim();
            logContainer.appendChild(dom);
        });
    }).catch(() => {
        const dom = document.createElement('div');
        dom.className = 'update-log-content';
        dom.style.color = '#38a169';
        dom.textContent = ' æ—¥å¿—åŠ è½½å¤±è´¥ âœ˜ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„ ';
        document.querySelector('.sidebar-update-log').appendChild(dom);
    });

    initPageWithLoader();

    // æ–°é—»å¼¹çª—å…³é—­
    document.getElementById('modalCloseBtn').addEventListener('click', function(e) {
        e.stopPropagation();
        closeNewsModal();
    });
	// ç»‘å®šæ—¥è®°è·³è½¬æŒ‰é’®äº‹ä»¶
	document.getElementById('newsPrevBtn').addEventListener('click', () => {
	    switchNews('prev');
	});
	document.getElementById('newsNextBtn').addEventListener('click', () => {
	    switchNews('next');
	});
    document.getElementById('newsModalMask').addEventListener('click', function(e) {
        if(e.target === this) closeNewsModal();
    });

    // æç¤ºå¼¹çª—å…³é—­
    document.getElementById('tipModalCloseBtn').addEventListener('click', function(e) {
        e.stopPropagation();
        hideTipModal();
    });
    document.getElementById('tipModalMask').addEventListener('click', function(e) {
        if(e.target === this) hideTipModal();
    });
    document.getElementById('sidebarTop').addEventListener('click', () => {
        window.scrollTo({top: 0, behavior: 'smooth'});
    });
	function initUserDropdown() {
	  const userInfoBox = document.getElementById('userInfoBox');
	  if (!userInfoBox) return;
	  const trigger = userInfoBox.querySelector('.user-dropdown-trigger');
	  const menu = userInfoBox.querySelector('.user-dropdown-menu');
	  trigger.addEventListener('click', (e) => {
	    e.stopPropagation();
	    menu.classList.toggle('show');
	  });
	  document.addEventListener('click', () => {
	    menu.classList.remove('show');
	  });
	  menu.addEventListener('click', (e) => {
	    e.stopPropagation();
	  });
	}
	initUserDropdown();
});
</script>
</body>
</html>
